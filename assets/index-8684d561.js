(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerpolicy&&(r.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?r.credentials="include":n.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=e(n);fetch(n.href,r)}})();const Ba={1:"The view center is not defined",2:"The view resolution is not defined",3:"The view rotation is not defined",4:"`image` and `src` cannot be provided at the same time",5:"`imgSize` must be set when `image` is provided",7:"`format` must be set when `url` is set",8:"Unknown `serverType` configured",9:"`url` must be configured or set using `#setUrl()`",10:"The default `geometryFunction` can only handle `Point` geometries",11:"`options.featureTypes` must be an Array",12:"`options.geometryName` must also be provided when `options.bbox` is set",13:"Invalid corner",14:"Invalid color",15:"Tried to get a value for a key that does not exist in the cache",16:"Tried to set a value for a key that is used already",17:"`resolutions` must be sorted in descending order",18:"Either `origin` or `origins` must be configured, never both",19:"Number of `tileSizes` and `resolutions` must be equal",20:"Number of `origins` and `resolutions` must be equal",22:"Either `tileSize` or `tileSizes` must be configured, never both",24:"Invalid extent or geometry provided as `geometry`",25:"Cannot fit empty extent provided as `geometry`",26:"Features must have an id set",27:"Features must have an id set",28:'`renderMode` must be `"hybrid"` or `"vector"`',30:"The passed `feature` was already added to the source",31:"Tried to enqueue an `element` that was already added to the queue",32:"Transformation matrix cannot be inverted",33:"Invalid units",34:"Invalid geometry layout",36:"Unknown SRS type",37:"Unknown geometry type found",38:"`styleMapValue` has an unknown type",39:"Unknown geometry type",40:"Expected `feature` to have a geometry",41:"Expected an `ol/style/Style` or an array of `ol/style/Style.js`",42:"Question unknown, the answer is 42",43:"Expected `layers` to be an array or a `Collection`",47:"Expected `controls` to be an array or an `ol/Collection`",48:"Expected `interactions` to be an array or an `ol/Collection`",49:"Expected `overlays` to be an array or an `ol/Collection`",50:"`options.featureTypes` should be an Array",51:"Either `url` or `tileJSON` options must be provided",52:"Unknown `serverType` configured",53:"Unknown `tierSizeCalculation` configured",55:"The {-y} placeholder requires a tile grid with extent",56:"mapBrowserEvent must originate from a pointer event",57:"At least 2 conditions are required",59:"Invalid command found in the PBF",60:"Missing or invalid `size`",61:"Cannot determine IIIF Image API version from provided image information JSON",62:"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`",64:"Layer opacity must be a number",66:"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has not been enabled. This is done by providing adequate shaders using the `hitVertexShader` and `hitFragmentShader` properties of `WebGLPointsLayerRenderer`",67:"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both",68:"A VectorTile source can only be rendered if it has a projection compatible with the view projection"};class Ka extends Error{constructor(t){const e=Ba[t];super(e),this.code=t,this.name="AssertionError",this.message=e}}const yo=Ka;class Za{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}const kt=Za,He={PROPERTYCHANGE:"propertychange"};class Va{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}const Ms=Va;function Ua(s,t,e){let i,n;e=e||Te;let r=0,o=s.length,a=!1;for(;r<o;)i=r+(o-r>>1),n=+e(s[i],t),n<0?r=i+1:(o=i,a=!n);return a?r:~r}function Te(s,t){return s>t?1:s<t?-1:0}function Ps(s,t,e){const i=s.length;if(s[0]<=t)return 0;if(t<=s[i-1])return i-1;{let n;if(e>0){for(n=1;n<i;++n)if(s[n]<t)return n-1}else if(e<0){for(n=1;n<i;++n)if(s[n]<=t)return n}else for(n=1;n<i;++n){if(s[n]==t)return n;if(s[n]<t)return typeof e=="function"?e(t,s[n-1],s[n])>0?n-1:n:s[n-1]-t<t-s[n]?n-1:n}return i-1}}function Ha(s,t,e){for(;t<e;){const i=s[t];s[t]=s[e],s[e]=i,++t,--e}}function Zt(s,t){const e=Array.isArray(t)?t:[t],i=e.length;for(let n=0;n<i;n++)s[s.length]=e[n]}function Le(s,t){const e=s.length;if(e!==t.length)return!1;for(let i=0;i<e;i++)if(s[i]!==t[i])return!1;return!0}function $a(s,t,e){const i=t||Te;return s.every(function(n,r){if(r===0)return!0;const o=i(s[r-1],n);return!(o>0||e&&o===0)})}function ve(){return!0}function En(){return!1}function Ie(){}function qa(s){let t=!1,e,i,n;return function(){const r=Array.prototype.slice.call(arguments);return(!t||this!==n||!Le(r,i))&&(t=!0,n=this,i=r,e=s.apply(this,arguments)),e}}function Si(s){for(const t in s)delete s[t]}function $e(s){let t;for(t in s)return!1;return!t}class Ja extends Ms{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;const i=this.listeners_||(this.listeners_={}),n=i[t]||(i[t]=[]);n.includes(e)||n.push(e)}dispatchEvent(t){const e=typeof t=="string",i=e?t:t.type,n=this.listeners_&&this.listeners_[i];if(!n)return;const r=e?new kt(t):t;r.target||(r.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,a[i]=0),++o[i];let h;for(let c=0,u=n.length;c<u;++c)if("handleEvent"in n[c]?h=n[c].handleEvent(r):h=n[c].call(this,r),h===!1||r.propagationStopped){h=!1;break}if(--o[i]===0){let c=a[i];for(delete a[i];c--;)this.removeEventListener(i,Ie);delete o[i]}return h}disposeInternal(){this.listeners_&&Si(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return this.listeners_?t?t in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(t,e){const i=this.listeners_&&this.listeners_[t];if(i){const n=i.indexOf(e);n!==-1&&(this.pendingRemovals_&&t in this.pendingRemovals_?(i[n]=Ie,++this.pendingRemovals_[t]):(i.splice(n,1),i.length===0&&delete this.listeners_[t]))}}}const Cn=Ja,k={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"};function W(s,t,e,i,n){if(i&&i!==s&&(e=e.bind(i)),n){const o=e;e=function(){s.removeEventListener(t,e),o.apply(this,arguments)}}const r={target:s,type:t,listener:e};return s.addEventListener(t,e),r}function en(s,t,e,i){return W(s,t,e,i,!0)}function Z(s){s&&s.target&&(s.target.removeEventListener(s.type,s.listener),Si(s))}class wn extends Cn{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(k.CHANGE)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){const i=t.length,n=new Array(i);for(let r=0;r<i;++r)n[r]=W(this,t[r],e);return n}else return W(this,t,e)}onceInternal(t,e){let i;if(Array.isArray(t)){const n=t.length;i=new Array(n);for(let r=0;r<n;++r)i[r]=en(this,t[r],e)}else i=en(this,t,e);return e.ol_key=i,i}unInternal(t,e){const i=e.ol_key;if(i)Qa(i);else if(Array.isArray(t))for(let n=0,r=t.length;n<r;++n)this.removeEventListener(t[n],e);else this.removeEventListener(t,e)}}wn.prototype.on;wn.prototype.once;wn.prototype.un;function Qa(s){if(Array.isArray(s))for(let t=0,e=s.length;t<e;++t)Z(s[t]);else Z(s)}const po=wn;function b(){throw new Error("Unimplemented abstract method.")}let tl=0;function z(s){return s.ol_uid||(s.ol_uid=String(++tl))}class Tr extends kt{constructor(t,e,i){super(t),this.key=e,this.oldValue=i}}class el extends po{constructor(t){super(),this.on,this.once,this.un,z(this),this.values_=null,t!==void 0&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}hasProperties(){return!!this.values_}notify(t,e){let i;i=`change:${t}`,this.hasListener(i)&&this.dispatchEvent(new Tr(i,t,e)),i=He.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new Tr(i,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,i){const n=this.values_||(this.values_={});if(i)n[t]=e;else{const r=n[t];n[t]=e,r!==e&&this.notify(t,r)}}setProperties(t,e){for(const i in t)this.set(i,t[i],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){const i=this.values_[t];delete this.values_[t],$e(this.values_)&&(this.values_=null),e||this.notify(t,i)}}}const Lt=el,gt={ADD:"add",REMOVE:"remove"},vr={LENGTH:"length"};class zi extends kt{constructor(t,e,i){super(t),this.element=e,this.index=i}}class il extends Lt{constructor(t,e){if(super(),this.on,this.once,this.un,e=e||{},this.unique_=!!e.unique,this.array_=t||[],this.unique_)for(let i=0,n=this.array_.length;i<n;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,i=t.length;e<i;++e)this.push(t[e]);return this}forEach(t){const e=this.array_;for(let i=0,n=e.length;i<n;++i)t(e[i],i,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(vr.LENGTH)}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new zi(gt.ADD,e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){this.unique_&&this.assertUnique_(t);const e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){const e=this.array_;for(let i=0,n=e.length;i<n;++i)if(e[i]===t)return this.removeAt(i)}removeAt(t){if(t<0||t>=this.getLength())return;const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new zi(gt.REMOVE,e,t)),e}setAt(t,e){const i=this.getLength();if(t>=i){this.insertAt(t,e);return}if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);const n=this.array_[t];this.array_[t]=e,this.dispatchEvent(new zi(gt.REMOVE,n,t)),this.dispatchEvent(new zi(gt.ADD,e,t))}updateLength_(){this.set(vr.LENGTH,this.array_.length)}assertUnique_(t,e){for(let i=0,n=this.array_.length;i<n;++i)if(this.array_[i]===t&&i!==e)throw new yo(58)}}const ut=il;function X(s,t){if(!s)throw new yo(t)}class As extends Lt{constructor(t){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),t)if(typeof t.getSimplifiedGeometry=="function"){const e=t;this.setGeometry(e)}else{const e=t;this.setProperties(e)}}clone(){const t=new As(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());const e=this.getGeometry();e&&t.setGeometry(e.clone());const i=this.getStyle();return i&&t.setStyle(i),t}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(Z(this.geometryChangeKey_),this.geometryChangeKey_=null);const t=this.getGeometry();t&&(this.geometryChangeKey_=W(t,k.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(t){this.set(this.geometryName_,t)}setStyle(t){this.style_=t,this.styleFunction_=t?nl(t):void 0,this.changed()}setId(t){this.id_=t,this.changed()}setGeometryName(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function nl(s){if(typeof s=="function")return s;{let t;return Array.isArray(s)?t=s:(X(typeof s.getZIndex=="function",41),t=[s]),function(){return t}}}const Os=As,he=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",sl=he.includes("firefox"),rl=he.includes("safari")&&!he.includes("chrom");rl&&(he.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(he));const ol=he.includes("webkit")&&!he.includes("edge"),al=he.includes("macintosh"),xo=typeof devicePixelRatio<"u"?devicePixelRatio:1,bs=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,ll=typeof Image<"u"&&Image.prototype.decode,Eo=function(){let s=!1;try{const t=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("_",null,t),window.removeEventListener("_",null,t)}catch{}return s}();new Array(6);function Ot(){return[1,0,0,1,0,0]}function hl(s,t,e,i,n,r,o){return s[0]=t,s[1]=e,s[2]=i,s[3]=n,s[4]=r,s[5]=o,s}function cl(s,t){return s[0]=t[0],s[1]=t[1],s[2]=t[2],s[3]=t[3],s[4]=t[4],s[5]=t[5],s}function it(s,t){const e=t[0],i=t[1];return t[0]=s[0]*e+s[2]*i+s[4],t[1]=s[1]*e+s[3]*i+s[5],t}function ul(s,t,e){return hl(s,t,0,0,e,0,0)}function ce(s,t,e,i,n,r,o,a){const h=Math.sin(r),c=Math.cos(r);return s[0]=i*c,s[1]=n*h,s[2]=-i*h,s[3]=n*c,s[4]=o*i*c-a*i*h+t,s[5]=o*n*h+a*n*c+e,s}function Fs(s,t){const e=dl(t);X(e!==0,32);const i=t[0],n=t[1],r=t[2],o=t[3],a=t[4],h=t[5];return s[0]=o/e,s[1]=-n/e,s[2]=-r/e,s[3]=i/e,s[4]=(r*h-o*a)/e,s[5]=-(i*h-n*a)/e,s}function dl(s){return s[0]*s[3]-s[1]*s[2]}let Ir;function Co(s){const t="matrix("+s.join(", ")+")";if(bs)return t;const e=Ir||(Ir=document.createElement("div"));return e.style.transform=t,e.style.transform}const et={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function Sr(s){const t=Rt();for(let e=0,i=s.length;e<i;++e)ci(t,s[e]);return t}function fl(s,t,e){const i=Math.min.apply(null,s),n=Math.min.apply(null,t),r=Math.max.apply(null,s),o=Math.max.apply(null,t);return bt(i,n,r,o,e)}function ks(s,t,e){return e?(e[0]=s[0]-t,e[1]=s[1]-t,e[2]=s[2]+t,e[3]=s[3]+t,e):[s[0]-t,s[1]-t,s[2]+t,s[3]+t]}function wo(s,t){return t?(t[0]=s[0],t[1]=s[1],t[2]=s[2],t[3]=s[3],t):s.slice()}function Me(s,t,e){let i,n;return t<s[0]?i=s[0]-t:s[2]<t?i=t-s[2]:i=0,e<s[1]?n=s[1]-e:s[3]<e?n=e-s[3]:n=0,i*i+n*n}function Rn(s,t){return Ds(s,t[0],t[1])}function ye(s,t){return s[0]<=t[0]&&t[2]<=s[2]&&s[1]<=t[1]&&t[3]<=s[3]}function Ds(s,t,e){return s[0]<=t&&t<=s[2]&&s[1]<=e&&e<=s[3]}function os(s,t){const e=s[0],i=s[1],n=s[2],r=s[3],o=t[0],a=t[1];let h=et.UNKNOWN;return o<e?h=h|et.LEFT:o>n&&(h=h|et.RIGHT),a<i?h=h|et.BELOW:a>r&&(h=h|et.ABOVE),h===et.UNKNOWN&&(h=et.INTERSECTING),h}function Rt(){return[1/0,1/0,-1/0,-1/0]}function bt(s,t,e,i,n){return n?(n[0]=s,n[1]=t,n[2]=e,n[3]=i,n):[s,t,e,i]}function Li(s){return bt(1/0,1/0,-1/0,-1/0,s)}function gl(s,t){const e=s[0],i=s[1];return bt(e,i,e,i,t)}function Ro(s,t,e,i,n){const r=Li(n);return vo(r,s,t,e,i)}function fi(s,t){return s[0]==t[0]&&s[2]==t[2]&&s[1]==t[1]&&s[3]==t[3]}function To(s,t){return t[0]<s[0]&&(s[0]=t[0]),t[2]>s[2]&&(s[2]=t[2]),t[1]<s[1]&&(s[1]=t[1]),t[3]>s[3]&&(s[3]=t[3]),s}function ci(s,t){t[0]<s[0]&&(s[0]=t[0]),t[0]>s[2]&&(s[2]=t[0]),t[1]<s[1]&&(s[1]=t[1]),t[1]>s[3]&&(s[3]=t[1])}function vo(s,t,e,i,n){for(;e<i;e+=n)ml(s,t[e],t[e+1]);return s}function ml(s,t,e){s[0]=Math.min(s[0],t),s[1]=Math.min(s[1],e),s[2]=Math.max(s[2],t),s[3]=Math.max(s[3],e)}function Io(s,t){let e;return e=t(Tn(s)),e||(e=t(vn(s)),e)||(e=t(In(s)),e)||(e=t(Pe(s)),e)?e:!1}function as(s){let t=0;return Ns(s)||(t=V(s)*Ft(s)),t}function Tn(s){return[s[0],s[1]]}function vn(s){return[s[2],s[1]]}function Se(s){return[(s[0]+s[2])/2,(s[1]+s[3])/2]}function _l(s,t){let e;return t==="bottom-left"?e=Tn(s):t==="bottom-right"?e=vn(s):t==="top-left"?e=Pe(s):t==="top-right"?e=In(s):X(!1,13),e}function ls(s,t,e,i,n){const[r,o,a,h,c,u,d,f]=hs(s,t,e,i);return bt(Math.min(r,a,c,d),Math.min(o,h,u,f),Math.max(r,a,c,d),Math.max(o,h,u,f),n)}function hs(s,t,e,i){const n=t*i[0]/2,r=t*i[1]/2,o=Math.cos(e),a=Math.sin(e),h=n*o,c=n*a,u=r*o,d=r*a,f=s[0],g=s[1];return[f-h+d,g-c-u,f-h-d,g-c+u,f+h-d,g+c+u,f+h+d,g+c-u,f-h+d,g-c-u]}function Ft(s){return s[3]-s[1]}function ui(s,t,e){const i=e||Rt();return ct(s,t)?(s[0]>t[0]?i[0]=s[0]:i[0]=t[0],s[1]>t[1]?i[1]=s[1]:i[1]=t[1],s[2]<t[2]?i[2]=s[2]:i[2]=t[2],s[3]<t[3]?i[3]=s[3]:i[3]=t[3]):Li(i),i}function Pe(s){return[s[0],s[3]]}function In(s){return[s[2],s[3]]}function V(s){return s[2]-s[0]}function ct(s,t){return s[0]<=t[2]&&s[2]>=t[0]&&s[1]<=t[3]&&s[3]>=t[1]}function Ns(s){return s[2]<s[0]||s[3]<s[1]}function yl(s,t){return t?(t[0]=s[0],t[1]=s[1],t[2]=s[2],t[3]=s[3],t):s}function pl(s,t,e){let i=!1;const n=os(s,t),r=os(s,e);if(n===et.INTERSECTING||r===et.INTERSECTING)i=!0;else{const o=s[0],a=s[1],h=s[2],c=s[3],u=t[0],d=t[1],f=e[0],g=e[1],m=(g-d)/(f-u);let _,p;r&et.ABOVE&&!(n&et.ABOVE)&&(_=f-(g-c)/m,i=_>=o&&_<=h),!i&&r&et.RIGHT&&!(n&et.RIGHT)&&(p=g-(f-h)*m,i=p>=a&&p<=c),!i&&r&et.BELOW&&!(n&et.BELOW)&&(_=f-(g-a)/m,i=_>=o&&_<=h),!i&&r&et.LEFT&&!(n&et.LEFT)&&(p=g-(f-o)*m,i=p>=a&&p<=c)}return i}function xl(s,t,e,i){let n=[];if(i>1){const a=s[2]-s[0],h=s[3]-s[1];for(let c=0;c<i;++c)n.push(s[0]+a*c/i,s[1],s[2],s[1]+h*c/i,s[2]-a*c/i,s[3],s[0],s[3]-h*c/i)}else n=[s[0],s[1],s[2],s[1],s[2],s[3],s[0],s[3]];t(n,n,2);const r=[],o=[];for(let a=0,h=n.length;a<h;a+=2)r.push(n[a]),o.push(n[a+1]);return fl(r,o,e)}function So(s,t){const e=t.getExtent(),i=Se(s);if(t.canWrapX()&&(i[0]<e[0]||i[0]>=e[2])){const n=V(e),o=Math.floor((i[0]-e[0])/n)*n;s[0]-=o,s[2]-=o}return s}function El(s,t){if(t.canWrapX()){const e=t.getExtent();if(!isFinite(s[0])||!isFinite(s[2]))return[[e[0],s[1],e[2],s[3]]];So(s,t);const i=V(e);if(V(s)>i)return[[e[0],s[1],e[2],s[3]]];if(s[0]<e[0])return[[s[0]+i,s[1],e[2],s[3]],[e[0],s[1],s[2],s[3]]];if(s[2]>e[2])return[[s[0],s[1],e[2],s[3]],[e[0],s[1],s[2]-i,s[3]]]}return[s]}const gi={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class Cl{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=t.extent!==void 0?t.extent:null,this.worldExtent_=t.worldExtent!==void 0?t.worldExtent:null,this.axisOrientation_=t.axisOrientation!==void 0?t.axisOrientation:"enu",this.global_=t.global!==void 0?t.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||gi[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!!(t&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!!(this.global_&&t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const Lo=Cl,Mi=6378137,Ze=Math.PI*Mi,wl=[-Ze,-Ze,Ze,Ze],Rl=[-180,-85,180,85],Yi=Mi*Math.log(Math.tan(Math.PI/2));class Ge extends Lo{constructor(t){super({code:t,units:"m",extent:wl,global:!0,worldExtent:Rl,getPointResolution:function(e,i){return e/Math.cosh(i[1]/Mi)}})}}const Lr=[new Ge("EPSG:3857"),new Ge("EPSG:102100"),new Ge("EPSG:102113"),new Ge("EPSG:900913"),new Ge("http://www.opengis.net/def/crs/EPSG/0/3857"),new Ge("http://www.opengis.net/gml/srs/epsg.xml#3857")];function Tl(s,t,e){const i=s.length;e=e>1?e:2,t===void 0&&(e>2?t=s.slice():t=new Array(i));for(let n=0;n<i;n+=e){t[n]=Ze*s[n]/180;let r=Mi*Math.log(Math.tan(Math.PI*(+s[n+1]+90)/360));r>Yi?r=Yi:r<-Yi&&(r=-Yi),t[n+1]=r}return t}function vl(s,t,e){const i=s.length;e=e>1?e:2,t===void 0&&(e>2?t=s.slice():t=new Array(i));for(let n=0;n<i;n+=e)t[n]=180*s[n]/Ze,t[n+1]=360*Math.atan(Math.exp(s[n+1]/Mi))/Math.PI-90;return t}const Il=6378137,Mr=[-180,-90,180,90],Sl=Math.PI*Il/180;class de extends Lo{constructor(t,e){super({code:t,units:"degrees",extent:Mr,axisOrientation:e,global:!0,metersPerUnit:Sl,worldExtent:Mr})}}const Pr=[new de("CRS:84"),new de("EPSG:4326","neu"),new de("urn:ogc:def:crs:OGC:1.3:CRS84"),new de("urn:ogc:def:crs:OGC:2:84"),new de("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new de("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new de("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let cs={};function Ll(s){return cs[s]||cs[s.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function Ml(s,t){cs[s]=t}let Ve={};function nn(s,t,e){const i=s.getCode(),n=t.getCode();i in Ve||(Ve[i]={}),Ve[i][n]=e}function Pl(s,t){let e;return s in Ve&&t in Ve[s]&&(e=Ve[s][t]),e}function J(s,t,e){return Math.min(Math.max(s,t),e)}function Al(s,t,e,i,n,r){const o=n-e,a=r-i;if(o!==0||a!==0){const h=((s-e)*o+(t-i)*a)/(o*o+a*a);h>1?(e=n,i=r):h>0&&(e+=o*h,i+=a*h)}return we(s,t,e,i)}function we(s,t,e,i){const n=e-s,r=i-t;return n*n+r*r}function Ol(s){const t=s.length;for(let i=0;i<t;i++){let n=i,r=Math.abs(s[i][i]);for(let a=i+1;a<t;a++){const h=Math.abs(s[a][i]);h>r&&(r=h,n=a)}if(r===0)return null;const o=s[n];s[n]=s[i],s[i]=o;for(let a=i+1;a<t;a++){const h=-s[a][i]/s[i][i];for(let c=i;c<t+1;c++)i==c?s[a][c]=0:s[a][c]+=h*s[i][c]}}const e=new Array(t);for(let i=t-1;i>=0;i--){e[i]=s[i][t]/s[i][i];for(let n=i-1;n>=0;n--)s[n][t]-=s[n][i]*e[i]}return e}function Qi(s){return s*Math.PI/180}function Ue(s,t){const e=s%t;return e*t<0?e+t:e}function Kt(s,t,e){return s+e*(t-s)}function Mo(s,t){const e=Math.pow(10,t);return Math.round(s*e)/e}function ji(s,t){return Math.floor(Mo(s,t))}function Bi(s,t){return Math.ceil(Mo(s,t))}function bl(s,t){return s[0]+=+t[0],s[1]+=+t[1],s}function sn(s,t){let e=!0;for(let i=s.length-1;i>=0;--i)if(s[i]!=t[i]){e=!1;break}return e}function Gs(s,t){const e=Math.cos(t),i=Math.sin(t),n=s[0]*e-s[1]*i,r=s[1]*e+s[0]*i;return s[0]=n,s[1]=r,s}function Fl(s,t){return s[0]*=t,s[1]*=t,s}function Po(s,t){if(t.canWrapX()){const e=V(t.getExtent()),i=kl(s,t,e);i&&(s[0]-=i*e)}return s}function kl(s,t,e){const i=t.getExtent();let n=0;return t.canWrapX()&&(s[0]<i[0]||s[0]>i[2])&&(e=e||V(i),n=Math.floor((s[0]-i[0])/e)),n}const Dl=63710088e-1;function Ar(s,t,e){e=e||Dl;const i=Qi(s[1]),n=Qi(t[1]),r=(n-i)/2,o=Qi(t[0]-s[0])/2,a=Math.sin(r)*Math.sin(r)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(n);return 2*e*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}let us=!0;function Ao(s){us=!(s===void 0?!0:s)}function Xs(s,t,e){if(t!==void 0){for(let i=0,n=s.length;i<n;++i)t[i]=s[i];t=t}else t=s.slice();return t}function Oo(s,t,e){if(t!==void 0&&s!==t){for(let i=0,n=s.length;i<n;++i)t[i]=s[i];s=t}return s}function Nl(s){Ml(s.getCode(),s),nn(s,s,Xs)}function Gl(s){s.forEach(Nl)}function q(s){return typeof s=="string"?Ll(s):s||null}function Or(s,t,e,i){s=q(s);let n;const r=s.getPointResolutionFunc();if(r){if(n=r(t,e),i&&i!==s.getUnits()){const o=s.getMetersPerUnit();o&&(n=n*o/gi[i])}}else{const o=s.getUnits();if(o=="degrees"&&!i||i=="degrees")n=t;else{const a=Sn(s,q("EPSG:4326"));if(a===Oo&&o!=="degrees")n=t*s.getMetersPerUnit();else{let c=[e[0]-t/2,e[1],e[0]+t/2,e[1],e[0],e[1]-t/2,e[0],e[1]+t/2];c=a(c,c,2);const u=Ar(c.slice(0,2),c.slice(2,4)),d=Ar(c.slice(4,6),c.slice(6,8));n=(u+d)/2}const h=i?gi[i]:s.getMetersPerUnit();h!==void 0&&(n/=h)}}return n}function br(s){Gl(s),s.forEach(function(t){s.forEach(function(e){t!==e&&nn(t,e,Xs)})})}function Xl(s,t,e,i){s.forEach(function(n){t.forEach(function(r){nn(n,r,e),nn(r,n,i)})})}function Ws(s,t){return s?typeof s=="string"?q(s):s:q(t)}function zs(s,t){return Ao(),bo(s,"EPSG:4326",t!==void 0?t:"EPSG:3857")}function me(s,t){if(s===t)return!0;const e=s.getUnits()===t.getUnits();return(s.getCode()===t.getCode()||Sn(s,t)===Xs)&&e}function Sn(s,t){const e=s.getCode(),i=t.getCode();let n=Pl(e,i);return n||(n=Oo),n}function rn(s,t){const e=q(s),i=q(t);return Sn(e,i)}function bo(s,t,e){return rn(t,e)(s,void 0,s.length)}function ds(s,t){return s}function Yt(s,t){return us&&!sn(s,[0,0])&&s[0]>=-180&&s[0]<=180&&s[1]>=-90&&s[1]<=90&&(us=!1,console.warn("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),s}function Fo(s,t){return s}function pe(s,t){return s}function Wl(){br(Lr),br(Pr),Xl(Pr,Lr,Tl,vl)}Wl();function Re(s,t,e,i,n,r){r=r||[];let o=0;for(let a=t;a<e;a+=i){const h=s[a],c=s[a+1];r[o++]=n[0]*h+n[2]*c+n[4],r[o++]=n[1]*h+n[3]*c+n[5]}return r&&r.length!=o&&(r.length=o),r}function ko(s,t,e,i,n,r,o){o=o||[];const a=Math.cos(n),h=Math.sin(n),c=r[0],u=r[1];let d=0;for(let f=t;f<e;f+=i){const g=s[f]-c,m=s[f+1]-u;o[d++]=c+g*a-m*h,o[d++]=u+g*h+m*a;for(let _=f+2;_<f+i;++_)o[d++]=s[_]}return o&&o.length!=d&&(o.length=d),o}function zl(s,t,e,i,n,r,o,a){a=a||[];const h=o[0],c=o[1];let u=0;for(let d=t;d<e;d+=i){const f=s[d]-h,g=s[d+1]-c;a[u++]=h+n*f,a[u++]=c+r*g;for(let m=d+2;m<d+i;++m)a[u++]=s[m]}return a&&a.length!=u&&(a.length=u),a}function Yl(s,t,e,i,n,r,o){o=o||[];let a=0;for(let h=t;h<e;h+=i){o[a++]=s[h]+n,o[a++]=s[h+1]+r;for(let c=h+2;c<h+i;++c)o[a++]=s[c]}return o&&o.length!=a&&(o.length=a),o}const Fr=Ot();class jl extends Lt{constructor(){super(),this.extent_=Rt(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=qa(function(t,e,i){if(!i)return this.getSimplifiedGeometry(e);const n=this.clone();return n.applyTransform(i),n.getSimplifiedGeometry(e)})}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return b()}closestPointXY(t,e,i,n){return b()}containsXY(t,e){const i=this.getClosestPoint([t,e]);return i[0]===t&&i[1]===e}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return b()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&Li(e),this.extentRevision_=this.getRevision()}return yl(this.extent_,t)}rotate(t,e){b()}scale(t,e,i){b()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return b()}getType(){return b()}applyTransform(t){b()}intersectsExtent(t){return b()}translate(t,e){b()}transform(t,e){const i=q(t),n=i.getUnits()=="tile-pixels"?function(r,o,a){const h=i.getExtent(),c=i.getWorldExtent(),u=Ft(c)/Ft(h);return ce(Fr,c[0],c[3],u,-u,0,0,0),Re(r,0,r.length,a,Fr,o),rn(i,e)(r,o,a)}:rn(i,e);return this.applyTransform(n),this}}const Do=jl;class Bl extends Do{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates=null}computeExtent(t){return Ro(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return b()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=kr(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){b()}setLayout(t,e,i){let n;if(t)n=kr(t);else{for(let r=0;r<i;++r)if(e.length===0){this.layout="XY",this.stride=2;return}else e=e[0];n=e.length,t=Kl(n)}this.layout=t,this.stride=n}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}rotate(t,e){const i=this.getFlatCoordinates();if(i){const n=this.getStride();ko(i,0,i.length,n,t,e,i),this.changed()}}scale(t,e,i){e===void 0&&(e=t),i||(i=Se(this.getExtent()));const n=this.getFlatCoordinates();if(n){const r=this.getStride();zl(n,0,n.length,r,t,e,i,n),this.changed()}}translate(t,e){const i=this.getFlatCoordinates();if(i){const n=this.getStride();Yl(i,0,i.length,n,t,e,i),this.changed()}}}function Kl(s){let t;return s==2?t="XY":s==3?t="XYZ":s==4&&(t="XYZM"),t}function kr(s){let t;return s=="XY"?t=2:s=="XYZ"||s=="XYM"?t=3:s=="XYZM"&&(t=4),t}function Zl(s,t,e){const i=s.getFlatCoordinates();if(i){const n=s.getStride();return Re(i,0,i.length,n,t,e)}else return null}const Ae=Bl;function Dr(s,t,e,i,n,r,o){const a=s[t],h=s[t+1],c=s[e]-a,u=s[e+1]-h;let d;if(c===0&&u===0)d=t;else{const f=((n-a)*c+(r-h)*u)/(c*c+u*u);if(f>1)d=e;else if(f>0){for(let g=0;g<i;++g)o[g]=Kt(s[t+g],s[e+g],f);o.length=i;return}else d=t}for(let f=0;f<i;++f)o[f]=s[d+f];o.length=i}function Ys(s,t,e,i,n){let r=s[t],o=s[t+1];for(t+=i;t<e;t+=i){const a=s[t],h=s[t+1],c=we(r,o,a,h);c>n&&(n=c),r=a,o=h}return n}function js(s,t,e,i,n){for(let r=0,o=e.length;r<o;++r){const a=e[r];n=Ys(s,t,a,i,n),t=a}return n}function Vl(s,t,e,i,n){for(let r=0,o=e.length;r<o;++r){const a=e[r];n=js(s,t,a,i,n),t=a[a.length-1]}return n}function Bs(s,t,e,i,n,r,o,a,h,c,u){if(t==e)return c;let d,f;if(n===0)if(f=we(o,a,s[t],s[t+1]),f<c){for(d=0;d<i;++d)h[d]=s[t+d];return h.length=i,f}else return c;u=u||[NaN,NaN];let g=t+i;for(;g<e;)if(Dr(s,g-i,g,i,o,a,u),f=we(o,a,u[0],u[1]),f<c){for(c=f,d=0;d<i;++d)h[d]=u[d];h.length=i,g+=i}else g+=i*Math.max((Math.sqrt(f)-Math.sqrt(c))/n|0,1);if(r&&(Dr(s,e-i,t,i,o,a,u),f=we(o,a,u[0],u[1]),f<c)){for(c=f,d=0;d<i;++d)h[d]=u[d];h.length=i}return c}function Ks(s,t,e,i,n,r,o,a,h,c,u){u=u||[NaN,NaN];for(let d=0,f=e.length;d<f;++d){const g=e[d];c=Bs(s,t,g,i,n,r,o,a,h,c,u),t=g}return c}function Ul(s,t,e,i,n,r,o,a,h,c,u){u=u||[NaN,NaN];for(let d=0,f=e.length;d<f;++d){const g=e[d];c=Ks(s,t,g,i,n,r,o,a,h,c,u),t=g[g.length-1]}return c}function Hl(s,t,e,i){for(let n=0,r=e.length;n<r;++n)s[t++]=e[n];return t}function Ln(s,t,e,i){for(let n=0,r=e.length;n<r;++n){const o=e[n];for(let a=0;a<i;++a)s[t++]=o[a]}return t}function Zs(s,t,e,i,n){n=n||[];let r=0;for(let o=0,a=e.length;o<a;++o){const h=Ln(s,t,e[o],i);n[r++]=h,t=h}return n.length=r,n}function $l(s,t,e,i,n){n=n||[];let r=0;for(let o=0,a=e.length;o<a;++o){const h=Zs(s,t,e[o],i,n[r]);h.length===0&&(h[0]=t),n[r++]=h,t=h[h.length-1]}return n.length=r,n}function Vs(s,t,e,i,n,r,o){const a=(e-t)/i;if(a<3){for(;t<e;t+=i)r[o++]=s[t],r[o++]=s[t+1];return o}const h=new Array(a);h[0]=1,h[a-1]=1;const c=[t,e-i];let u=0;for(;c.length>0;){const d=c.pop(),f=c.pop();let g=0;const m=s[f],_=s[f+1],p=s[d],x=s[d+1];for(let l=f+i;l<d;l+=i){const y=s[l],E=s[l+1],C=Al(y,E,m,_,p,x);C>g&&(u=l,g=C)}g>n&&(h[(u-t)/i]=1,f+i<u&&c.push(f,u),u+i<d&&c.push(u,d))}for(let d=0;d<a;++d)h[d]&&(r[o++]=s[t+d*i],r[o++]=s[t+d*i+1]);return o}function ql(s,t,e,i,n,r,o,a){for(let h=0,c=e.length;h<c;++h){const u=e[h];o=Vs(s,t,u,i,n,r,o),a.push(o),t=u}return o}function ge(s,t){return t*Math.round(s/t)}function Jl(s,t,e,i,n,r,o){if(t==e)return o;let a=ge(s[t],n),h=ge(s[t+1],n);t+=i,r[o++]=a,r[o++]=h;let c,u;do if(c=ge(s[t],n),u=ge(s[t+1],n),t+=i,t==e)return r[o++]=c,r[o++]=u,o;while(c==a&&u==h);for(;t<e;){const d=ge(s[t],n),f=ge(s[t+1],n);if(t+=i,d==c&&f==u)continue;const g=c-a,m=u-h,_=d-a,p=f-h;if(g*p==m*_&&(g<0&&_<g||g==_||g>0&&_>g)&&(m<0&&p<m||m==p||m>0&&p>m)){c=d,u=f;continue}r[o++]=c,r[o++]=u,a=c,h=u,c=d,u=f}return r[o++]=c,r[o++]=u,o}function No(s,t,e,i,n,r,o,a){for(let h=0,c=e.length;h<c;++h){const u=e[h];o=Jl(s,t,u,i,n,r,o),a.push(o),t=u}return o}function Ql(s,t,e,i,n,r,o,a){for(let h=0,c=e.length;h<c;++h){const u=e[h],d=[];o=No(s,t,u,i,n,r,o,d),a.push(d),t=u[u.length-1]}return o}function re(s,t,e,i,n){n=n!==void 0?n:[];let r=0;for(let o=t;o<e;o+=i)n[r++]=s.slice(o,o+i);return n.length=r,n}function mi(s,t,e,i,n){n=n!==void 0?n:[];let r=0;for(let o=0,a=e.length;o<a;++o){const h=e[o];n[r++]=re(s,t,h,i,n[r]),t=h}return n.length=r,n}function fs(s,t,e,i,n){n=n!==void 0?n:[];let r=0;for(let o=0,a=e.length;o<a;++o){const h=e[o];n[r++]=h.length===1&&h[0]===t?[]:mi(s,t,h,i,n[r]),t=h[h.length-1]}return n.length=r,n}function Go(s,t,e,i){let n=0,r=s[e-i],o=s[e-i+1];for(;t<e;t+=i){const a=s[t],h=s[t+1];n+=o*a-r*h,r=a,o=h}return n/2}function Xo(s,t,e,i){let n=0;for(let r=0,o=e.length;r<o;++r){const a=e[r];n+=Go(s,t,a,i),t=a}return n}function th(s,t,e,i){let n=0;for(let r=0,o=e.length;r<o;++r){const a=e[r];n+=Xo(s,t,a,i),t=a[a.length-1]}return n}class on extends Ae{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}clone(){return new on(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,i,n){return n<Me(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Ys(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Bs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,n))}getArea(){return Go(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return re(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=Vs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new on(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Ln(this.flatCoordinates,0,t,this.stride),this.changed()}}const Nr=on;class Us extends Ae{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new Us(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){const r=this.flatCoordinates,o=we(t,e,r[0],r[1]);if(o<n){const a=this.stride;for(let h=0;h<a;++h)i[h]=r[h];return i.length=a,o}else return n}getCoordinates(){return this.flatCoordinates?this.flatCoordinates.slice():[]}computeExtent(t){return gl(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return Ds(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Hl(this.flatCoordinates,0,t,this.stride),this.changed()}}const qe=Us;function eh(s,t,e,i,n){return!Io(n,function(o){return!xe(s,t,e,i,o[0],o[1])})}function xe(s,t,e,i,n,r){let o=0,a=s[e-i],h=s[e-i+1];for(;t<e;t+=i){const c=s[t],u=s[t+1];h<=r?u>r&&(c-a)*(r-h)-(n-a)*(u-h)>0&&o++:u<=r&&(c-a)*(r-h)-(n-a)*(u-h)<0&&o--,a=c,h=u}return o!==0}function Hs(s,t,e,i,n,r){if(e.length===0||!xe(s,t,e[0],i,n,r))return!1;for(let o=1,a=e.length;o<a;++o)if(xe(s,e[o-1],e[o],i,n,r))return!1;return!0}function ih(s,t,e,i,n,r){if(e.length===0)return!1;for(let o=0,a=e.length;o<a;++o){const h=e[o];if(Hs(s,t,h,i,n,r))return!0;t=h[h.length-1]}return!1}function Wo(s,t,e,i,n,r,o){let a,h,c,u,d,f,g;const m=n[r+1],_=[];for(let l=0,y=e.length;l<y;++l){const E=e[l];for(u=s[E-i],f=s[E-i+1],a=t;a<E;a+=i)d=s[a],g=s[a+1],(m<=f&&g<=m||f<=m&&m<=g)&&(c=(m-f)/(g-f)*(d-u)+u,_.push(c)),u=d,f=g}let p=NaN,x=-1/0;for(_.sort(Te),u=_[0],a=1,h=_.length;a<h;++a){d=_[a];const l=Math.abs(d-u);l>x&&(c=(u+d)/2,Hs(s,t,e,i,c,m)&&(p=c,x=l)),u=d}return isNaN(p)&&(p=n[r]),o?(o.push(p,m,x),o):[p,m,x]}function nh(s,t,e,i,n){let r=[];for(let o=0,a=e.length;o<a;++o){const h=e[o];r=Wo(s,t,h,i,n,2*o,r),t=h[h.length-1]}return r}function zo(s,t,e,i,n){let r;for(t+=i;t<e;t+=i)if(r=n(s.slice(t-i,t),s.slice(t,t+i)),r)return r;return!1}function Mn(s,t,e,i,n){const r=vo(Rt(),s,t,e,i);return ct(n,r)?ye(n,r)||r[0]>=n[0]&&r[2]<=n[2]||r[1]>=n[1]&&r[3]<=n[3]?!0:zo(s,t,e,i,function(o,a){return pl(n,o,a)}):!1}function sh(s,t,e,i,n){for(let r=0,o=e.length;r<o;++r){if(Mn(s,t,e[r],i,n))return!0;t=e[r]}return!1}function Yo(s,t,e,i,n){return!!(Mn(s,t,e,i,n)||xe(s,t,e,i,n[0],n[1])||xe(s,t,e,i,n[0],n[3])||xe(s,t,e,i,n[2],n[1])||xe(s,t,e,i,n[2],n[3]))}function jo(s,t,e,i,n){if(!Yo(s,t,e[0],i,n))return!1;if(e.length===1)return!0;for(let r=1,o=e.length;r<o;++r)if(eh(s,e[r-1],e[r],i,n)&&!Mn(s,e[r-1],e[r],i,n))return!1;return!0}function rh(s,t,e,i,n){for(let r=0,o=e.length;r<o;++r){const a=e[r];if(jo(s,t,a,i,n))return!0;t=a[a.length-1]}return!1}function oh(s,t,e,i){for(;t<e-i;){for(let n=0;n<i;++n){const r=s[t+n];s[t+n]=s[e-i+n],s[e-i+n]=r}t+=i,e-=i}}function Bo(s,t,e,i){let n=0,r=s[e-i],o=s[e-i+1];for(;t<e;t+=i){const a=s[t],h=s[t+1];n+=(a-r)*(h+o),r=a,o=h}return n===0?void 0:n>0}function Ko(s,t,e,i,n){n=n!==void 0?n:!1;for(let r=0,o=e.length;r<o;++r){const a=e[r],h=Bo(s,t,a,i);if(r===0){if(n&&h||!n&&!h)return!1}else if(n&&!h||!n&&h)return!1;t=a}return!0}function ah(s,t,e,i,n){for(let r=0,o=e.length;r<o;++r){const a=e[r];if(!Ko(s,t,a,i,n))return!1;a.length&&(t=a[a.length-1])}return!0}function gs(s,t,e,i,n){n=n!==void 0?n:!1;for(let r=0,o=e.length;r<o;++r){const a=e[r],h=Bo(s,t,a,i);(r===0?n&&h||!n&&!h:n&&!h||!n&&h)&&oh(s,t,a,i),t=a}return t}function Gr(s,t,e,i,n){for(let r=0,o=e.length;r<o;++r)t=gs(s,t,e[r],i,n);return t}class _i extends Ae{constructor(t,e,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,e!==void 0&&i?(this.setFlatCoordinates(e,t),this.ends_=i):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?Zt(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new _i(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<Me(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(js(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ks(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,i,n))}containsXY(t,e){return Hs(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return Xo(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),gs(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,mi(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=Se(this.getExtent());this.flatInteriorPoint_=Wo(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new qe(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new Nr(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,i=this.ends_,n=[];let r=0;for(let o=0,a=i.length;o<a;++o){const h=i[o],c=new Nr(e.slice(r,h),t);n.push(c),r=h}return n}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;Ko(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=gs(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=No(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,i),new _i(e,"XY",i)}getType(){return"Polygon"}intersectsExtent(t){return jo(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=Zs(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}const an=_i;function Xr(s){const t=s[0],e=s[1],i=s[2],n=s[3],r=[t,e,t,n,i,n,i,e,t,e];return new _i(r,"XY",[r.length])}const le={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"};class $s{constructor(t){t=t||{},this.color_=t.color!==void 0?t.color:null}clone(){const t=this.getColor();return new $s({color:Array.isArray(t)?t.slice():t||void 0})}getColor(){return this.color_}setColor(t){this.color_=t}}const St=$s;function Zo(s,t,e,i,n,r,o){let a,h;const c=(e-t)/i;if(c===1)a=t;else if(c===2)a=t,h=n;else if(c!==0){let u=s[t],d=s[t+1],f=0;const g=[0];for(let p=t+i;p<e;p+=i){const x=s[p],l=s[p+1];f+=Math.sqrt((x-u)*(x-u)+(l-d)*(l-d)),g.push(f),u=x,d=l}const m=n*f,_=Ua(g,m);_<0?(h=(m-g[-_-2])/(g[-_-1]-g[-_-2]),a=t+(-_-2)*i):a=t+_*i}o=o>1?o:2,r=r||new Array(o);for(let u=0;u<o;++u)r[u]=a===void 0?NaN:h===void 0?s[a+u]:Kt(s[a+u],s[a+i+u],h);return r}function ms(s,t,e,i,n,r){if(e==t)return null;let o;if(n<s[t+i-1])return r?(o=s.slice(t,t+i),o[i-1]=n,o):null;if(s[e-1]<n)return r?(o=s.slice(e-i,e),o[i-1]=n,o):null;if(n==s[t+i-1])return s.slice(t,t+i);let a=t/i,h=e/i;for(;a<h;){const f=a+h>>1;n<s[(f+1)*i-1]?h=f:a=f+1}const c=s[a*i-1];if(n==c)return s.slice((a-1)*i,(a-1)*i+i);const u=s[(a+1)*i-1],d=(n-c)/(u-c);o=[];for(let f=0;f<i-1;++f)o.push(Kt(s[(a-1)*i+f],s[a*i+f],d));return o.push(n),o}function lh(s,t,e,i,n,r,o){if(o)return ms(s,t,e[e.length-1],i,n,r);let a;if(n<s[i-1])return r?(a=s.slice(0,i),a[i-1]=n,a):null;if(s[s.length-1]<n)return r?(a=s.slice(s.length-i),a[i-1]=n,a):null;for(let h=0,c=e.length;h<c;++h){const u=e[h];if(t!=u){if(n<s[t+i-1])return null;if(n<=s[u-1])return ms(s,t,u,i,n,!1);t=u}}return null}function Vo(s,t,e,i){let n=s[t],r=s[t+1],o=0;for(let a=t+i;a<e;a+=i){const h=s[a],c=s[a+1];o+=Math.sqrt((h-n)*(h-n)+(c-r)*(c-r)),n=h,r=c}return o}class ln extends Ae{constructor(t,e){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendCoordinate(t){this.flatCoordinates?Zt(this.flatCoordinates,t):this.flatCoordinates=t.slice(),this.changed()}clone(){const t=new ln(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<Me(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Ys(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Bs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,n))}forEachSegment(t){return zo(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinateAtM(t,e){return this.layout!="XYM"&&this.layout!="XYZM"?null:(e=e!==void 0?e:!1,ms(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e))}getCoordinates(){return re(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(t,e){return Zo(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}getLength(){return Vo(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(t){const e=[];return e.length=Vs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new ln(e,"XY")}getType(){return"LineString"}intersectsExtent(t){return Mn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Ln(this.flatCoordinates,0,t,this.stride),this.changed()}}const _s=ln;class qs{constructor(t){t=t||{},this.color_=t.color!==void 0?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=t.lineDash!==void 0?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}clone(){const t=this.getColor();return new qs({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(t){this.color_=t}setLineCap(t){this.lineCap_=t}setLineDash(t){this.lineDash_=t}setLineDashOffset(t){this.lineDashOffset_=t}setLineJoin(t){this.lineJoin_=t}setMiterLimit(t){this.miterLimit_=t}setWidth(t){this.width_=t}}const lt=qs,Q={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function Wr(s){return s[0]>0&&s[1]>0}function hh(s,t,e){return e===void 0&&(e=[0,0]),e[0]=s[0]*t+.5|0,e[1]=s[1]*t+.5|0,e}function pt(s,t){return Array.isArray(s)?s:(t===void 0?t=[s,s]:(t[0]=s,t[1]=s),t)}class Js{constructor(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=pt(t.scale),this.displacement_=t.displacement,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new Js({opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return b()}getImage(t){return b()}getHitDetectionImage(){return b()}getPixelRatio(t){return 1}getImageState(){return b()}getImageSize(){return b()}getOrigin(){return b()}getSize(){return b()}setDisplacement(t){this.displacement_=t}setOpacity(t){this.opacity_=t}setRotateWithView(t){this.rotateWithView_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=pt(t)}listenImageChange(t){b()}load(){b()}unlistenImageChange(t){b()}}const Uo=Js,ch=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,uh=/^([a-z]*)$|^hsla?\(.*\)$/i;function Ho(s){return typeof s=="string"?s:$o(s)}function dh(s){const t=document.createElement("div");if(t.style.color=s,t.style.color!==""){document.body.appendChild(t);const e=getComputedStyle(t).color;return document.body.removeChild(t),e}else return""}const fh=function(){const t={};let e=0;return function(i){let n;if(t.hasOwnProperty(i))n=t[i];else{if(e>=1024){let r=0;for(const o in t)r++&3||(delete t[o],--e)}n=gh(i),t[i]=n,++e}return n}}();function hn(s){return Array.isArray(s)?s:fh(s)}function gh(s){let t,e,i,n,r;if(uh.exec(s)&&(s=dh(s)),ch.exec(s)){const o=s.length-1;let a;o<=4?a=1:a=2;const h=o===4||o===8;t=parseInt(s.substr(1+0*a,a),16),e=parseInt(s.substr(1+1*a,a),16),i=parseInt(s.substr(1+2*a,a),16),h?n=parseInt(s.substr(1+3*a,a),16):n=255,a==1&&(t=(t<<4)+t,e=(e<<4)+e,i=(i<<4)+i,h&&(n=(n<<4)+n)),r=[t,e,i,n/255]}else s.startsWith("rgba(")?(r=s.slice(5,-1).split(",").map(Number),zr(r)):s.startsWith("rgb(")?(r=s.slice(4,-1).split(",").map(Number),r.push(1),zr(r)):X(!1,14);return r}function zr(s){return s[0]=J(s[0]+.5|0,0,255),s[1]=J(s[1]+.5|0,0,255),s[2]=J(s[2]+.5|0,0,255),s[3]=J(s[3],0,1),s}function $o(s){let t=s[0];t!=(t|0)&&(t=t+.5|0);let e=s[1];e!=(e|0)&&(e=e+.5|0);let i=s[2];i!=(i|0)&&(i=i+.5|0);const n=s[3]===void 0?1:Math.round(s[3]*100)/100;return"rgba("+t+","+e+","+i+","+n+")"}function At(s){return Array.isArray(s)?$o(s):s}function xt(s,t,e,i){let n;return e&&e.length?n=e.shift():bs?n=new OffscreenCanvas(s||300,t||300):n=document.createElement("canvas"),s&&(n.width=s),t&&(n.height=t),n.getContext("2d",i)}function qo(s){const t=s.canvas;t.width=1,t.height=1,s.clearRect(0,0,1,1)}function mh(s){let t=s.offsetWidth;const e=getComputedStyle(s);return t+=parseInt(e.marginLeft,10)+parseInt(e.marginRight,10),t}function _h(s){let t=s.offsetHeight;const e=getComputedStyle(s);return t+=parseInt(e.marginTop,10)+parseInt(e.marginBottom,10),t}function Yr(s,t){const e=t.parentNode;e&&e.replaceChild(s,t)}function cn(s){return s&&s.parentNode?s.parentNode.removeChild(s):null}function Jo(s){for(;s.lastChild;)s.removeChild(s.lastChild)}function yh(s,t){const e=s.childNodes;for(let i=0;;++i){const n=e[i],r=t[i];if(!n&&!r)break;if(n!==r){if(!n){s.appendChild(r);continue}if(!r){s.removeChild(n),--i;continue}s.insertBefore(r,n)}}}const Ki="ol-hidden",ph="ol-selectable",Pn="ol-unselectable",Qs="ol-control",jr="ol-collapsed",xh=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z]+?)\\s*$`].join(""),"i"),Br=["style","variant","weight","size","lineHeight","family"],Qo=function(s){const t=s.match(xh);if(!t)return null;const e={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"};for(let i=0,n=Br.length;i<n;++i){const r=t[i+1];r!==void 0&&(e[Br[i]]=r)}return e.families=e.family.split(/,\s?/),e},ta="10px sans-serif",Vt="#000",un="round",yi=[],pi=0,Je="round",xi=10,Ei="#000",Ci="center",dn="middle",Ee=[0,0,0,0],wi=1,jt=new Lt;let Ye=null,ys;const ps={},Eh=function(){const t="32px ",e=["monospace","serif"],i=e.length,n="wmytzilWMYTZIL@#/&?$%10";let r,o;function a(c,u,d){let f=!0;for(let g=0;g<i;++g){const m=e[g];if(o=fn(c+" "+u+" "+t+m,n),d!=m){const _=fn(c+" "+u+" "+t+d+","+m,n);f=f&&_!=o}}return!!f}function h(){let c=!0;const u=jt.getKeys();for(let d=0,f=u.length;d<f;++d){const g=u[d];jt.get(g)<100&&(a.apply(this,g.split(`
`))?(Si(ps),Ye=null,ys=void 0,jt.set(g,100)):(jt.set(g,jt.get(g)+1,!0),c=!1))}c&&(clearInterval(r),r=void 0)}return function(c){const u=Qo(c);if(!u)return;const d=u.families;for(let f=0,g=d.length;f<g;++f){const m=d[f],_=u.style+`
`+u.weight+`
`+m;jt.get(_)===void 0&&(jt.set(_,100,!0),a(u.style,u.weight,m)||(jt.set(_,0,!0),r===void 0&&(r=setInterval(h,32))))}}}(),Ch=function(){let s;return function(t){let e=ps[t];if(e==null){if(bs){const i=Qo(t),n=ea(t,"Žg");e=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(n.actualBoundingBoxAscent+n.actualBoundingBoxDescent)}else s||(s=document.createElement("div"),s.innerHTML="M",s.style.minHeight="0",s.style.maxHeight="none",s.style.height="auto",s.style.padding="0",s.style.border="none",s.style.position="absolute",s.style.display="block",s.style.left="-99999px"),s.style.font=t,document.body.appendChild(s),e=s.offsetHeight,document.body.removeChild(s);ps[t]=e}return e}}();function ea(s,t){return Ye||(Ye=xt(1,1)),s!=ys&&(Ye.font=s,ys=Ye.font),Ye.measureText(t)}function fn(s,t){return ea(s,t).width}function Kr(s,t,e){if(t in e)return e[t];const i=t.split(`
`).reduce((n,r)=>Math.max(n,fn(s,r)),0);return e[t]=i,i}function wh(s,t){const e=[],i=[],n=[];let r=0,o=0,a=0,h=0;for(let c=0,u=t.length;c<=u;c+=2){const d=t[c];if(d===`
`||c===u){r=Math.max(r,o),n.push(o),o=0,a+=h;continue}const f=t[c+1]||s.font,g=fn(f,d);e.push(g),o+=g;const m=Ch(f);i.push(m),h=Math.max(h,m)}return{width:r,height:a,widths:e,heights:i,lineWidths:n}}function Rh(s,t,e,i,n,r,o,a,h,c,u){s.save(),e!==1&&(s.globalAlpha*=e),t&&s.setTransform.apply(s,t),i.contextInstructions?(s.translate(h,c),s.scale(u[0],u[1]),Th(i,s)):u[0]<0||u[1]<0?(s.translate(h,c),s.scale(u[0],u[1]),s.drawImage(i,n,r,o,a,0,0,o,a)):s.drawImage(i,n,r,o,a,h,c,o*u[0],a*u[1]),s.restore()}function Th(s,t){const e=s.contextInstructions;for(let i=0,n=e.length;i<n;i+=2)Array.isArray(e[i+1])?t[e[i]].apply(t,e[i+1]):t[e[i]]=e[i+1]}class tr extends Uo{constructor(t){const e=t.rotateWithView!==void 0?t.rotateWithView:!1;super({opacity:1,rotateWithView:e,rotation:t.rotation!==void 0?t.rotation:0,scale:t.scale!==void 0?t.scale:1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode}),this.canvas_=void 0,this.hitDetectionCanvas_=null,this.fill_=t.fill!==void 0?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius_=t.radius!==void 0?t.radius:t.radius1,this.radius2_=t.radius2,this.angle_=t.angle!==void 0?t.angle:0,this.stroke_=t.stroke!==void 0?t.stroke:null,this.size_=null,this.renderOptions_=null,this.render()}clone(){const t=this.getScale(),e=new tr({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}getAnchor(){const t=this.size_;if(!t)return null;const e=this.getDisplacement(),i=this.getScaleArray();return[t[0]/2-e[0]/i[0],t[1]/2+e[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(t){this.fill_=t,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||this.createHitDetectionCanvas_(this.renderOptions_),this.hitDetectionCanvas_}getImage(t){let e=this.canvas_[t];if(!e){const i=this.renderOptions_,n=xt(i.size*t,i.size*t);this.draw_(i,n,t),e=n.canvas,this.canvas_[t]=e}return e}getPixelRatio(t){return t}getImageSize(){return this.size_}getImageState(){return Q.LOADED}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius_}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t,this.render()}listenImageChange(t){}load(){}unlistenImageChange(t){}calculateLineJoinSize_(t,e,i){if(e===0||this.points_===1/0||t!=="bevel"&&t!=="miter")return e;let n=this.radius_,r=this.radius2_===void 0?n:this.radius2_;if(n<r){const w=n;n=r,r=w}const o=this.radius2_===void 0?this.points_:this.points_*2,a=2*Math.PI/o,h=r*Math.sin(a),c=Math.sqrt(r*r-h*h),u=n-c,d=Math.sqrt(h*h+u*u),f=d/h;if(t==="miter"&&f<=i)return f*e;const g=e/2/f,m=e/2*(u/d),p=Math.sqrt((n+g)*(n+g)+m*m)-n;if(this.radius2_===void 0||t==="bevel")return p*2;const x=n*Math.sin(a),l=Math.sqrt(n*n-x*x),y=r-l,C=Math.sqrt(x*x+y*y)/x;if(C<=i){const w=C*e/2-r-n;return 2*Math.max(p,w)}return p*2}createRenderOptions(){let t=Je,e=0,i=null,n=0,r,o=0;this.stroke_&&(r=this.stroke_.getColor(),r===null&&(r=Ei),r=At(r),o=this.stroke_.getWidth(),o===void 0&&(o=wi),i=this.stroke_.getLineDash(),n=this.stroke_.getLineDashOffset(),t=this.stroke_.getLineJoin(),t===void 0&&(t=Je),e=this.stroke_.getMiterLimit(),e===void 0&&(e=xi));const a=this.calculateLineJoinSize_(t,o,e),h=Math.max(this.radius_,this.radius2_||0),c=Math.ceil(2*h+a);return{strokeStyle:r,strokeWidth:o,size:c,lineDash:i,lineDashOffset:n,lineJoin:t,miterLimit:e}}render(){this.renderOptions_=this.createRenderOptions();const t=this.renderOptions_.size;this.canvas_={},this.size_=[t,t]}draw_(t,e,i){if(e.scale(i,i),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){let n=this.fill_.getColor();n===null&&(n=Vt),e.fillStyle=At(n),e.fill()}this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}createHitDetectionCanvas_(t){if(this.fill_){let e=this.fill_.getColor(),i=0;if(typeof e=="string"&&(e=hn(e)),e===null?i=1:Array.isArray(e)&&(i=e.length===4?e[3]:1),i===0){const n=xt(t.size,t.size);this.hitDetectionCanvas_=n.canvas,this.drawHitDetectionCanvas_(t,n)}}this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.getImage(1))}createPath_(t){let e=this.points_;const i=this.radius_;if(e===1/0)t.arc(0,0,i,0,2*Math.PI);else{const n=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(e*=2);const r=this.angle_-Math.PI/2,o=2*Math.PI/e;for(let a=0;a<e;a++){const h=r+a*o,c=a%2===0?i:n;t.lineTo(c*Math.cos(h),c*Math.sin(h))}t.closePath()}}drawHitDetectionCanvas_(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=Vt,e.fill(),this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}}const gn=tr;class er extends gn{constructor(t){t=t||{radius:5},super({points:1/0,fill:t.fill,radius:t.radius,stroke:t.stroke,scale:t.scale!==void 0?t.scale:1,rotation:t.rotation!==void 0?t.rotation:0,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode})}clone(){const t=this.getScale(),e=new er({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}setRadius(t){this.radius_=t,this.render()}}const _e=er;class An{constructor(t){t=t||{},this.geometry_=null,this.geometryFunction_=Zr,t.geometry!==void 0&&this.setGeometry(t.geometry),this.fill_=t.fill!==void 0?t.fill:null,this.image_=t.image!==void 0?t.image:null,this.renderer_=t.renderer!==void 0?t.renderer:null,this.hitDetectionRenderer_=t.hitDetectionRenderer!==void 0?t.hitDetectionRenderer:null,this.stroke_=t.stroke!==void 0?t.stroke:null,this.text_=t.text!==void 0?t.text:null,this.zIndex_=t.zIndex}clone(){let t=this.getGeometry();return t&&typeof t=="object"&&(t=t.clone()),new An({geometry:t,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer(),stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(t){this.renderer_=t}setHitDetectionRenderer(t){this.hitDetectionRenderer_=t}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(t){this.fill_=t}getImage(){return this.image_}setImage(t){this.image_=t}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t}getText(){return this.text_}setText(t){this.text_=t}getZIndex(){return this.zIndex_}setGeometry(t){typeof t=="function"?this.geometryFunction_=t:typeof t=="string"?this.geometryFunction_=function(e){return e.get(t)}:t?t!==void 0&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=Zr,this.geometry_=t}setZIndex(t){this.zIndex_=t}}function vh(s){let t;if(typeof s=="function")t=s;else{let e;Array.isArray(s)?e=s:(X(typeof s.getZIndex=="function",41),e=[s]),t=function(){return e}}return t}let Kn=null;function Ih(s,t){if(!Kn){const e=new St({color:"rgba(255,255,255,0.4)"}),i=new lt({color:"#3399CC",width:1.25});Kn=[new An({image:new _e({fill:e,stroke:i,radius:5}),fill:e,stroke:i})]}return Kn}function Zr(s){return s.getGeometry()}const ht=An,Sh="#333";class ir{constructor(t){t=t||{},this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.scale_=t.scale,this.scaleArray_=pt(t.scale!==void 0?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.textBaseline_=t.textBaseline,this.fill_=t.fill!==void 0?t.fill:new St({color:Sh}),this.maxAngle_=t.maxAngle!==void 0?t.maxAngle:Math.PI/4,this.placement_=t.placement!==void 0?t.placement:"point",this.overflow_=!!t.overflow,this.stroke_=t.stroke!==void 0?t.stroke:null,this.offsetX_=t.offsetX!==void 0?t.offsetX:0,this.offsetY_=t.offsetY!==void 0?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=t.padding===void 0?null:t.padding}clone(){const t=this.getScale();return new ir({font:this.getFont(),placement:this.getPlacement(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}setOverflow(t){this.overflow_=t}setFont(t){this.font_=t}setMaxAngle(t){this.maxAngle_=t}setOffsetX(t){this.offsetX_=t}setOffsetY(t){this.offsetY_=t}setPlacement(t){this.placement_=t}setRotateWithView(t){this.rotateWithView_=t}setFill(t){this.fill_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=pt(t!==void 0?t:1)}setStroke(t){this.stroke_=t}setText(t){this.text_=t}setTextAlign(t){this.textAlign_=t}setJustify(t){this.justify_=t}setTextBaseline(t){this.textBaseline_=t}setBackgroundFill(t){this.backgroundFill_=t}setBackgroundStroke(t){this.backgroundStroke_=t}setPadding(t){this.padding_=t}}const ia=ir,j={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class Lh extends Lt{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;const e=Object.assign({},t);typeof t.properties=="object"&&(delete e.properties,Object.assign(e,t.properties)),e[j.OPACITY]=t.opacity!==void 0?t.opacity:1,X(typeof e[j.OPACITY]=="number",64),e[j.VISIBLE]=t.visible!==void 0?t.visible:!0,e[j.Z_INDEX]=t.zIndex,e[j.MAX_RESOLUTION]=t.maxResolution!==void 0?t.maxResolution:1/0,e[j.MIN_RESOLUTION]=t.minResolution!==void 0?t.minResolution:0,e[j.MIN_ZOOM]=t.minZoom!==void 0?t.minZoom:-1/0,e[j.MAX_ZOOM]=t.maxZoom!==void 0?t.maxZoom:1/0,this.className_=e.className!==void 0?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){const e=this.state_||{layer:this,managed:t===void 0?!0:t},i=this.getZIndex();return e.opacity=J(Math.round(this.getOpacity()*100)/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=i===void 0&&!e.managed?1/0:i,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return b()}getLayerStatesArray(t){return b()}getExtent(){return this.get(j.EXTENT)}getMaxResolution(){return this.get(j.MAX_RESOLUTION)}getMinResolution(){return this.get(j.MIN_RESOLUTION)}getMinZoom(){return this.get(j.MIN_ZOOM)}getMaxZoom(){return this.get(j.MAX_ZOOM)}getOpacity(){return this.get(j.OPACITY)}getSourceState(){return b()}getVisible(){return this.get(j.VISIBLE)}getZIndex(){return this.get(j.Z_INDEX)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(j.EXTENT,t)}setMaxResolution(t){this.set(j.MAX_RESOLUTION,t)}setMinResolution(t){this.set(j.MIN_RESOLUTION,t)}setMaxZoom(t){this.set(j.MAX_ZOOM,t)}setMinZoom(t){this.set(j.MIN_ZOOM,t)}setOpacity(t){X(typeof t=="number",64),this.set(j.OPACITY,t)}setVisible(t){this.set(j.VISIBLE,t)}setZIndex(t){this.set(j.Z_INDEX,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}const na=Lh;class On extends na{constructor(t){const e=Object.assign({},t);delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(j.SOURCE,this.handleSourcePropertyChange_);const i=t.source?t.source:null;this.setSource(i)}getLayersArray(t){return t=t||[],t.push(this),t}getLayerStatesArray(t){return t=t||[],t.push(this.getLayerState()),t}getSource(){return this.get(j.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed()}handleSourcePropertyChange_(){this.sourceChangeKey_&&(Z(this.sourceChangeKey_),this.sourceChangeKey_=null);const t=this.getSource();t&&(this.sourceChangeKey_=W(t,k.CHANGE,this.handleSourceChange_,this)),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):new Promise(e=>e([]))}getData(t){return!this.renderer_||!this.rendered?null:this.renderer_.getData(t)}render(t,e){const i=this.getRenderer();if(i.prepareFrame(t))return this.rendered=!0,i.renderFrame(t,e)}unrender(){this.rendered=!1}setMapInternal(t){t||this.unrender(),this.set(j.MAP,t)}getMapInternal(){return this.get(j.MAP)}setMap(t){this.mapPrecomposeKey_&&(Z(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(Z(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=W(t,le.PRECOMPOSE,function(e){const n=e.frameState.layerStatesArray,r=this.getLayerState(!1);X(!n.some(function(o){return o.layer===r.layer}),67),n.push(r)},this),this.mapRenderKey_=W(this,k.CHANGE,t.render,t),this.changed())}setSource(t){this.set(j.SOURCE,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}disposeInternal(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),super.disposeInternal()}}function nr(s,t){if(!s.visible)return!1;const e=t.resolution;if(e<s.minResolution||e>=s.maxResolution)return!1;const i=t.zoom;return i>s.minZoom&&i<=s.maxZoom}function Mh(s,t,e,i,n){sa(s,t,e||0,i||s.length-1,n||Ph)}function sa(s,t,e,i,n){for(;i>e;){if(i-e>600){var r=i-e+1,o=t-e+1,a=Math.log(r),h=.5*Math.exp(2*a/3),c=.5*Math.sqrt(a*h*(r-h)/r)*(o-r/2<0?-1:1),u=Math.max(e,Math.floor(t-o*h/r+c)),d=Math.min(i,Math.floor(t+(r-o)*h/r+c));sa(s,t,u,d,n)}var f=s[t],g=e,m=i;for(oi(s,e,t),n(s[i],f)>0&&oi(s,e,i);g<m;){for(oi(s,g,m),g++,m--;n(s[g],f)<0;)g++;for(;n(s[m],f)>0;)m--}n(s[e],f)===0?oi(s,e,m):(m++,oi(s,m,i)),m<=t&&(e=m+1),t<=m&&(i=m-1)}}function oi(s,t,e){var i=s[t];s[t]=s[e],s[e]=i}function Ph(s,t){return s<t?-1:s>t?1:0}let ra=class{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(t){let e=this.data;const i=[];if(!Vi(t,e))return i;const n=this.toBBox,r=[];for(;e;){for(let o=0;o<e.children.length;o++){const a=e.children[o],h=e.leaf?n(a):a;Vi(t,h)&&(e.leaf?i.push(a):Vn(t,h)?this._all(a,i):r.push(a))}e=r.pop()}return i}collides(t){let e=this.data;if(!Vi(t,e))return!1;const i=[];for(;e;){for(let n=0;n<e.children.length;n++){const r=e.children[n],o=e.leaf?this.toBBox(r):r;if(Vi(t,o)){if(e.leaf||Vn(t,o))return!0;i.push(r)}}e=i.pop()}return!1}load(t){if(!(t&&t.length))return this;if(t.length<this._minEntries){for(let i=0;i<t.length;i++)this.insert(t[i]);return this}let e=this._build(t.slice(),0,t.length-1,0);if(!this.data.children.length)this.data=e;else if(this.data.height===e.height)this._splitRoot(this.data,e);else{if(this.data.height<e.height){const i=this.data;this.data=e,e=i}this._insert(e,this.data.height-e.height-1,!0)}return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=je([]),this}remove(t,e){if(!t)return this;let i=this.data;const n=this.toBBox(t),r=[],o=[];let a,h,c;for(;i||r.length;){if(i||(i=r.pop(),h=r[r.length-1],a=o.pop(),c=!0),i.leaf){const u=Ah(t,i.children,e);if(u!==-1)return i.children.splice(u,1),r.push(i),this._condense(r),this}!c&&!i.leaf&&Vn(i,n)?(r.push(i),o.push(a),a=0,h=i,i=i.children[0]):h?(a++,i=h.children[a],c=!1):i=null}return this}toBBox(t){return t}compareMinX(t,e){return t.minX-e.minX}compareMinY(t,e){return t.minY-e.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,e){const i=[];for(;t;)t.leaf?e.push(...t.children):i.push(...t.children),t=i.pop();return e}_build(t,e,i,n){const r=i-e+1;let o=this._maxEntries,a;if(r<=o)return a=je(t.slice(e,i+1)),Xe(a,this.toBBox),a;n||(n=Math.ceil(Math.log(r)/Math.log(o)),o=Math.ceil(r/Math.pow(o,n-1))),a=je([]),a.leaf=!1,a.height=n;const h=Math.ceil(r/o),c=h*Math.ceil(Math.sqrt(o));Vr(t,e,i,c,this.compareMinX);for(let u=e;u<=i;u+=c){const d=Math.min(u+c-1,i);Vr(t,u,d,h,this.compareMinY);for(let f=u;f<=d;f+=h){const g=Math.min(f+h-1,d);a.children.push(this._build(t,f,g,n-1))}}return Xe(a,this.toBBox),a}_chooseSubtree(t,e,i,n){for(;n.push(e),!(e.leaf||n.length-1===i);){let r=1/0,o=1/0,a;for(let h=0;h<e.children.length;h++){const c=e.children[h],u=Zn(c),d=Fh(t,c)-u;d<o?(o=d,r=u<r?u:r,a=c):d===o&&u<r&&(r=u,a=c)}e=a||e.children[0]}return e}_insert(t,e,i){const n=i?t:this.toBBox(t),r=[],o=this._chooseSubtree(n,this.data,e,r);for(o.children.push(t),hi(o,n);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(n,r,e)}_split(t,e){const i=t[e],n=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,n);const o=this._chooseSplitIndex(i,r,n),a=je(i.children.splice(o,i.children.length-o));a.height=i.height,a.leaf=i.leaf,Xe(i,this.toBBox),Xe(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(i,a)}_splitRoot(t,e){this.data=je([t,e]),this.data.height=t.height+1,this.data.leaf=!1,Xe(this.data,this.toBBox)}_chooseSplitIndex(t,e,i){let n,r=1/0,o=1/0;for(let a=e;a<=i-e;a++){const h=li(t,0,a,this.toBBox),c=li(t,a,i,this.toBBox),u=kh(h,c),d=Zn(h)+Zn(c);u<r?(r=u,n=a,o=d<o?d:o):u===r&&d<o&&(o=d,n=a)}return n||i-e}_chooseSplitAxis(t,e,i){const n=t.leaf?this.compareMinX:Oh,r=t.leaf?this.compareMinY:bh,o=this._allDistMargin(t,e,i,n),a=this._allDistMargin(t,e,i,r);o<a&&t.children.sort(n)}_allDistMargin(t,e,i,n){t.children.sort(n);const r=this.toBBox,o=li(t,0,e,r),a=li(t,i-e,i,r);let h=Zi(o)+Zi(a);for(let c=e;c<i-e;c++){const u=t.children[c];hi(o,t.leaf?r(u):u),h+=Zi(o)}for(let c=i-e-1;c>=e;c--){const u=t.children[c];hi(a,t.leaf?r(u):u),h+=Zi(a)}return h}_adjustParentBBoxes(t,e,i){for(let n=i;n>=0;n--)hi(e[n],t)}_condense(t){for(let e=t.length-1,i;e>=0;e--)t[e].children.length===0?e>0?(i=t[e-1].children,i.splice(i.indexOf(t[e]),1)):this.clear():Xe(t[e],this.toBBox)}};function Ah(s,t,e){if(!e)return t.indexOf(s);for(let i=0;i<t.length;i++)if(e(s,t[i]))return i;return-1}function Xe(s,t){li(s,0,s.children.length,t,s)}function li(s,t,e,i,n){n||(n=je(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(let r=t;r<e;r++){const o=s.children[r];hi(n,s.leaf?i(o):o)}return n}function hi(s,t){return s.minX=Math.min(s.minX,t.minX),s.minY=Math.min(s.minY,t.minY),s.maxX=Math.max(s.maxX,t.maxX),s.maxY=Math.max(s.maxY,t.maxY),s}function Oh(s,t){return s.minX-t.minX}function bh(s,t){return s.minY-t.minY}function Zn(s){return(s.maxX-s.minX)*(s.maxY-s.minY)}function Zi(s){return s.maxX-s.minX+(s.maxY-s.minY)}function Fh(s,t){return(Math.max(t.maxX,s.maxX)-Math.min(t.minX,s.minX))*(Math.max(t.maxY,s.maxY)-Math.min(t.minY,s.minY))}function kh(s,t){const e=Math.max(s.minX,t.minX),i=Math.max(s.minY,t.minY),n=Math.min(s.maxX,t.maxX),r=Math.min(s.maxY,t.maxY);return Math.max(0,n-e)*Math.max(0,r-i)}function Vn(s,t){return s.minX<=t.minX&&s.minY<=t.minY&&t.maxX<=s.maxX&&t.maxY<=s.maxY}function Vi(s,t){return t.minX<=s.maxX&&t.minY<=s.maxY&&t.maxX>=s.minX&&t.maxY>=s.minY}function je(s){return{children:s,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Vr(s,t,e,i,n){const r=[t,e];for(;r.length;){if(e=r.pop(),t=r.pop(),e-t<=i)continue;const o=t+Math.ceil((e-t)/i/2)*i;Mh(s,o,t,e,n),r.push(t,o,o,e)}}class Dh{constructor(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}clear(){this.cache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(const e in this.cache_){const i=this.cache_[e];!(t++&3)&&!i.hasListener()&&(delete this.cache_[e],--this.cacheSize_)}}}get(t,e,i){const n=Ur(t,e,i);return n in this.cache_?this.cache_[n]:null}set(t,e,i,n){const r=Ur(t,e,i);this.cache_[r]=n,++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}}function Ur(s,t,e){const i=e?Ho(e):"null";return t+":"+s+":"+i}const mn=new Dh;function oa(s,t,e){const i=s;let n=!0,r=!1,o=!1;const a=[en(i,k.LOAD,function(){o=!0,r||t()})];return i.src&&ll?(r=!0,i.decode().then(function(){n&&t()}).catch(function(h){n&&(o?t():e())})):a.push(en(i,k.ERROR,e)),function(){n=!1,a.forEach(Z)}}let ai=null;class Nh extends Cn{constructor(t,e,i,n,r,o){super(),this.hitDetectionImage_=null,this.image_=t,this.crossOrigin_=n,this.canvas_={},this.color_=o,this.unlisten_=null,this.imageState_=r,this.size_=i,this.src_=e,this.tainted_}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===Q.LOADED){ai||(ai=xt(1,1)),ai.drawImage(this.image_,0,0);try{ai.getImageData(0,0,1,1),this.tainted_=!1}catch{ai=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(k.CHANGE)}handleImageError_(){this.imageState_=Q.ERROR,this.unlistenImage_(),this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=Q.LOADED,this.size_?(this.image_.width=this.size_[0],this.image_.height=this.size_[1]):this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.dispatchChangeEvent_()}getImage(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}getPixelRatio(t){return this.replaceColor_(t),this.canvas_[t]?t:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const t=this.size_[0],e=this.size_[1],i=xt(t,e);i.fillRect(0,0,t,e),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===Q.IDLE){this.image_||this.initializeImage_(),this.imageState_=Q.LOADING;try{this.image_.src=this.src_}catch{this.handleImageError_()}this.unlisten_=oa(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}}replaceColor_(t){if(!this.color_||this.canvas_[t]||this.imageState_!==Q.LOADED)return;const e=this.image_,i=document.createElement("canvas");i.width=Math.ceil(e.width*t),i.height=Math.ceil(e.height*t);const n=i.getContext("2d");n.scale(t,t),n.drawImage(e,0,0),n.globalCompositeOperation="multiply",n.fillStyle=Ho(this.color_),n.fillRect(0,0,i.width/t,i.height/t),n.globalCompositeOperation="destination-in",n.drawImage(e,0,0),this.canvas_[t]=i}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}function Gh(s,t,e,i,n,r){let o=mn.get(t,i,r);return o||(o=new Nh(s,t,e,i,n,r),mn.set(t,i,r,o)),o}class sr extends Uo{constructor(t){t=t||{};const e=t.opacity!==void 0?t.opacity:1,i=t.rotation!==void 0?t.rotation:0,n=t.scale!==void 0?t.scale:1,r=t.rotateWithView!==void 0?t.rotateWithView:!1;super({opacity:e,rotation:i,scale:n,displacement:t.displacement!==void 0?t.displacement:[0,0],rotateWithView:r,declutterMode:t.declutterMode}),this.anchor_=t.anchor!==void 0?t.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=t.anchorOrigin!==void 0?t.anchorOrigin:"top-left",this.anchorXUnits_=t.anchorXUnits!==void 0?t.anchorXUnits:"fraction",this.anchorYUnits_=t.anchorYUnits!==void 0?t.anchorYUnits:"fraction",this.crossOrigin_=t.crossOrigin!==void 0?t.crossOrigin:null;const o=t.img!==void 0?t.img:null;this.imgSize_=t.imgSize;let a=t.src;X(!(a!==void 0&&o),4),X(!o||o&&this.imgSize_,5),(a===void 0||a.length===0)&&o&&(a=o.src||z(o)),X(a!==void 0&&a.length>0,6);const h=t.src!==void 0?Q.IDLE:Q.LOADED;this.color_=t.color!==void 0?hn(t.color):null,this.iconImage_=Gh(o,a,this.imgSize_!==void 0?this.imgSize_:null,this.crossOrigin_,h,this.color_),this.offset_=t.offset!==void 0?t.offset:[0,0],this.offsetOrigin_=t.offsetOrigin!==void 0?t.offsetOrigin:"top-left",this.origin_=null,this.size_=t.size!==void 0?t.size:null}clone(){const t=this.getScale();return new sr({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,imgSize:this.imgSize_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:Array.isArray(t)?t.slice():t,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let t=this.normalizedAnchor_;if(!t){t=this.anchor_;const n=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!n)return null;t=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(t[0]*=n[0]),this.anchorYUnits_=="fraction"&&(t[1]*=n[1])}if(this.anchorOrigin_!="top-left"){if(!n)return null;t===this.anchor_&&(t=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(t[0]=-t[0]+n[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(t[1]=-t[1]+n[1])}this.normalizedAnchor_=t}const e=this.getDisplacement(),i=this.getScaleArray();return[t[0]-e[0]/i[0],t[1]+e[1]/i[1]]}setAnchor(t){this.anchor_=t,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(t){return this.iconImage_.getImage(t)}getPixelRatio(t){return this.iconImage_.getPixelRatio(t)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let t=this.offset_;if(this.offsetOrigin_!="top-left"){const e=this.getSize(),i=this.iconImage_.getSize();if(!e||!i)return null;t=t.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(t[0]=i[0]-e[0]-t[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(t[1]=i[1]-e[1]-t[1])}return this.origin_=t,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}listenImageChange(t){this.iconImage_.addEventListener(k.CHANGE,t)}load(){this.iconImage_.load()}unlistenImageChange(t){this.iconImage_.removeEventListener(k.CHANGE,t)}}const rr=sr;function Hr(s){return new ht({fill:Ri(s,""),stroke:Ti(s,""),text:Xh(s),image:Wh(s)})}function Ri(s,t){const e=s[t+"fill-color"];if(e)return new St({color:e})}function Ti(s,t){const e=s[t+"stroke-width"],i=s[t+"stroke-color"];if(!(!e&&!i))return new lt({width:e,color:i,lineCap:s[t+"stroke-line-cap"],lineJoin:s[t+"stroke-line-join"],lineDash:s[t+"stroke-line-dash"],lineDashOffset:s[t+"stroke-line-dash-offset"],miterLimit:s[t+"stroke-miter-limit"]})}function Xh(s){const t=s["text-value"];return t?new ia({text:t,font:s["text-font"],maxAngle:s["text-max-angle"],offsetX:s["text-offset-x"],offsetY:s["text-offset-y"],overflow:s["text-overflow"],placement:s["text-placement"],scale:s["text-scale"],rotateWithView:s["text-rotate-with-view"],rotation:s["text-rotation"],textAlign:s["text-align"],justify:s["text-justify"],textBaseline:s["text-baseline"],padding:s["text-padding"],fill:Ri(s,"text-"),backgroundFill:Ri(s,"text-background-"),stroke:Ti(s,"text-"),backgroundStroke:Ti(s,"text-background-")}):void 0}function Wh(s){const t=s["icon-src"],e=s["icon-img"];if(t||e)return new rr({src:t,img:e,imgSize:s["icon-img-size"],anchor:s["icon-anchor"],anchorOrigin:s["icon-anchor-origin"],anchorXUnits:s["icon-anchor-x-units"],anchorYUnits:s["icon-anchor-y-units"],color:s["icon-color"],crossOrigin:s["icon-cross-origin"],offset:s["icon-offset"],displacement:s["icon-displacement"],opacity:s["icon-opacity"],scale:s["icon-scale"],rotation:s["icon-rotation"],rotateWithView:s["icon-rotate-with-view"],size:s["icon-size"],declutterMode:s["icon-declutter-mode"]});const i=s["shape-points"];if(i){const r="shape-";return new gn({points:i,fill:Ri(s,r),stroke:Ti(s,r),radius:s["shape-radius"],radius1:s["shape-radius1"],radius2:s["shape-radius2"],angle:s["shape-angle"],displacement:s["shape-displacement"],rotation:s["shape-rotation"],rotateWithView:s["shape-rotate-with-view"],scale:s["shape-scale"],declutterMode:s["shape-declutter-mode"]})}const n=s["circle-radius"];if(n){const r="circle-";return new _e({radius:n,fill:Ri(s,r),stroke:Ti(s,r),displacement:s["circle-displacement"],scale:s["circle-scale"],rotation:s["circle-rotation"],rotateWithView:s["circle-rotate-with-view"],declutterMode:s["circle-declutter-mode"]})}}const $r={RENDER_ORDER:"renderOrder"};class zh extends On{constructor(t){t=t||{};const e=Object.assign({},t);delete e.style,delete e.renderBuffer,delete e.updateWhileAnimating,delete e.updateWhileInteracting,super(e),this.declutter_=t.declutter!==void 0?t.declutter:!1,this.renderBuffer_=t.renderBuffer!==void 0?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=t.updateWhileAnimating!==void 0?t.updateWhileAnimating:!1,this.updateWhileInteracting_=t.updateWhileInteracting!==void 0?t.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(t){return super.getFeatures(t)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get($r.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(t){t.declutterTree||(t.declutterTree=new ra(9)),this.getRenderer().renderDeclutter(t)}setRenderOrder(t){this.set($r.RENDER_ORDER,t)}setStyle(t){let e;if(t===void 0)e=Ih;else if(t===null)e=null;else if(typeof t=="function")e=t;else if(t instanceof ht)e=t;else if(Array.isArray(t)){const i=t.length,n=new Array(i);for(let r=0;r<i;++r){const o=t[r];o instanceof ht?n[r]=o:n[r]=Hr(o)}e=n}else e=Hr(t);this.style_=e,this.styleFunction_=t===null?void 0:vh(this.style_),this.changed()}}const Yh=zh,Pi={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Ui=[Pi.FILL],oe=[Pi.STROKE],Ce=[Pi.BEGIN_PATH],qr=[Pi.CLOSE_PATH],O=Pi;class jh{drawCustom(t,e,i,n){}drawGeometry(t){}setStyle(t){}drawCircle(t,e){}drawFeature(t,e){}drawGeometryCollection(t,e){}drawLineString(t,e){}drawMultiLineString(t,e){}drawMultiPoint(t,e){}drawMultiPolygon(t,e){}drawPoint(t,e){}drawPolygon(t,e){}drawText(t,e){}setFillStrokeStyle(t,e){}setImageStyle(t,e){}setTextStyle(t,e){}}const aa=jh;class Bh extends aa{constructor(t,e,i,n){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=n,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const e=this.pixelRatio;return e==1?t:t.map(function(i){return i*e})}appendFlatPointCoordinates(t,e){const i=this.getBufferedMaxExtent(),n=this.tmpCoordinate_,r=this.coordinates;let o=r.length;for(let a=0,h=t.length;a<h;a+=e)n[0]=t[a],n[1]=t[a+1],Rn(i,n)&&(r[o++]=n[0],r[o++]=n[1]);return o}appendFlatLineCoordinates(t,e,i,n,r,o){const a=this.coordinates;let h=a.length;const c=this.getBufferedMaxExtent();o&&(e+=n);let u=t[e],d=t[e+1];const f=this.tmpCoordinate_;let g=!0,m,_,p;for(m=e+n;m<i;m+=n)f[0]=t[m],f[1]=t[m+1],p=os(c,f),p!==_?(g&&(a[h++]=u,a[h++]=d,g=!1),a[h++]=f[0],a[h++]=f[1]):p===et.INTERSECTING?(a[h++]=f[0],a[h++]=f[1],g=!1):g=!0,u=f[0],d=f[1],_=p;return(r&&g||m===e+n)&&(a[h++]=u,a[h++]=d),h}drawCustomCoordinates_(t,e,i,n,r){for(let o=0,a=i.length;o<a;++o){const h=i[o],c=this.appendFlatLineCoordinates(t,e,h,n,!1,!1);r.push(c),e=h}return e}drawCustom(t,e,i,n){this.beginGeometry(t,e);const r=t.getType(),o=t.getStride(),a=this.coordinates.length;let h,c,u,d,f;switch(r){case"MultiPolygon":h=t.getOrientedFlatCoordinates(),d=[];const g=t.getEndss();f=0;for(let m=0,_=g.length;m<_;++m){const p=[];f=this.drawCustomCoordinates_(h,f,g[m],o,p),d.push(p)}this.instructions.push([O.CUSTOM,a,d,t,i,fs]),this.hitDetectionInstructions.push([O.CUSTOM,a,d,t,n||i,fs]);break;case"Polygon":case"MultiLineString":u=[],h=r=="Polygon"?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),f=this.drawCustomCoordinates_(h,0,t.getEnds(),o,u),this.instructions.push([O.CUSTOM,a,u,t,i,mi]),this.hitDetectionInstructions.push([O.CUSTOM,a,u,t,n||i,mi]);break;case"LineString":case"Circle":h=t.getFlatCoordinates(),c=this.appendFlatLineCoordinates(h,0,h.length,o,!1,!1),this.instructions.push([O.CUSTOM,a,c,t,i,re]),this.hitDetectionInstructions.push([O.CUSTOM,a,c,t,n||i,re]);break;case"MultiPoint":h=t.getFlatCoordinates(),c=this.appendFlatPointCoordinates(h,o),c>a&&(this.instructions.push([O.CUSTOM,a,c,t,i,re]),this.hitDetectionInstructions.push([O.CUSTOM,a,c,t,n||i,re]));break;case"Point":h=t.getFlatCoordinates(),this.coordinates.push(h[0],h[1]),c=this.coordinates.length,this.instructions.push([O.CUSTOM,a,c,t,i]),this.hitDetectionInstructions.push([O.CUSTOM,a,c,t,n||i]);break}this.endGeometry(e)}beginGeometry(t,e){this.beginGeometryInstruction1_=[O.BEGIN_GEOMETRY,e,0,t],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[O.BEGIN_GEOMETRY,e,0,t],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;t.reverse();let e;const i=t.length;let n,r,o=-1;for(e=0;e<i;++e)n=t[e],r=n[0],r==O.END_GEOMETRY?o=e:r==O.BEGIN_GEOMETRY&&(n[2]=e,Ha(this.hitDetectionInstructions,o,e),o=-1)}setFillStrokeStyle(t,e){const i=this.state;if(t){const n=t.getColor();i.fillStyle=At(n||Vt)}else i.fillStyle=void 0;if(e){const n=e.getColor();i.strokeStyle=At(n||Ei);const r=e.getLineCap();i.lineCap=r!==void 0?r:un;const o=e.getLineDash();i.lineDash=o?o.slice():yi;const a=e.getLineDashOffset();i.lineDashOffset=a||pi;const h=e.getLineJoin();i.lineJoin=h!==void 0?h:Je;const c=e.getWidth();i.lineWidth=c!==void 0?c:wi;const u=e.getMiterLimit();i.miterLimit=u!==void 0?u:xi,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0}createFill(t){const e=t.fillStyle,i=[O.SET_FILL_STYLE,e];return typeof e!="string"&&i.push(!0),i}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[O.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){const i=t.fillStyle;(typeof i!="string"||t.currentFillStyle!=i)&&(i!==void 0&&this.instructions.push(e.call(this,t)),t.currentFillStyle=i)}updateStrokeStyle(t,e){const i=t.strokeStyle,n=t.lineCap,r=t.lineDash,o=t.lineDashOffset,a=t.lineJoin,h=t.lineWidth,c=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=n||r!=t.currentLineDash&&!Le(t.currentLineDash,r)||t.currentLineDashOffset!=o||t.currentLineJoin!=a||t.currentLineWidth!=h||t.currentMiterLimit!=c)&&(i!==void 0&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=n,t.currentLineDash=r,t.currentLineDashOffset=o,t.currentLineJoin=a,t.currentLineWidth=h,t.currentMiterLimit=c)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const e=[O.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=wo(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;ks(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}const Ai=Bh;class Kh extends Ai{constructor(t,e,i,n){super(t,e,i,n),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e){if(!this.image_)return;this.beginGeometry(t,e);const i=t.getFlatCoordinates(),n=t.getStride(),r=this.coordinates.length,o=this.appendFlatPointCoordinates(i,n);this.instructions.push([O.DRAW_IMAGE,r,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([O.DRAW_IMAGE,r,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e){if(!this.image_)return;this.beginGeometry(t,e);const i=t.getFlatCoordinates(),n=t.getStride(),r=this.coordinates.length,o=this.appendFlatPointCoordinates(i,n);this.instructions.push([O.DRAW_IMAGE,r,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([O.DRAW_IMAGE,r,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){const i=t.getAnchor(),n=t.getSize(),r=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=n[1],this.opacity_=t.getOpacity(),this.originX_=r[0],this.originY_=r[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=n[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}const Zh=Kh;class Vh extends Ai{constructor(t,e,i,n){super(t,e,i,n)}drawFlatCoordinates_(t,e,i,n){const r=this.coordinates.length,o=this.appendFlatLineCoordinates(t,e,i,n,!1,!1),a=[O.MOVE_TO_LINE_TO,r,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),i}drawLineString(t,e){const i=this.state,n=i.strokeStyle,r=i.lineWidth;if(n===void 0||r===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([O.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,yi,pi],Ce);const o=t.getFlatCoordinates(),a=t.getStride();this.drawFlatCoordinates_(o,0,o.length,a),this.hitDetectionInstructions.push(oe),this.endGeometry(e)}drawMultiLineString(t,e){const i=this.state,n=i.strokeStyle,r=i.lineWidth;if(n===void 0||r===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([O.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset],Ce);const o=t.getEnds(),a=t.getFlatCoordinates(),h=t.getStride();let c=0;for(let u=0,d=o.length;u<d;++u)c=this.drawFlatCoordinates_(a,c,o[u],h);this.hitDetectionInstructions.push(oe),this.endGeometry(e)}finish(){const t=this.state;return t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&this.instructions.push(oe),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(oe),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(Ce)}}const Uh=Vh;class Hh extends Ai{constructor(t,e,i,n){super(t,e,i,n)}drawFlatCoordinatess_(t,e,i,n){const r=this.state,o=r.fillStyle!==void 0,a=r.strokeStyle!==void 0,h=i.length;this.instructions.push(Ce),this.hitDetectionInstructions.push(Ce);for(let c=0;c<h;++c){const u=i[c],d=this.coordinates.length,f=this.appendFlatLineCoordinates(t,e,u,n,!0,!a),g=[O.MOVE_TO_LINE_TO,d,f];this.instructions.push(g),this.hitDetectionInstructions.push(g),a&&(this.instructions.push(qr),this.hitDetectionInstructions.push(qr)),e=u}return o&&(this.instructions.push(Ui),this.hitDetectionInstructions.push(Ui)),a&&(this.instructions.push(oe),this.hitDetectionInstructions.push(oe)),e}drawCircle(t,e){const i=this.state,n=i.fillStyle,r=i.strokeStyle;if(n===void 0&&r===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([O.SET_FILL_STYLE,Vt]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([O.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);const o=t.getFlatCoordinates(),a=t.getStride(),h=this.coordinates.length;this.appendFlatLineCoordinates(o,0,o.length,a,!1,!1);const c=[O.CIRCLE,h];this.instructions.push(Ce,c),this.hitDetectionInstructions.push(Ce,c),i.fillStyle!==void 0&&(this.instructions.push(Ui),this.hitDetectionInstructions.push(Ui)),i.strokeStyle!==void 0&&(this.instructions.push(oe),this.hitDetectionInstructions.push(oe)),this.endGeometry(e)}drawPolygon(t,e){const i=this.state,n=i.fillStyle,r=i.strokeStyle;if(n===void 0&&r===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([O.SET_FILL_STYLE,Vt]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([O.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);const o=t.getEnds(),a=t.getOrientedFlatCoordinates(),h=t.getStride();this.drawFlatCoordinatess_(a,0,o,h),this.endGeometry(e)}drawMultiPolygon(t,e){const i=this.state,n=i.fillStyle,r=i.strokeStyle;if(n===void 0&&r===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([O.SET_FILL_STYLE,Vt]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([O.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);const o=t.getEndss(),a=t.getOrientedFlatCoordinates(),h=t.getStride();let c=0;for(let u=0,d=o.length;u<d;++u)c=this.drawFlatCoordinatess_(a,c,o[u],h);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(t!==0){const e=this.coordinates;for(let i=0,n=e.length;i<n;++i)e[i]=ge(e[i],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state;t.fillStyle!==void 0&&this.updateFillStyle(t,this.createFill),t.strokeStyle!==void 0&&this.updateStrokeStyle(t,this.applyStroke)}}const Jr=Hh;function $h(s,t,e,i,n){let r=e,o=e,a=0,h=0,c=e,u,d,f,g,m,_,p,x,l,y;for(d=e;d<i;d+=n){const E=t[d],C=t[d+1];m!==void 0&&(l=E-m,y=C-_,g=Math.sqrt(l*l+y*y),p!==void 0&&(h+=f,u=Math.acos((p*l+x*y)/(f*g)),u>s&&(h>a&&(a=h,r=c,o=d),h=0,c=d-n)),f=g,p=l,x=y),m=E,_=C}return h+=g,h>a?[c,d]:[r,o]}const di={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class qh extends Ai{constructor(t,e,i,n){super(t,e,i,n),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e){const i=this.textFillState_,n=this.textStrokeState_,r=this.textState_;if(this.text_===""||!r||!i&&!n)return;const o=this.coordinates;let a=o.length;const h=t.getType();let c=null,u=t.getStride();if(r.placement==="line"&&(h=="LineString"||h=="MultiLineString"||h=="Polygon"||h=="MultiPolygon")){if(!ct(this.getBufferedMaxExtent(),t.getExtent()))return;let d;if(c=t.getFlatCoordinates(),h=="LineString")d=[c.length];else if(h=="MultiLineString")d=t.getEnds();else if(h=="Polygon")d=t.getEnds().slice(0,1);else if(h=="MultiPolygon"){const _=t.getEndss();d=[];for(let p=0,x=_.length;p<x;++p)d.push(_[p][0])}this.beginGeometry(t,e);const f=r.textAlign;let g=0,m;for(let _=0,p=d.length;_<p;++_){if(f==null){const l=$h(r.maxAngle,c,g,d[_],u);g=l[0],m=l[1]}else m=d[_];for(let l=g;l<m;l+=u)o.push(c[l],c[l+1]);const x=o.length;g=d[_],this.drawChars_(a,x),a=x}this.endGeometry(e)}else{let d=r.overflow?null:[];switch(h){case"Point":case"MultiPoint":c=t.getFlatCoordinates();break;case"LineString":c=t.getFlatMidpoint();break;case"Circle":c=t.getCenter();break;case"MultiLineString":c=t.getFlatMidpoints(),u=2;break;case"Polygon":c=t.getFlatInteriorPoint(),r.overflow||d.push(c[2]/this.resolution),u=3;break;case"MultiPolygon":const p=t.getFlatInteriorPoints();c=[];for(let x=0,l=p.length;x<l;x+=3)r.overflow||d.push(p[x+2]/this.resolution),c.push(p[x],p[x+1]);if(c.length===0)return;u=2;break}const f=this.appendFlatPointCoordinates(c,u);if(f===a)return;if(d&&(f-a)/2!==c.length/u){let p=a/2;d=d.filter((x,l)=>{const y=o[(p+l)*2]===c[l*u]&&o[(p+l)*2+1]===c[l*u+1];return y||--p,y})}this.saveTextStates_(),(r.backgroundFill||r.backgroundStroke)&&(this.setFillStrokeStyle(r.backgroundFill,r.backgroundStroke),r.backgroundFill&&(this.updateFillStyle(this.state,this.createFill),this.hitDetectionInstructions.push(this.createFill(this.state))),r.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e);let g=r.padding;if(g!=Ee&&(r.scale[0]<0||r.scale[1]<0)){let p=r.padding[0],x=r.padding[1],l=r.padding[2],y=r.padding[3];r.scale[0]<0&&(x=-x,y=-y),r.scale[1]<0&&(p=-p,l=-l),g=[p,x,l,y]}const m=this.pixelRatio;this.instructions.push([O.DRAW_IMAGE,a,f,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,void 0,this.declutterImageWithText_,g==Ee?Ee:g.map(function(p){return p*m}),!!r.backgroundFill,!!r.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,d]);const _=1/m;this.hitDetectionInstructions.push([O.DRAW_IMAGE,a,f,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[_,_],NaN,void 0,this.declutterImageWithText_,g,!!r.backgroundFill,!!r.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,d]),this.endGeometry(e)}}saveTextStates_(){const t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,n=this.strokeKey_;t&&(n in this.strokeStates||(this.strokeStates[n]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const r=this.textKey_;r in this.textStates||(this.textStates[r]={font:e.font,textAlign:e.textAlign||Ci,justify:e.justify,textBaseline:e.textBaseline||dn,scale:e.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(t,e){const i=this.textStrokeState_,n=this.textState_,r=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();const h=this.pixelRatio,c=di[n.textBaseline],u=this.textOffsetY_*h,d=this.text_,f=i?i.lineWidth*Math.abs(n.scale[0])/2:0;this.instructions.push([O.DRAW_CHARS,t,e,c,n.overflow,a,n.maxAngle,h,u,r,f*h,d,o,1]),this.hitDetectionInstructions.push([O.DRAW_CHARS,t,e,c,n.overflow,a,n.maxAngle,1,u,r,f,d,o,1/h])}setTextStyle(t,e){let i,n,r;if(!t)this.text_="";else{const o=t.getFill();o?(n=this.textFillState_,n||(n={},this.textFillState_=n),n.fillStyle=At(o.getColor()||Vt)):(n=null,this.textFillState_=n);const a=t.getStroke();if(!a)r=null,this.textStrokeState_=r;else{r=this.textStrokeState_,r||(r={},this.textStrokeState_=r);const m=a.getLineDash(),_=a.getLineDashOffset(),p=a.getWidth(),x=a.getMiterLimit();r.lineCap=a.getLineCap()||un,r.lineDash=m?m.slice():yi,r.lineDashOffset=_===void 0?pi:_,r.lineJoin=a.getLineJoin()||Je,r.lineWidth=p===void 0?wi:p,r.miterLimit=x===void 0?xi:x,r.strokeStyle=At(a.getColor()||Ei)}i=this.textState_;const h=t.getFont()||ta;Eh(h);const c=t.getScaleArray();i.overflow=t.getOverflow(),i.font=h,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.justify=t.getJustify(),i.textBaseline=t.getTextBaseline()||dn,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||Ee,i.scale=c===void 0?[1,1]:c;const u=t.getOffsetX(),d=t.getOffsetY(),f=t.getRotateWithView(),g=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=u===void 0?0:u,this.textOffsetY_=d===void 0?0:d,this.textRotateWithView_=f===void 0?!1:f,this.textRotation_=g===void 0?0:g,this.strokeKey_=r?(typeof r.strokeStyle=="string"?r.strokeStyle:z(r.strokeStyle))+r.lineCap+r.lineDashOffset+"|"+r.lineWidth+r.lineJoin+r.miterLimit+"["+r.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=n?typeof n.fillStyle=="string"?n.fillStyle:"|"+z(n.fillStyle):""}this.declutterImageWithText_=e}}const Jh={Circle:Jr,Default:Ai,Image:Zh,LineString:Uh,Polygon:Jr,Text:qh};class Qh{constructor(t,e,i,n){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=n,this.resolution_=i,this.buildersByZIndex_={}}finish(){const t={};for(const e in this.buildersByZIndex_){t[e]=t[e]||{};const i=this.buildersByZIndex_[e];for(const n in i){const r=i[n].finish();t[e][n]=r}}return t}getBuilder(t,e){const i=t!==void 0?t.toString():"0";let n=this.buildersByZIndex_[i];n===void 0&&(n={},this.buildersByZIndex_[i]=n);let r=n[e];if(r===void 0){const o=Jh[e];r=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),n[e]=r}return r}}const Qr=Qh;class tc extends po{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t,this.declutterExecutorGroup=null}getFeatures(t){return b()}getData(t){return null}prepareFrame(t){return b()}renderFrame(t,e){return b()}loadedTileCallback(t,e,i){t[e]||(t[e]={}),t[e][i.tileCoord.toString()]=i}createLoadedTileFinder(t,e,i){return function(n,r){const o=this.loadedTileCallback.bind(this,i,n);return t.forEachLoadedTile(e,n,r,o)}.bind(this)}forEachFeatureAtCoordinate(t,e,i,n,r){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){t.target.getState()===Q.LOADED&&this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return e!=Q.LOADED&&e!=Q.ERROR&&t.addEventListener(k.CHANGE,this.boundHandleImageChange_),e==Q.IDLE&&(t.load(),e=t.getState()),e==Q.LOADED}renderIfReadyAndVisible(){const t=this.getLayer();t&&t.getVisible()&&t.getSourceState()==="ready"&&t.changed()}disposeInternal(){delete this.layer_,super.disposeInternal()}}const ec=tc;class ic extends kt{constructor(t,e,i,n){super(t),this.inversePixelTransform=e,this.frameState=i,this.context=n}}const la=ic,to=[];let Be=null;function nc(){const s=document.createElement("canvas");s.width=1,s.height=1,Be=s.getContext("2d")}class sc extends ec{constructor(t){super(t),this.container=null,this.renderedResolution,this.tempTransform=Ot(),this.pixelTransform=Ot(),this.inversePixelTransform=Ot(),this.context=null,this.containerReused=!1,this.pixelContext_=null,this.frameState=null}getImageData(t,e,i){Be||nc(),Be.clearRect(0,0,1,1);let n;try{Be.drawImage(t,e,i,1,1,0,0,1,1),n=Be.getImageData(0,0,1,1).data}catch{return Be=null,null}return n}getBackground(t){let i=this.getLayer().getBackground();return typeof i=="function"&&(i=i(t.viewState.resolution)),i||void 0}useContainer(t,e,i){const n=this.getLayer().getClassName();let r,o;if(t&&t.className===n&&(!i||t&&t.style.backgroundColor&&Le(hn(t.style.backgroundColor),hn(i)))){const a=t.firstElementChild;a instanceof HTMLCanvasElement&&(o=a.getContext("2d"))}if(o&&o.canvas.style.transform===e?(this.container=t,this.context=o,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){r=document.createElement("div"),r.className=n;let a=r.style;a.position="absolute",a.width="100%",a.height="100%",o=xt();const h=o.canvas;r.appendChild(h),a=h.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=r,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(t,e,i){const n=Pe(i),r=In(i),o=vn(i),a=Tn(i);it(e.coordinateToPixelTransform,n),it(e.coordinateToPixelTransform,r),it(e.coordinateToPixelTransform,o),it(e.coordinateToPixelTransform,a);const h=this.inversePixelTransform;it(h,n),it(h,r),it(h,o),it(h,a),t.save(),t.beginPath(),t.moveTo(Math.round(n[0]),Math.round(n[1])),t.lineTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.clip()}dispatchRenderEvent_(t,e,i){const n=this.getLayer();if(n.hasListener(t)){const r=new la(t,this.inversePixelTransform,i,e);n.dispatchEvent(r)}}preRender(t,e){this.frameState=e,this.dispatchRenderEvent_(le.PRERENDER,t,e)}postRender(t,e){this.dispatchRenderEvent_(le.POSTRENDER,t,e)}getRenderTransform(t,e,i,n,r,o,a){const h=r/2,c=o/2,u=n/e,d=-u,f=-t[0]+a,g=-t[1];return ce(this.tempTransform,h,c,u,d,-i,f,g)}disposeInternal(){delete this.frameState,super.disposeInternal()}}const ha=sc;function rc(s,t,e,i,n,r,o,a,h,c,u,d){let f=s[t],g=s[t+1],m=0,_=0,p=0,x=0;function l(){m=f,_=g,t+=i,f=s[t],g=s[t+1],x+=p,p=Math.sqrt((f-m)*(f-m)+(g-_)*(g-_))}do l();while(t<e-i&&x+p<r);let y=p===0?0:(r-x)/p;const E=Kt(m,f,y),C=Kt(_,g,y),w=t-i,v=x,I=r+a*h(c,n,u);for(;t<e-i&&x+p<I;)l();y=p===0?0:(I-x)/p;const S=Kt(m,f,y),A=Kt(_,g,y);let G;if(d){const M=[E,C,S,A];ko(M,0,4,2,d,M,M),G=M[0]>M[2]}else G=E>S;const N=Math.PI,D=[],U=w+i===t;t=w,p=0,x=v,f=s[t],g=s[t+1];let L;if(U){l(),L=Math.atan2(g-_,f-m),G&&(L+=L>0?-N:N);const M=(S+E)/2,T=(A+C)/2;return D[0]=[M,T,(I-r)/2,L,n],D}n=n.replace(/\n/g," ");for(let M=0,T=n.length;M<T;){l();let F=Math.atan2(g-_,f-m);if(G&&(F+=F>0?-N:N),L!==void 0){let Y=F-L;if(Y+=Y>N?-2*N:Y<-N?2*N:0,Math.abs(Y)>o)return null}L=F;const H=M;let K=0;for(;M<T;++M){const Y=G?T-M-1:M,B=a*h(c,n[Y],u);if(t+i<e&&x+p<r+K+B/2)break;K+=B}if(M===H)continue;const tt=G?n.substring(T-H,T-M):n.substring(H,M);y=p===0?0:(r+K/2-x)/p;const R=Kt(m,f,y),mt=Kt(_,g,y);D.push([R,mt,K/2,F,tt]),r+=K}return D}const We=Rt(),Jt=[],Wt=[],zt=[],Qt=[];function eo(s){return s[3].declutterBox}const oc=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function io(s,t){return(t==="start"||t==="end")&&!oc.test(s)&&(t=t==="start"?"left":"right"),di[t]}function ac(s,t,e){return e>0&&s.push(`
`,""),s.push(t,""),s}class lc{constructor(t,e,i,n){this.overlaps=i,this.pixelRatio=e,this.resolution=t,this.alignFill_,this.instructions=n.instructions,this.coordinates=n.coordinates,this.coordinateCache_={},this.renderedTransform_=Ot(),this.hitDetectionInstructions=n.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=n.fillStates||{},this.strokeStates=n.strokeStates||{},this.textStates=n.textStates||{},this.widths_={},this.labels_={}}createLabel(t,e,i,n){const r=t+e+i+n;if(this.labels_[r])return this.labels_[r];const o=n?this.strokeStates[n]:null,a=i?this.fillStates[i]:null,h=this.textStates[e],c=this.pixelRatio,u=[h.scale[0]*c,h.scale[1]*c],d=Array.isArray(t),f=h.justify?di[h.justify]:io(Array.isArray(t)?t[0]:t,h.textAlign||Ci),g=n&&o.lineWidth?o.lineWidth:0,m=d?t:t.split(`
`).reduce(ac,[]),{width:_,height:p,widths:x,heights:l,lineWidths:y}=wh(h,m),E=_+g,C=[],w=(E+2)*u[0],v=(p+g)*u[1],I={width:w<0?Math.floor(w):Math.ceil(w),height:v<0?Math.floor(v):Math.ceil(v),contextInstructions:C};(u[0]!=1||u[1]!=1)&&C.push("scale",u),n&&(C.push("strokeStyle",o.strokeStyle),C.push("lineWidth",g),C.push("lineCap",o.lineCap),C.push("lineJoin",o.lineJoin),C.push("miterLimit",o.miterLimit),C.push("setLineDash",[o.lineDash]),C.push("lineDashOffset",o.lineDashOffset)),i&&C.push("fillStyle",a.fillStyle),C.push("textBaseline","middle"),C.push("textAlign","center");const S=.5-f;let A=f*E+S*g;const G=[],N=[];let D=0,U=0,L=0,M=0,T;for(let F=0,H=m.length;F<H;F+=2){const K=m[F];if(K===`
`){U+=D,D=0,A=f*E+S*g,++M;continue}const tt=m[F+1]||h.font;tt!==T&&(n&&G.push("font",tt),i&&N.push("font",tt),T=tt),D=Math.max(D,l[L]);const R=[K,A+S*x[L]+f*(x[L]-y[M]),.5*(g+D)+U];A+=x[L],n&&G.push("strokeText",R),i&&N.push("fillText",R),++L}return Array.prototype.push.apply(C,G),Array.prototype.push.apply(C,N),this.labels_[r]=I,I}replayTextBackground_(t,e,i,n,r,o,a){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,n),t.lineTo.apply(t,r),t.lineTo.apply(t,e),o&&(this.alignFill_=o[2],this.fill_(t)),a&&(this.setStrokeStyle_(t,a),t.stroke())}calculateImageOrLabelDimensions_(t,e,i,n,r,o,a,h,c,u,d,f,g,m,_,p){a*=f[0],h*=f[1];let x=i-a,l=n-h;const y=r+c>t?t-c:r,E=o+u>e?e-u:o,C=m[3]+y*f[0]+m[1],w=m[0]+E*f[1]+m[2],v=x-m[3],I=l-m[0];(_||d!==0)&&(Jt[0]=v,Qt[0]=v,Jt[1]=I,Wt[1]=I,Wt[0]=v+C,zt[0]=Wt[0],zt[1]=I+w,Qt[1]=zt[1]);let S;return d!==0?(S=ce(Ot(),i,n,1,1,d,-i,-n),it(S,Jt),it(S,Wt),it(S,zt),it(S,Qt),bt(Math.min(Jt[0],Wt[0],zt[0],Qt[0]),Math.min(Jt[1],Wt[1],zt[1],Qt[1]),Math.max(Jt[0],Wt[0],zt[0],Qt[0]),Math.max(Jt[1],Wt[1],zt[1],Qt[1]),We)):bt(Math.min(v,v+C),Math.min(I,I+w),Math.max(v,v+C),Math.max(I,I+w),We),g&&(x=Math.round(x),l=Math.round(l)),{drawImageX:x,drawImageY:l,drawImageW:y,drawImageH:E,originX:c,originY:u,declutterBox:{minX:We[0],minY:We[1],maxX:We[2],maxY:We[3],value:p},canvasTransform:S,scale:f}}replayImageOrLabel_(t,e,i,n,r,o,a){const h=!!(o||a),c=n.declutterBox,u=t.canvas,d=a?a[2]*n.scale[0]/2:0;return c.minX-d<=u.width/e&&c.maxX+d>=0&&c.minY-d<=u.height/e&&c.maxY+d>=0&&(h&&this.replayTextBackground_(t,Jt,Wt,zt,Qt,o,a),Rh(t,n.canvasTransform,r,i,n.originX,n.originY,n.drawImageW,n.drawImageH,n.drawImageX,n.drawImageY,n.scale)),!0}fill_(t){if(this.alignFill_){const e=it(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;t.save(),t.translate(e[0]%i,e[1]%i),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.restore()}setStrokeStyle_(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6])}drawLabelWithPointPlacement_(t,e,i,n){const r=this.textStates[e],o=this.createLabel(t,e,n,i),a=this.strokeStates[i],h=this.pixelRatio,c=io(Array.isArray(t)?t[0]:t,r.textAlign||Ci),u=di[r.textBaseline||dn],d=a&&a.lineWidth?a.lineWidth:0,f=o.width/h-2*r.scale[0],g=c*f+2*(.5-c)*d,m=u*o.height/h+2*(.5-u)*d;return{label:o,anchorX:g,anchorY:m}}execute_(t,e,i,n,r,o,a,h){let c;this.pixelCoordinates_&&Le(i,this.renderedTransform_)?c=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),c=Re(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),cl(this.renderedTransform_,i));let u=0;const d=n.length;let f=0,g,m,_,p,x,l,y,E,C,w,v,I,S=0,A=0,G=null,N=null;const D=this.coordinateCache_,U=this.viewRotation_,L=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,M={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:U},T=this.instructions!=n||this.overlaps?0:200;let F,H,K,tt;for(;u<d;){const R=n[u];switch(R[0]){case O.BEGIN_GEOMETRY:F=R[1],tt=R[3],F.getGeometry()?a!==void 0&&!ct(a,tt.getExtent())?u=R[2]+1:++u:u=R[2];break;case O.BEGIN_PATH:S>T&&(this.fill_(t),S=0),A>T&&(t.stroke(),A=0),!S&&!A&&(t.beginPath(),p=NaN,x=NaN),++u;break;case O.CIRCLE:f=R[1];const Y=c[f],B=c[f+1],Ut=c[f+2],Mt=c[f+3],nt=Ut-Y,Dt=Mt-B,Oe=Math.sqrt(nt*nt+Dt*Dt);t.moveTo(Y+Oe,B),t.arc(Y,B,Oe,0,2*Math.PI,!0),++u;break;case O.CLOSE_PATH:t.closePath(),++u;break;case O.CUSTOM:f=R[1],g=R[2];const bi=R[3],be=R[4],Fi=R.length==6?R[5]:void 0;M.geometry=bi,M.feature=F,u in D||(D[u]=[]);const Ht=D[u];Fi?Fi(c,f,g,2,Ht):(Ht[0]=c[f],Ht[1]=c[f+1],Ht.length=2),be(Ht,M),++u;break;case O.DRAW_IMAGE:f=R[1],g=R[2],E=R[3],m=R[4],_=R[5];let ii=R[6];const $t=R[7],ki=R[8],Di=R[9],Ni=R[10];let Fe=R[11];const zn=R[12];let dt=R[13];const Et=R[14],Tt=R[15];if(!E&&R.length>=20){C=R[19],w=R[20],v=R[21],I=R[22];const _t=this.drawLabelWithPointPlacement_(C,w,v,I);E=_t.label,R[3]=E;const Ne=R[23];m=(_t.anchorX-Ne)*this.pixelRatio,R[4]=m;const Ct=R[24];_=(_t.anchorY-Ct)*this.pixelRatio,R[5]=_,ii=E.height,R[6]=ii,dt=E.width,R[13]=dt}let Nt;R.length>25&&(Nt=R[25]);let ke,ue,qt;R.length>17?(ke=R[16],ue=R[17],qt=R[18]):(ke=Ee,ue=!1,qt=!1),Ni&&L?Fe+=U:!Ni&&!L&&(Fe-=U);let De=0;for(;f<g;f+=2){if(Nt&&Nt[De++]<dt/this.pixelRatio)continue;const _t=this.calculateImageOrLabelDimensions_(E.width,E.height,c[f],c[f+1],dt,ii,m,_,ki,Di,Fe,zn,r,ke,ue||qt,F),Ne=[t,e,E,_t,$t,ue?G:null,qt?N:null];if(h){if(Et==="none")continue;if(Et==="obstacle"){h.insert(_t.declutterBox);continue}else{let Ct,Gt;if(Tt){const yt=g-f;if(!Tt[yt]){Tt[yt]=Ne;continue}if(Ct=Tt[yt],delete Tt[yt],Gt=eo(Ct),h.collides(Gt))continue}if(h.collides(_t.declutterBox))continue;Ct&&(h.insert(Gt),this.replayImageOrLabel_.apply(this,Ct)),h.insert(_t.declutterBox)}}this.replayImageOrLabel_.apply(this,Ne)}++u;break;case O.DRAW_CHARS:const Gi=R[1],at=R[2],Yn=R[3],za=R[4];I=R[5];const Ya=R[6],xr=R[7],Er=R[8];v=R[9];const jn=R[10];C=R[11],w=R[12];const Cr=[R[13],R[13]],Bn=this.textStates[w],ni=Bn.font,si=[Bn.scale[0]*xr,Bn.scale[1]*xr];let ri;ni in this.widths_?ri=this.widths_[ni]:(ri={},this.widths_[ni]=ri);const wr=Vo(c,Gi,at,2),Rr=Math.abs(si[0])*Kr(ni,C,ri);if(za||Rr<=wr){const _t=this.textStates[w].textAlign,Ne=(wr-Rr)*di[_t],Ct=rc(c,Gi,at,2,C,Ne,Ya,Math.abs(si[0]),Kr,ni,ri,L?0:this.viewRotation_);t:if(Ct){const Gt=[];let yt,Xi,Wi,ft,wt;if(v)for(yt=0,Xi=Ct.length;yt<Xi;++yt){wt=Ct[yt],Wi=wt[4],ft=this.createLabel(Wi,w,"",v),m=wt[2]+(si[0]<0?-jn:jn),_=Yn*ft.height+(.5-Yn)*2*jn*si[1]/si[0]-Er;const Xt=this.calculateImageOrLabelDimensions_(ft.width,ft.height,wt[0],wt[1],ft.width,ft.height,m,_,0,0,wt[3],Cr,!1,Ee,!1,F);if(h&&h.collides(Xt.declutterBox))break t;Gt.push([t,e,ft,Xt,1,null,null])}if(I)for(yt=0,Xi=Ct.length;yt<Xi;++yt){wt=Ct[yt],Wi=wt[4],ft=this.createLabel(Wi,w,I,""),m=wt[2],_=Yn*ft.height-Er;const Xt=this.calculateImageOrLabelDimensions_(ft.width,ft.height,wt[0],wt[1],ft.width,ft.height,m,_,0,0,wt[3],Cr,!1,Ee,!1,F);if(h&&h.collides(Xt.declutterBox))break t;Gt.push([t,e,ft,Xt,1,null,null])}h&&h.load(Gt.map(eo));for(let Xt=0,ja=Gt.length;Xt<ja;++Xt)this.replayImageOrLabel_.apply(this,Gt[Xt])}}++u;break;case O.END_GEOMETRY:if(o!==void 0){F=R[1];const _t=o(F,tt);if(_t)return _t}++u;break;case O.FILL:T?S++:this.fill_(t),++u;break;case O.MOVE_TO_LINE_TO:for(f=R[1],g=R[2],H=c[f],K=c[f+1],l=H+.5|0,y=K+.5|0,(l!==p||y!==x)&&(t.moveTo(H,K),p=l,x=y),f+=2;f<g;f+=2)H=c[f],K=c[f+1],l=H+.5|0,y=K+.5|0,(f==g-2||l!==p||y!==x)&&(t.lineTo(H,K),p=l,x=y);++u;break;case O.SET_FILL_STYLE:G=R,this.alignFill_=R[2],S&&(this.fill_(t),S=0,A&&(t.stroke(),A=0)),t.fillStyle=R[1],++u;break;case O.SET_STROKE_STYLE:N=R,A&&(t.stroke(),A=0),this.setStrokeStyle_(t,R),++u;break;case O.STROKE:T?A++:t.stroke(),++u;break;default:++u;break}}S&&this.fill_(t),A&&t.stroke()}execute(t,e,i,n,r,o){this.viewRotation_=n,this.execute_(t,e,i,this.instructions,r,void 0,void 0,o)}executeHitDetection(t,e,i,n,r){return this.viewRotation_=i,this.execute_(t,1,e,this.hitDetectionInstructions,!0,n,r)}}const hc=lc,Un=["Polygon","Circle","LineString","Image","Text","Default"];class cc{constructor(t,e,i,n,r,o){this.maxExtent_=t,this.overlaps_=n,this.pixelRatio_=i,this.resolution_=e,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Ot(),this.createExecutors_(r)}clip(t,e){const i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()}createExecutors_(t){for(const e in t){let i=this.executorsByZIndex_[e];i===void 0&&(i={},this.executorsByZIndex_[e]=i);const n=t[e];for(const r in n){const o=n[r];i[r]=new hc(this.resolution_,this.pixelRatio_,this.overlaps_,o)}}}hasExecutors(t){for(const e in this.executorsByZIndex_){const i=this.executorsByZIndex_[e];for(let n=0,r=t.length;n<r;++n)if(t[n]in i)return!0}return!1}forEachFeatureAtCoordinate(t,e,i,n,r,o){n=Math.round(n);const a=n*2+1,h=ce(this.hitDetectionTransform_,n+.5,n+.5,1/e,-1/e,-i,-t[0],-t[1]),c=!this.hitDetectionContext_;c&&(this.hitDetectionContext_=xt(a,a));const u=this.hitDetectionContext_;u.canvas.width!==a||u.canvas.height!==a?(u.canvas.width=a,u.canvas.height=a):c||u.clearRect(0,0,a,a);let d;this.renderBuffer_!==void 0&&(d=Rt(),ci(d,t),ks(d,e*(this.renderBuffer_+n),d));const f=uc(n);let g;function m(C,w){const v=u.getImageData(0,0,a,a).data;for(let I=0,S=f.length;I<S;I++)if(v[f[I]]>0){if(!o||g!=="Image"&&g!=="Text"||o.includes(C)){const A=(f[I]-3)/4,G=n-A%a,N=n-(A/a|0),D=r(C,w,G*G+N*N);if(D)return D}u.clearRect(0,0,a,a);break}}const _=Object.keys(this.executorsByZIndex_).map(Number);_.sort(Te);let p,x,l,y,E;for(p=_.length-1;p>=0;--p){const C=_[p].toString();for(l=this.executorsByZIndex_[C],x=Un.length-1;x>=0;--x)if(g=Un[x],y=l[g],y!==void 0&&(E=y.executeHitDetection(u,h,i,m,d),E))return E}}getClipCoords(t){const e=this.maxExtent_;if(!e)return null;const i=e[0],n=e[1],r=e[2],o=e[3],a=[i,n,i,o,r,o,r,n];return Re(a,0,8,2,t,a),a}isEmpty(){return $e(this.executorsByZIndex_)}execute(t,e,i,n,r,o,a){const h=Object.keys(this.executorsByZIndex_).map(Number);h.sort(Te),this.maxExtent_&&(t.save(),this.clip(t,i)),o=o||Un;let c,u,d,f,g,m;for(a&&h.reverse(),c=0,u=h.length;c<u;++c){const _=h[c].toString();for(g=this.executorsByZIndex_[_],d=0,f=o.length;d<f;++d){const p=o[d];m=g[p],m!==void 0&&m.execute(t,e,i,n,r,a)}}this.maxExtent_&&t.restore()}}const Hn={};function uc(s){if(Hn[s]!==void 0)return Hn[s];const t=s*2+1,e=s*s,i=new Array(e+1);for(let r=0;r<=s;++r)for(let o=0;o<=s;++o){const a=r*r+o*o;if(a>e)break;let h=i[a];h||(h=[],i[a]=h),h.push(((s+r)*t+(s+o))*4+3),r>0&&h.push(((s-r)*t+(s+o))*4+3),o>0&&(h.push(((s+r)*t+(s-o))*4+3),r>0&&h.push(((s-r)*t+(s-o))*4+3))}const n=[];for(let r=0,o=i.length;r<o;++r)i[r]&&n.push(...i[r]);return Hn[s]=n,n}const no=cc,ot={ANIMATING:0,INTERACTING:1};class dc extends aa{constructor(t,e,i,n,r,o,a){super(),this.context_=t,this.pixelRatio_=e,this.extent_=i,this.transform_=n,this.viewRotation_=r,this.squaredTolerance_=o,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Ot()}drawImages_(t,e,i,n){if(!this.image_)return;const r=Re(t,e,i,n,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,h=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=h*this.imageOpacity_);let c=this.imageRotation_;this.imageRotateWithView_&&(c+=this.viewRotation_);for(let u=0,d=r.length;u<d;u+=2){const f=r[u]-this.imageAnchorX_,g=r[u+1]-this.imageAnchorY_;if(c!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const m=f+this.imageAnchorX_,_=g+this.imageAnchorY_;ce(a,m,_,1,1,c,-m,-_),o.setTransform.apply(o,a),o.translate(m,_),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.setTransform(1,0,0,1,0,0)}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,f,g,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=h)}drawText_(t,e,i,n){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const r=Re(t,e,i,n,this.transform_,this.pixelCoordinates_),o=this.context_;let a=this.textRotation_;for(this.textRotateWithView_&&(a+=this.viewRotation_);e<i;e+=n){const h=r[e]+this.textOffsetX_,c=r[e+1]+this.textOffsetY_;a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.translate(h-this.textOffsetX_,c-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.setTransform(1,0,0,1,0,0)):(this.textStrokeState_&&o.strokeText(this.text_,h,c),this.textFillState_&&o.fillText(this.text_,h,c))}}moveToLineTo_(t,e,i,n,r){const o=this.context_,a=Re(t,e,i,n,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);let h=a.length;r&&(h-=2);for(let c=2;c<h;c+=2)o.lineTo(a[c],a[c+1]);return r&&o.closePath(),i}drawRings_(t,e,i,n){for(let r=0,o=i.length;r<o;++r)e=this.moveToLineTo_(t,e,i[r],n,!0);return e}drawCircle(t){if(ct(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=Zl(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],n=e[3]-e[1],r=Math.sqrt(i*i+n*n),o=this.context_;o.beginPath(),o.arc(e[0],e[1],r,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t);break}}drawFeature(t,e){const i=e.getGeometryFunction()(t);!i||!ct(this.extent_,i.getExtent())||(this.setStyle(e),this.drawGeometry(i))}drawGeometryCollection(t){const e=t.getGeometriesArray();for(let i=0,n=e.length;i<n;++i)this.drawGeometry(e[i])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),this.text_!==""&&this.drawText_(e,0,e.length,i)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),this.text_!==""&&this.drawText_(e,0,e.length,i)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ct(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(this.text_!==""){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getExtent();if(ct(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,n=t.getFlatCoordinates();let r=0;const o=t.getEnds(),a=t.getStride();i.beginPath();for(let h=0,c=o.length;h<c;++h)r=this.moveToLineTo_(n,r,o[h],a,!1);i.stroke()}if(this.text_!==""){const i=t.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ct(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ct(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getOrientedFlatCoordinates();let n=0;const r=t.getEndss(),o=t.getStride();e.beginPath();for(let a=0,h=r.length;a<h;++a){const c=r[a];n=this.drawRings_(i,n,c,o)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}}setContextFillState_(t){const e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,e.lineCap=t.lineCap),Le(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const e=this.context_,i=this.contextTextState_,n=t.textAlign?t.textAlign:Ci;i?(i.font!=t.font&&(i.font=t.font,e.font=t.font),i.textAlign!=n&&(i.textAlign=n,e.textAlign=n),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=n,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:n,textBaseline:t.textBaseline})}setFillStrokeStyle(t,e){if(!t)this.fillState_=null;else{const i=t.getColor();this.fillState_={fillStyle:At(i||Vt)}}if(!e)this.strokeState_=null;else{const i=e.getColor(),n=e.getLineCap(),r=e.getLineDash(),o=e.getLineDashOffset(),a=e.getLineJoin(),h=e.getWidth(),c=e.getMiterLimit(),u=r||yi;this.strokeState_={lineCap:n!==void 0?n:un,lineDash:this.pixelRatio_===1?u:u.map(d=>d*this.pixelRatio_),lineDashOffset:(o||pi)*this.pixelRatio_,lineJoin:a!==void 0?a:Je,lineWidth:(h!==void 0?h:wi)*this.pixelRatio_,miterLimit:c!==void 0?c:xi,strokeStyle:At(i||Ei)}}}setImageStyle(t){let e;if(!t||!(e=t.getSize())){this.image_=null;return}const i=t.getPixelRatio(this.pixelRatio_),n=t.getAnchor(),r=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=n[0]*i,this.imageAnchorY_=n[1]*i,this.imageHeight_=e[1]*i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=r[0],this.imageOriginY_=r[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const o=t.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=e[0]*i}setTextStyle(t){if(!t)this.text_="";else{const e=t.getFill();if(!e)this.textFillState_=null;else{const g=e.getColor();this.textFillState_={fillStyle:At(g||Vt)}}const i=t.getStroke();if(!i)this.textStrokeState_=null;else{const g=i.getColor(),m=i.getLineCap(),_=i.getLineDash(),p=i.getLineDashOffset(),x=i.getLineJoin(),l=i.getWidth(),y=i.getMiterLimit();this.textStrokeState_={lineCap:m!==void 0?m:un,lineDash:_||yi,lineDashOffset:p||pi,lineJoin:x!==void 0?x:Je,lineWidth:l!==void 0?l:wi,miterLimit:y!==void 0?y:xi,strokeStyle:At(g||Ei)}}const n=t.getFont(),r=t.getOffsetX(),o=t.getOffsetY(),a=t.getRotateWithView(),h=t.getRotation(),c=t.getScaleArray(),u=t.getText(),d=t.getTextAlign(),f=t.getTextBaseline();this.textState_={font:n!==void 0?n:ta,textAlign:d!==void 0?d:Ci,textBaseline:f!==void 0?f:dn},this.text_=u!==void 0?Array.isArray(u)?u.reduce((g,m,_)=>g+=_%2?" ":m,""):u:"",this.textOffsetX_=r!==void 0?this.pixelRatio_*r:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=a!==void 0?a:!1,this.textRotation_=h!==void 0?h:0,this.textScale_=[this.pixelRatio_*c[0],this.pixelRatio_*c[1]]}}}const fc=dc,Pt=.5;function gc(s,t,e,i,n,r,o){const a=s[0]*Pt,h=s[1]*Pt,c=xt(a,h);c.imageSmoothingEnabled=!1;const u=c.canvas,d=new fc(c,Pt,n,null,o),f=e.length,g=Math.floor((256*256*256-1)/f),m={};for(let p=1;p<=f;++p){const x=e[p-1],l=x.getStyleFunction()||i;if(!i)continue;let y=l(x,r);if(!y)continue;Array.isArray(y)||(y=[y]);const C="#"+("000000"+(p*g).toString(16)).slice(-6);for(let w=0,v=y.length;w<v;++w){const I=y[w],S=I.getGeometryFunction()(x);if(!S||!ct(n,S.getExtent()))continue;const A=I.clone(),G=A.getFill();G&&G.setColor(C);const N=A.getStroke();N&&(N.setColor(C),N.setLineDash(null)),A.setText(void 0);const D=I.getImage();if(D&&D.getOpacity()!==0){const M=D.getImageSize();if(!M)continue;const T=xt(M[0],M[1],void 0,{alpha:!1}),F=T.canvas;T.fillStyle=C,T.fillRect(0,0,F.width,F.height),A.setImage(new rr({img:F,imgSize:M,anchor:D.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:D.getOrigin(),opacity:1,size:D.getSize(),scale:D.getScale(),rotation:D.getRotation(),rotateWithView:D.getRotateWithView()}))}const U=A.getZIndex()||0;let L=m[U];L||(L={},m[U]=L,L.Polygon=[],L.Circle=[],L.LineString=[],L.Point=[]),L[S.getType().replace("Multi","")].push(S,A)}}const _=Object.keys(m).map(Number).sort(Te);for(let p=0,x=_.length;p<x;++p){const l=m[_[p]];for(const y in l){const E=l[y];for(let C=0,w=E.length;C<w;C+=2){d.setStyle(E[C+1]);for(let v=0,I=t.length;v<I;++v)d.setTransform(t[v]),d.drawGeometry(E[C])}}}return c.getImageData(0,0,u.width,u.height)}function mc(s,t,e){const i=[];if(e){const n=Math.floor(Math.round(s[0])*Pt),r=Math.floor(Math.round(s[1])*Pt),o=(J(n,0,e.width-1)+J(r,0,e.height-1)*e.width)*4,a=e.data[o],h=e.data[o+1],u=e.data[o+2]+256*(h+256*a),d=Math.floor((256*256*256-1)/t.length);u&&u%d===0&&i.push(t[u/d-1])}return i}const _c=.5,ca={Point:vc,LineString:wc,Polygon:Sc,MultiPoint:Ic,MultiLineString:Rc,MultiPolygon:Tc,GeometryCollection:Cc,Circle:xc};function yc(s,t){return parseInt(z(s),10)-parseInt(z(t),10)}function pc(s,t){const e=xs(s,t);return e*e}function xs(s,t){return _c*s/t}function xc(s,t,e,i,n){const r=e.getFill(),o=e.getStroke();if(r||o){const h=s.getBuilder(e.getZIndex(),"Circle");h.setFillStrokeStyle(r,o),h.drawCircle(t,i)}const a=e.getText();if(a&&a.getText()){const h=(n||s).getBuilder(e.getZIndex(),"Text");h.setTextStyle(a),h.drawText(t,i)}}function so(s,t,e,i,n,r,o){let a=!1;const h=e.getImage();if(h){const c=h.getImageState();c==Q.LOADED||c==Q.ERROR?h.unlistenImageChange(n):(c==Q.IDLE&&h.load(),h.listenImageChange(n),a=!0)}return Ec(s,t,e,i,r,o),a}function Ec(s,t,e,i,n,r){const o=e.getGeometryFunction()(t);if(!o)return;const a=o.simplifyTransformed(i,n);if(e.getRenderer())ua(s,a,e,t);else{const c=ca[a.getType()];c(s,a,e,t,r)}}function ua(s,t,e,i){if(t.getType()=="GeometryCollection"){const r=t.getGeometries();for(let o=0,a=r.length;o<a;++o)ua(s,r[o],e,i);return}s.getBuilder(e.getZIndex(),"Default").drawCustom(t,i,e.getRenderer(),e.getHitDetectionRenderer())}function Cc(s,t,e,i,n){const r=t.getGeometriesArray();let o,a;for(o=0,a=r.length;o<a;++o){const h=ca[r[o].getType()];h(s,r[o],e,i,n)}}function wc(s,t,e,i,n){const r=e.getStroke();if(r){const a=s.getBuilder(e.getZIndex(),"LineString");a.setFillStrokeStyle(null,r),a.drawLineString(t,i)}const o=e.getText();if(o&&o.getText()){const a=(n||s).getBuilder(e.getZIndex(),"Text");a.setTextStyle(o),a.drawText(t,i)}}function Rc(s,t,e,i,n){const r=e.getStroke();if(r){const a=s.getBuilder(e.getZIndex(),"LineString");a.setFillStrokeStyle(null,r),a.drawMultiLineString(t,i)}const o=e.getText();if(o&&o.getText()){const a=(n||s).getBuilder(e.getZIndex(),"Text");a.setTextStyle(o),a.drawText(t,i)}}function Tc(s,t,e,i,n){const r=e.getFill(),o=e.getStroke();if(o||r){const h=s.getBuilder(e.getZIndex(),"Polygon");h.setFillStrokeStyle(r,o),h.drawMultiPolygon(t,i)}const a=e.getText();if(a&&a.getText()){const h=(n||s).getBuilder(e.getZIndex(),"Text");h.setTextStyle(a),h.drawText(t,i)}}function vc(s,t,e,i,n){const r=e.getImage(),o=e.getText();let a;if(r){if(r.getImageState()!=Q.LOADED)return;let h=s;if(n){const u=r.getDeclutterMode();if(u!=="none")if(h=n,u==="obstacle"){const d=s.getBuilder(e.getZIndex(),"Image");d.setImageStyle(r,a),d.drawPoint(t,i)}else o&&o.getText()&&(a={})}const c=h.getBuilder(e.getZIndex(),"Image");c.setImageStyle(r,a),c.drawPoint(t,i)}if(o&&o.getText()){let h=s;n&&(h=n);const c=h.getBuilder(e.getZIndex(),"Text");c.setTextStyle(o,a),c.drawText(t,i)}}function Ic(s,t,e,i,n){const r=e.getImage(),o=e.getText();let a;if(r){if(r.getImageState()!=Q.LOADED)return;let h=s;if(n){const u=r.getDeclutterMode();if(u!=="none")if(h=n,u==="obstacle"){const d=s.getBuilder(e.getZIndex(),"Image");d.setImageStyle(r,a),d.drawMultiPoint(t,i)}else o&&o.getText()&&(a={})}const c=h.getBuilder(e.getZIndex(),"Image");c.setImageStyle(r,a),c.drawMultiPoint(t,i)}if(o&&o.getText()){let h=s;n&&(h=n);const c=h.getBuilder(e.getZIndex(),"Text");c.setTextStyle(o,a),c.drawText(t,i)}}function Sc(s,t,e,i,n){const r=e.getFill(),o=e.getStroke();if(r||o){const h=s.getBuilder(e.getZIndex(),"Polygon");h.setFillStrokeStyle(r,o),h.drawPolygon(t,i)}const a=e.getText();if(a&&a.getText()){const h=(n||s).getBuilder(e.getZIndex(),"Text");h.setTextStyle(a),h.drawText(t,i)}}class Lc extends ha{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=Rt(),this.wrappedRenderedExtent_=Rt(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedRenderOrder_=null,this.replayGroup_=null,this.replayGroupChanged=!0,this.declutterExecutorGroup=null,this.clipping=!0,this.compositionContext_=null,this.opacity_=1}renderWorlds(t,e,i){const n=e.extent,r=e.viewState,o=r.center,a=r.resolution,h=r.projection,c=r.rotation,u=h.getExtent(),d=this.getLayer().getSource(),f=e.pixelRatio,g=e.viewHints,m=!(g[ot.ANIMATING]||g[ot.INTERACTING]),_=this.compositionContext_,p=Math.round(e.size[0]*f),x=Math.round(e.size[1]*f),l=d.getWrapX()&&h.canWrapX(),y=l?V(u):null,E=l?Math.ceil((n[2]-u[2])/y)+1:1;let C=l?Math.floor((n[0]-u[0])/y):0;do{const w=this.getRenderTransform(o,a,c,f,p,x,C*y);t.execute(_,1,w,c,m,void 0,i)}while(++C<E)}setupCompositionContext_(){if(this.opacity_!==1){const t=xt(this.context.canvas.width,this.context.canvas.height,to);this.compositionContext_=t}else this.compositionContext_=this.context}releaseCompositionContext_(){if(this.opacity_!==1){const t=this.context.globalAlpha;this.context.globalAlpha=this.opacity_,this.context.drawImage(this.compositionContext_.canvas,0,0),this.context.globalAlpha=t,qo(this.compositionContext_),to.push(this.compositionContext_.canvas),this.compositionContext_=null}}renderDeclutter(t){this.declutterExecutorGroup&&(this.setupCompositionContext_(),this.renderWorlds(this.declutterExecutorGroup,t,t.declutterTree),this.releaseCompositionContext_())}renderFrame(t,e){const i=t.pixelRatio,n=t.layerStatesArray[t.layerIndex];ul(this.pixelTransform,1/i,1/i),Fs(this.inversePixelTransform,this.pixelTransform);const r=Co(this.pixelTransform);this.useContainer(e,r,this.getBackground(t));const o=this.context,a=o.canvas,h=this.replayGroup_,c=this.declutterExecutorGroup;if((!h||h.isEmpty())&&(!c||c.isEmpty()))return null;const u=Math.round(t.size[0]*i),d=Math.round(t.size[1]*i);a.width!=u||a.height!=d?(a.width=u,a.height=d,a.style.transform!==r&&(a.style.transform=r)):this.containerReused||o.clearRect(0,0,u,d),this.preRender(o,t);const f=t.viewState;f.projection,this.opacity_=n.opacity,this.setupCompositionContext_();let g=!1,m=!0;if(n.extent&&this.clipping){const _=pe(n.extent);m=ct(_,t.extent),g=m&&!ye(_,t.extent),g&&this.clipUnrotated(this.compositionContext_,t,_)}return m&&this.renderWorlds(h,t),g&&this.compositionContext_.restore(),this.releaseCompositionContext_(),this.postRender(o,t),this.renderedRotation_!==f.rotation&&(this.renderedRotation_=f.rotation,this.hitDetectionImageData_=null),this.container}getFeatures(t){return new Promise(function(e){if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=[this.context.canvas.width,this.context.canvas.height];it(this.pixelTransform,i);const n=this.renderedCenter_,r=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,h=this.wrappedRenderedExtent_,c=this.getLayer(),u=[],d=i[0]*Pt,f=i[1]*Pt;u.push(this.getRenderTransform(n,r,o,Pt,d,f,0).slice());const g=c.getSource(),m=a.getExtent();if(g.getWrapX()&&a.canWrapX()&&!ye(m,h)){let _=h[0];const p=V(m);let x=0,l;for(;_<m[0];)--x,l=p*x,u.push(this.getRenderTransform(n,r,o,Pt,d,f,l).slice()),_+=p;for(x=0,_=h[2];_>m[2];)++x,l=p*x,u.push(this.getRenderTransform(n,r,o,Pt,d,f,l).slice()),_-=p}this.hitDetectionImageData_=gc(i,u,this.renderedFeatures_,c.getStyleFunction(),h,r,o)}e(mc(t,this.renderedFeatures_,this.hitDetectionImageData_))}.bind(this))}forEachFeatureAtCoordinate(t,e,i,n,r){if(!this.replayGroup_)return;const o=e.viewState.resolution,a=e.viewState.rotation,h=this.getLayer(),c={},u=function(g,m,_){const p=z(g),x=c[p];if(x){if(x!==!0&&_<x.distanceSq){if(_===0)return c[p]=!0,r.splice(r.lastIndexOf(x),1),n(g,h,m);x.geometry=m,x.distanceSq=_}}else{if(_===0)return c[p]=!0,n(g,h,m);r.push(c[p]={feature:g,layer:h,geometry:m,distanceSq:_,callback:n})}};let d;const f=[this.replayGroup_];return this.declutterExecutorGroup&&f.push(this.declutterExecutorGroup),f.some(g=>d=g.forEachFeatureAtCoordinate(t,o,a,i,u,g===this.declutterExecutorGroup&&e.declutterTree?e.declutterTree.all().map(m=>m.value):null)),d}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}prepareFrame(t){const e=this.getLayer(),i=e.getSource();if(!i)return!1;const n=t.viewHints[ot.ANIMATING],r=t.viewHints[ot.INTERACTING],o=e.getUpdateWhileAnimating(),a=e.getUpdateWhileInteracting();if(this.ready&&!o&&n||!a&&r)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const h=t.extent,c=t.viewState,u=c.projection,d=c.resolution,f=t.pixelRatio,g=e.getRevision(),m=e.getRenderBuffer();let _=e.getRenderOrder();_===void 0&&(_=yc);const p=c.center.slice(),x=ks(h,m*d),l=x.slice(),y=[x.slice()],E=u.getExtent();if(i.getWrapX()&&u.canWrapX()&&!ye(E,t.extent)){const L=V(E),M=Math.max(V(x)/2,L);x[0]=E[0]-M,x[2]=E[2]+M,Po(p,u);const T=So(y[0],u);T[0]<E[0]&&T[2]<E[2]?y.push([T[0]+L,T[1],T[2]+L,T[3]]):T[0]>E[0]&&T[2]>E[2]&&y.push([T[0]-L,T[1],T[2]-L,T[3]])}if(this.ready&&this.renderedResolution_==d&&this.renderedRevision_==g&&this.renderedRenderOrder_==_&&ye(this.wrappedRenderedExtent_,x))return Le(this.renderedExtent_,l)||(this.hitDetectionImageData_=null,this.renderedExtent_=l),this.renderedCenter_=p,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const C=new Qr(xs(d,f),x,d,f);let w;this.getLayer().getDeclutter()&&(w=new Qr(xs(d,f),x,d,f));let v;for(let L=0,M=y.length;L<M;++L)i.loadFeatures(y[L],d,u);const I=pc(d,f);let S=!0;const A=function(L){let M;const T=L.getStyleFunction()||e.getStyleFunction();if(T&&(M=T(L,d)),M){const F=this.renderFeature(L,I,M,C,v,w);S=S&&!F}}.bind(this),G=Fo(x),N=i.getFeaturesInExtent(G);_&&N.sort(_);for(let L=0,M=N.length;L<M;++L)A(N[L]);this.renderedFeatures_=N,this.ready=S;const D=C.finish(),U=new no(x,d,f,i.getOverlaps(),D,e.getRenderBuffer());return w&&(this.declutterExecutorGroup=new no(x,d,f,i.getOverlaps(),w.finish(),e.getRenderBuffer())),this.renderedResolution_=d,this.renderedRevision_=g,this.renderedRenderOrder_=_,this.renderedExtent_=l,this.wrappedRenderedExtent_=x,this.renderedCenter_=p,this.renderedProjection_=u,this.replayGroup_=U,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(t,e,i,n,r,o){if(!i)return!1;let a=!1;if(Array.isArray(i))for(let h=0,c=i.length;h<c;++h)a=so(n,t,i[h],e,this.boundHandleStyleImageChange_,r,o)||a;else a=so(n,t,i,e,this.boundHandleStyleImageChange_,r,o);return a}}const Mc=Lc;class Pc extends Yh{constructor(t){super(t)}createRenderer(){return new Mc(this)}}const bn=Pc;class Ac{constructor(t){this.rbush_=new ra(t),this.items_={}}insert(t,e){const i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[z(e)]=i}load(t,e){const i=new Array(e.length);for(let n=0,r=e.length;n<r;n++){const o=t[n],a=e[n],h={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};i[n]=h,this.items_[z(a)]=h}this.rbush_.load(i)}remove(t){const e=z(t),i=this.items_[e];return delete this.items_[e],this.rbush_.remove(i)!==null}update(t,e){const i=this.items_[z(e)],n=[i.minX,i.minY,i.maxX,i.maxY];fi(n,t)||(this.remove(e),this.insert(t,e))}getAll(){return this.rbush_.all().map(function(e){return e.value})}getInExtent(t){const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map(function(n){return n.value})}forEach(t){return this.forEach_(this.getAll(),t)}forEachInExtent(t,e){return this.forEach_(this.getInExtent(t),e)}forEach_(t,e){let i;for(let n=0,r=t.length;n<r;n++)if(i=e(t[n]),i)return i;return i}isEmpty(){return $e(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(t){const e=this.rbush_.toJSON();return bt(e.minX,e.minY,e.maxX,e.maxY,t)}concat(t){this.rbush_.load(t.rbush_.all());for(const e in t.items_)this.items_[e]=t.items_[e]}}const ro=Ac;class Oc extends Lt{constructor(t){super(),this.projection=q(t.projection),this.attributions_=oo(t.attributions),this.attributionsCollapsible_=t.attributionsCollapsible!==void 0?t.attributionsCollapsible:!0,this.loading=!1,this.state_=t.state!==void 0?t.state:"ready",this.wrapX_=t.wrapX!==void 0?t.wrapX:!1,this.interpolate_=!!t.interpolate,this.viewResolver=null,this.viewRejector=null;const e=this;this.viewPromise_=new Promise(function(i,n){e.viewResolver=i,e.viewRejector=n})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(){return b()}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(t){this.attributions_=oo(t),this.changed()}setState(t){this.state_=t,this.changed()}}function oo(s){return s?Array.isArray(s)?function(t){return s}:typeof s=="function"?s:function(t){return[s]}:null}const da=Oc,vt={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};function or(s,t){return[[-1/0,-1/0,1/0,1/0]]}let bc=!1;function Fc(s,t,e,i,n,r,o){const a=new XMLHttpRequest;a.open("GET",typeof s=="function"?s(e,i,n):s,!0),t.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=bc,a.onload=function(h){if(!a.status||a.status>=200&&a.status<300){const c=t.getType();let u;c=="json"||c=="text"?u=a.responseText:c=="xml"?(u=a.responseXML,u||(u=new DOMParser().parseFromString(a.responseText,"application/xml"))):c=="arraybuffer"&&(u=a.response),u?r(t.readFeatures(u,{extent:e,featureProjection:n}),t.readProjection(u)):o()}else o()},a.onerror=o,a.send()}function ao(s,t){return function(e,i,n,r,o){const a=this;Fc(s,t,e,i,n,function(h,c){a.addFeatures(h),r!==void 0&&r(h)},o||Ie)}}class te extends kt{constructor(t,e,i){super(t),this.feature=e,this.features=i}}class kc extends da{constructor(t){t=t||{},super({attributions:t.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:t.wrapX!==void 0?t.wrapX:!0}),this.on,this.once,this.un,this.loader_=Ie,this.format_=t.format,this.overlaps_=t.overlaps===void 0?!0:t.overlaps,this.url_=t.url,t.loader!==void 0?this.loader_=t.loader:this.url_!==void 0&&(X(this.format_,7),this.loader_=ao(this.url_,this.format_)),this.strategy_=t.strategy!==void 0?t.strategy:or;const e=t.useSpatialIndex!==void 0?t.useSpatialIndex:!0;this.featuresRtree_=e?new ro:null,this.loadedExtentsRtree_=new ro,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,n;Array.isArray(t.features)?n=t.features:t.features&&(i=t.features,n=i.getArray()),!e&&i===void 0&&(i=new ut(n)),n!==void 0&&this.addFeaturesInternal(n),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(t){this.addFeatureInternal(t),this.changed()}addFeatureInternal(t){const e=z(t);if(!this.addToIndex_(e,t)){this.featuresCollection_&&this.featuresCollection_.remove(t);return}this.setupChangeEvents_(e,t);const i=t.getGeometry();if(i){const n=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(n,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new te(vt.ADDFEATURE,t))}setupChangeEvents_(t,e){this.featureChangeKeys_[t]=[W(e,k.CHANGE,this.handleFeatureChange_,this),W(e,He.PROPERTYCHANGE,this.handleFeatureChange_,this)]}addToIndex_(t,e){let i=!0;const n=e.getId();return n!==void 0&&(n.toString()in this.idIndex_?i=!1:this.idIndex_[n.toString()]=e),i&&(X(!(t in this.uidIndex_),30),this.uidIndex_[t]=e),i}addFeatures(t){this.addFeaturesInternal(t),this.changed()}addFeaturesInternal(t){const e=[],i=[],n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],h=z(a);this.addToIndex_(h,a)&&i.push(a)}for(let r=0,o=i.length;r<o;r++){const a=i[r],h=z(a);this.setupChangeEvents_(h,a);const c=a.getGeometry();if(c){const u=c.getExtent();e.push(u),n.push(a)}else this.nullGeometryFeatures_[h]=a}if(this.featuresRtree_&&this.featuresRtree_.load(e,n),this.hasListener(vt.ADDFEATURE))for(let r=0,o=i.length;r<o;r++)this.dispatchEvent(new te(vt.ADDFEATURE,i[r]))}bindFeaturesCollection_(t){let e=!1;this.addEventListener(vt.ADDFEATURE,function(i){e||(e=!0,t.push(i.feature),e=!1)}),this.addEventListener(vt.REMOVEFEATURE,function(i){e||(e=!0,t.remove(i.feature),e=!1)}),t.addEventListener(gt.ADD,function(i){e||(e=!0,this.addFeature(i.element),e=!1)}.bind(this)),t.addEventListener(gt.REMOVE,function(i){e||(e=!0,this.removeFeature(i.element),e=!1)}.bind(this)),this.featuresCollection_=t}clear(t){if(t){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(Z);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){const i=function(n){this.removeFeatureInternal(n)}.bind(this);this.featuresRtree_.forEach(i);for(const n in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[n])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const e=new te(vt.CLEAR);this.dispatchEvent(e),this.changed()}forEachFeature(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureAtCoordinateDirect(t,e){const i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,function(n){if(n.getGeometry().intersectsCoordinate(t))return e(n)})}forEachFeatureInExtent(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureIntersectingExtent(t,e){return this.forEachFeatureInExtent(t,function(i){if(i.getGeometry().intersectsExtent(t)){const r=e(i);if(r)return r}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),$e(this.nullGeometryFeatures_)||Zt(t,Object.values(this.nullGeometryFeatures_))),t}getFeaturesAtCoordinate(t){const e=[];return this.forEachFeatureAtCoordinateDirect(t,function(i){e.push(i)}),e}getFeaturesInExtent(t,e){if(this.featuresRtree_){if(!(e&&e.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);const n=El(t,e);return[].concat(...n.map(r=>this.featuresRtree_.getInExtent(r)))}else return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(t,e){const i=t[0],n=t[1];let r=null;const o=[NaN,NaN];let a=1/0;const h=[-1/0,-1/0,1/0,1/0];return e=e||ve,this.featuresRtree_.forEachInExtent(h,function(c){if(e(c)){const u=c.getGeometry(),d=a;if(a=u.closestPointXY(i,n,o,a),a<d){r=c;const f=Math.sqrt(a);h[0]=i-f,h[1]=n-f,h[2]=i+f,h[3]=n+f}}}),r}getExtent(t){return this.featuresRtree_.getExtent(t)}getFeatureById(t){const e=this.idIndex_[t.toString()];return e!==void 0?e:null}getFeatureByUid(t){const e=this.uidIndex_[t];return e!==void 0?e:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(t){const e=t.target,i=z(e),n=e.getGeometry();if(!n)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[i]=e);else{const o=n.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,e)):this.featuresRtree_&&this.featuresRtree_.update(o,e)}const r=e.getId();if(r!==void 0){const o=r.toString();this.idIndex_[o]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[o]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[i]=e;this.changed(),this.dispatchEvent(new te(vt.CHANGEFEATURE,e))}hasFeature(t){const e=t.getId();return e!==void 0?e in this.idIndex_:z(t)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&$e(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(t,e,i){const n=this.loadedExtentsRtree_,r=this.strategy_(t,e,i);for(let o=0,a=r.length;o<a;++o){const h=r[o];n.forEachInExtent(h,function(u){return ye(u.extent,h)})||(++this.loadingExtentsCount_,this.dispatchEvent(new te(vt.FEATURESLOADSTART)),this.loader_.call(this,h,e,i,function(u){--this.loadingExtentsCount_,this.dispatchEvent(new te(vt.FEATURESLOADEND,void 0,u))}.bind(this),function(){--this.loadingExtentsCount_,this.dispatchEvent(new te(vt.FEATURESLOADERROR))}.bind(this)),n.insert(h,{extent:h.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(t){const e=this.loadedExtentsRtree_;let i;e.forEachInExtent(t,function(n){if(fi(n.extent,t))return i=n,!0}),i&&e.remove(i)}removeFeature(t){if(!t)return;const e=z(t);e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t)&&this.changed()}removeFeatureInternal(t){const e=z(t),i=this.featureChangeKeys_[e];if(!i)return;i.forEach(Z),delete this.featureChangeKeys_[e];const n=t.getId();return n!==void 0&&delete this.idIndex_[n.toString()],delete this.uidIndex_[e],this.dispatchEvent(new te(vt.REMOVEFEATURE,t)),t}removeFromIdIndex_(t){let e=!1;for(const i in this.idIndex_)if(this.idIndex_[i]===t){delete this.idIndex_[i],e=!0;break}return e}setLoader(t){this.loader_=t}setUrl(t){X(this.format_,7),this.url_=t,this.setLoader(ao(t,this.format_))}}const Fn=kc,P={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function fa(s){return Math.pow(s,3)}function ti(s){return 1-fa(1-s)}function Dc(s){return 3*s*s-2*s*s*s}function Nc(s){return s}class Gc extends Cn{constructor(t,e,i){super(),i=i||{},this.tileCoord=t,this.state=e,this.interimTile=null,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(k.CHANGE)}release(){this.state===P.ERROR&&this.setState(P.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getInterimTile(){if(!this.interimTile)return this;let t=this.interimTile;do{if(t.getState()==P.LOADED)return this.transition_=0,t;t=t.interimTile}while(t);return this}refreshInterimChain(){if(!this.interimTile)return;let t=this.interimTile,e=this;do{if(t.getState()==P.LOADED){t.interimTile=null;break}else t.getState()==P.LOADING?e=t:t.getState()==P.IDLE?e.interimTile=t.interimTile:e=t;t=e.interimTile}while(t)}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(this.state!==P.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}load(){b()}getAlpha(t,e){if(!this.transition_)return 1;let i=this.transitionStarts_[t];if(!i)i=e,this.transitionStarts_[t]=i;else if(i===-1)return 1;const n=e-i+1e3/60;return n>=this.transition_?1:fa(n/this.transition_)}inTransition(t){return this.transition_?this.transitionStarts_[t]!==-1:!1}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}}const ga=Gc;class Xc extends ga{constructor(t,e,i,n,r,o){super(t,e,o),this.crossOrigin_=n,this.src_=i,this.key=i,this.image_=new Image,n!==null&&(this.image_.crossOrigin=n),this.unlisten_=null,this.tileLoadFunction_=r}getImage(){return this.image_}setImage(t){this.image_=t,this.state=P.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=P.ERROR,this.unlistenImage_(),this.image_=Wc(),this.changed()}handleImageLoad_(){const t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=P.LOADED:this.state=P.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==P.ERROR&&(this.state=P.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==P.IDLE&&(this.state=P.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=oa(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}function Wc(){const s=xt(1,1);return s.fillStyle="rgba(0,0,0,0)",s.fillRect(0,0,1,1),s.canvas}const ma=Xc;class zc{constructor(t,e,i){this.decay_=t,this.minVelocity_=e,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(t,e){this.points_.push(t,e,Date.now())}end(){if(this.points_.length<6)return!1;const t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;let i=e-3;for(;i>0&&this.points_[i+2]>t;)i-=3;const n=this.points_[e+2]-this.points_[i+2];if(n<1e3/60)return!1;const r=this.points_[e]-this.points_[i],o=this.points_[e+1]-this.points_[i+1];return this.angle_=Math.atan2(o,r),this.initialVelocity_=Math.sqrt(r*r+o*o)/n,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const Yc=zc;class jc extends Ms{constructor(t){super(),this.map_=t}dispatchRenderEvent(t,e){b()}calculateMatrices2D(t){const e=t.viewState,i=t.coordinateToPixelTransform,n=t.pixelToCoordinateTransform;ce(i,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),Fs(n,i)}forEachFeatureAtCoordinate(t,e,i,n,r,o,a,h){let c;const u=e.viewState;function d(E,C,w,v){return r.call(o,C,E?w:null,v)}const f=u.projection,g=Po(t.slice(),f),m=[[0,0]];if(f.canWrapX()&&n){const E=f.getExtent(),C=V(E);m.push([-C,0],[C,0])}const _=e.layerStatesArray,p=_.length,x=[],l=[];for(let E=0;E<m.length;E++)for(let C=p-1;C>=0;--C){const w=_[C],v=w.layer;if(v.hasRenderer()&&nr(w,u)&&a.call(h,v)){const I=v.getRenderer(),S=v.getSource();if(I&&S){const A=S.getWrapX()?g:t,G=d.bind(null,w.managed);l[0]=A[0]+m[E][0],l[1]=A[1]+m[E][1],c=I.forEachFeatureAtCoordinate(l,e,i,G,x)}if(c)return c}}if(x.length===0)return;const y=1/x.length;return x.forEach((E,C)=>E.distanceSq+=C*y),x.sort((E,C)=>E.distanceSq-C.distanceSq),x.some(E=>c=E.callback(E.feature,E.layer,E.geometry)),c}hasFeatureAtCoordinate(t,e,i,n,r,o){return this.forEachFeatureAtCoordinate(t,e,i,n,ve,this,r,o)!==void 0}getMap(){return this.map_}renderFrame(t){b()}scheduleExpireIconCache(t){mn.canExpireCache()&&t.postRenderFunctions.push(Bc)}}function Bc(s,t){mn.expire()}const Kc=jc;class Zc extends Kc{constructor(t){super(t),this.fontChangeListenerKey_=W(jt,He.PROPERTYCHANGE,t.redrawText.bind(t)),this.element_=document.createElement("div");const e=this.element_.style;e.position="absolute",e.width="100%",e.height="100%",e.zIndex="0",this.element_.className=Pn+" ol-layers";const i=t.getViewport();i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(t,e){const i=this.getMap();if(i.hasListener(t)){const n=new la(t,void 0,e);i.dispatchEvent(n)}}disposeInternal(){Z(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),super.disposeInternal()}renderFrame(t){if(!t){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(t),this.dispatchRenderEvent(le.PRECOMPOSE,t);const e=t.layerStatesArray.sort(function(o,a){return o.zIndex-a.zIndex}),i=t.viewState;this.children_.length=0;const n=[];let r=null;for(let o=0,a=e.length;o<a;++o){const h=e[o];t.layerIndex=o;const c=h.layer,u=c.getSourceState();if(!nr(h,i)||u!="ready"&&u!="undefined"){c.unrender();continue}const d=c.render(t,r);d&&(d!==r&&(this.children_.push(d),r=d),"getDeclutter"in c&&n.push(c))}for(let o=n.length-1;o>=0;--o)n[o].renderDeclutter(t);yh(this.element_,this.children_),this.dispatchRenderEvent(le.POSTCOMPOSE,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}}const Vc=Zc;class ne extends kt{constructor(t,e){super(t),this.layer=e}}const $n={LAYERS:"layers"};class ar extends na{constructor(t){t=t||{};const e=Object.assign({},t);delete e.layers;let i=t.layers;super(e),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener($n.LAYERS,this.handleLayersChanged_),i?Array.isArray(i)?i=new ut(i.slice(),{unique:!0}):X(typeof i.getArray=="function",43):i=new ut(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(Z),this.layersListenerKeys_.length=0;const t=this.getLayers();this.layersListenerKeys_.push(W(t,gt.ADD,this.handleLayersAdd_,this),W(t,gt.REMOVE,this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(Z);Si(this.listenerKeys_);const e=t.getArray();for(let i=0,n=e.length;i<n;i++){const r=e[i];this.registerLayerListeners_(r),this.dispatchEvent(new ne("addlayer",r))}this.changed()}registerLayerListeners_(t){const e=[W(t,He.PROPERTYCHANGE,this.handleLayerChange_,this),W(t,k.CHANGE,this.handleLayerChange_,this)];t instanceof ar&&e.push(W(t,"addlayer",this.handleLayerGroupAdd_,this),W(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[z(t)]=e}handleLayerGroupAdd_(t){this.dispatchEvent(new ne("addlayer",t.layer))}handleLayerGroupRemove_(t){this.dispatchEvent(new ne("removelayer",t.layer))}handleLayersAdd_(t){const e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new ne("addlayer",e)),this.changed()}handleLayersRemove_(t){const e=t.element,i=z(e);this.listenerKeys_[i].forEach(Z),delete this.listenerKeys_[i],this.dispatchEvent(new ne("removelayer",e)),this.changed()}getLayers(){return this.get($n.LAYERS)}setLayers(t){const e=this.getLayers();if(e){const i=e.getArray();for(let n=0,r=i.length;n<r;++n)this.dispatchEvent(new ne("removelayer",i[n]))}this.set($n.LAYERS,t)}getLayersArray(t){return t=t!==void 0?t:[],this.getLayers().forEach(function(e){e.getLayersArray(t)}),t}getLayerStatesArray(t){const e=t!==void 0?t:[],i=e.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(e)});const n=this.getLayerState();let r=n.zIndex;!t&&n.zIndex===void 0&&(r=0);for(let o=i,a=e.length;o<a;o++){const h=e[o];h.opacity*=n.opacity,h.visible=h.visible&&n.visible,h.maxResolution=Math.min(h.maxResolution,n.maxResolution),h.minResolution=Math.max(h.minResolution,n.minResolution),h.minZoom=Math.max(h.minZoom,n.minZoom),h.maxZoom=Math.min(h.maxZoom,n.maxZoom),n.extent!==void 0&&(h.extent!==void 0?h.extent=ui(h.extent,n.extent):h.extent=n.extent),h.zIndex===void 0&&(h.zIndex=r)}return e}getSourceState(){return"ready"}}const kn=ar;class Uc extends kt{constructor(t,e,i){super(t),this.map=e,this.frameState=i!==void 0?i:null}}const Ke=Uc;class Hc extends Ke{constructor(t,e,i,n,r,o){super(t,e,r),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=n!==void 0?n:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const ie=Hc,$={SINGLECLICK:"singleclick",CLICK:k.CLICK,DBLCLICK:k.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Es={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};class $c extends Cn{constructor(t,e){super(t),this.map_=t,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=e===void 0?1:e,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=W(i,Es.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=W(i,Es.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(k.TOUCHMOVE,this.boundHandleTouchMove_,Eo?{passive:!1}:!1)}emulateClick_(t){let e=new ie($.CLICK,this.map_,t);this.dispatchEvent(e),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new ie($.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=void 0;const i=new ie($.SINGLECLICK,this.map_,t);this.dispatchEvent(i)}.bind(this),250)}updateActivePointers_(t){const e=t,i=e.pointerId;if(e.type==$.POINTERUP||e.type==$.POINTERCANCEL){delete this.trackedTouches_[i];for(const n in this.trackedTouches_)if(this.trackedTouches_[n].target!==e.target){delete this.trackedTouches_[n];break}}else(e.type==$.POINTERDOWN||e.type==$.POINTERMOVE)&&(this.trackedTouches_[i]=e);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(t){this.updateActivePointers_(t);const e=new ie($.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(Z),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(t){return t.button===0}handlePointerDown_(t){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(t);const e=new ie($.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.down_={};for(const i in t){const n=t[i];this.down_[i]=typeof n=="function"?Ie:n}if(this.dragListenerKeys_.length===0){const i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(W(i,$.POINTERMOVE,this.handlePointerMove_,this),W(i,$.POINTERUP,this.handlePointerUp_,this),W(this.element_,$.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(W(this.element_.getRootNode(),$.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;const e=new ie($.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}relayMoveEvent_(t){this.originalPointerMoveEvent_=t;const e=!!(this.down_&&this.isMoving_(t));this.dispatchEvent(new ie($.POINTERMOVE,this.map_,t,e))}handleTouchMove_(t){const e=this.originalPointerMoveEvent_;(!e||e.defaultPrevented)&&(typeof t.cancelable!="boolean"||t.cancelable===!0)&&t.preventDefault()}isMoving_(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(Z(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(k.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Z(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Z),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const qc=$c,Bt={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},rt={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},_n=1/0;class Jc{constructor(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,Si(this.queuedElements_)}dequeue(){const t=this.elements_,e=this.priorities_,i=t[0];t.length==1?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));const n=this.keyFunction_(i);return delete this.queuedElements_[n],i}enqueue(t){X(!(this.keyFunction_(t)in this.queuedElements_),31);const e=this.priorityFunction_(t);return e!=_n?(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(t){return t*2+1}getRightChildIndex_(t){return t*2+2}getParentIndex_(t){return t-1>>1}heapify_(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}isEmpty(){return this.elements_.length===0}isKeyQueued(t){return t in this.queuedElements_}isQueued(t){return this.isKeyQueued(this.keyFunction_(t))}siftUp_(t){const e=this.elements_,i=this.priorities_,n=e.length,r=e[t],o=i[t],a=t;for(;t<n>>1;){const h=this.getLeftChildIndex_(t),c=this.getRightChildIndex_(t),u=c<n&&i[c]<i[h]?c:h;e[t]=e[u],i[t]=i[u],t=u}e[t]=r,i[t]=o,this.siftDown_(a,t)}siftDown_(t,e){const i=this.elements_,n=this.priorities_,r=i[e],o=n[e];for(;e>t;){const a=this.getParentIndex_(e);if(n[a]>o)i[e]=i[a],n[e]=n[a],e=a;else break}i[e]=r,n[e]=o}reprioritize(){const t=this.priorityFunction_,e=this.elements_,i=this.priorities_;let n=0;const r=e.length;let o,a,h;for(a=0;a<r;++a)o=e[a],h=t(o),h==_n?delete this.queuedElements_[this.keyFunction_(o)]:(i[n]=h,e[n++]=o);e.length=n,i.length=n,this.heapify_()}}const Qc=Jc;class tu extends Qc{constructor(t,e){super(function(i){return t.apply(null,i)},function(i){return i[0].getKey()}),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=e,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(t){const e=super.enqueue(t);return e&&t[0].addEventListener(k.CHANGE,this.boundHandleTileChange_),e}getTilesLoading(){return this.tilesLoading_}handleTileChange(t){const e=t.target,i=e.getState();if(i===P.LOADED||i===P.ERROR||i===P.EMPTY){i!==P.ERROR&&e.removeEventListener(k.CHANGE,this.boundHandleTileChange_);const n=e.getKey();n in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[n],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(t,e){let i=0,n,r,o;for(;this.tilesLoading_<t&&i<e&&this.getCount()>0;)r=this.dequeue()[0],o=r.getKey(),n=r.getState(),n===P.IDLE&&!(o in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[o]=!0,++this.tilesLoading_,++i,r.load())}}const eu=tu;function iu(s,t,e,i,n){if(!s||!(e in s.wantedTiles)||!s.wantedTiles[e][t.getKey()])return _n;const r=s.viewState.center,o=i[0]-r[0],a=i[1]-r[1];return 65536*Math.log(n)+Math.sqrt(o*o+a*a)/n}const It={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"},nu=42,lr=256;function lo(s,t,e){return function(i,n,r,o,a){if(!i)return;if(!n&&!t)return i;const h=t?0:r[0]*n,c=t?0:r[1]*n,u=a?a[0]:0,d=a?a[1]:0;let f=s[0]+h/2+u,g=s[2]-h/2+u,m=s[1]+c/2+d,_=s[3]-c/2+d;f>g&&(f=(g+f)/2,g=f),m>_&&(m=(_+m)/2,_=m);let p=J(i[0],f,g),x=J(i[1],m,_);if(o&&e&&n){const l=30*n;p+=-l*Math.log(1+Math.max(0,f-i[0])/l)+l*Math.log(1+Math.max(0,i[0]-g)/l),x+=-l*Math.log(1+Math.max(0,m-i[1])/l)+l*Math.log(1+Math.max(0,i[1]-_)/l)}return[p,x]}}function su(s){return s}function hr(s,t,e,i){const n=V(t)/e[0],r=Ft(t)/e[1];return i?Math.min(s,Math.max(n,r)):Math.min(s,Math.min(n,r))}function cr(s,t,e){let i=Math.min(s,t);const n=50;return i*=Math.log(1+n*Math.max(0,s/t-1))/n+1,e&&(i=Math.max(i,e),i/=Math.log(1+n*Math.max(0,e/s-1))/n+1),J(i,e/2,t*2)}function ru(s,t,e,i){return t=t!==void 0?t:!0,function(n,r,o,a){if(n!==void 0){const h=s[0],c=s[s.length-1],u=e?hr(h,e,o,i):h;if(a)return t?cr(n,u,c):J(n,c,u);const d=Math.min(u,n),f=Math.floor(Ps(s,d,r));return s[f]>u&&f<s.length-1?s[f+1]:s[f]}else return}}function ou(s,t,e,i,n,r){return i=i!==void 0?i:!0,e=e!==void 0?e:0,function(o,a,h,c){if(o!==void 0){const u=n?hr(t,n,h,r):t;if(c)return i?cr(o,u,e):J(o,e,u);const d=1e-9,f=Math.ceil(Math.log(t/u)/Math.log(s)-d),g=-a*(.5-d)+.5,m=Math.min(u,o),_=Math.floor(Math.log(t/m)/Math.log(s)+g),p=Math.max(f,_),x=t/Math.pow(s,p);return J(x,e,u)}else return}}function ho(s,t,e,i,n){return e=e!==void 0?e:!0,function(r,o,a,h){if(r!==void 0){const c=i?hr(s,i,a,n):s;return!e||!h?J(r,t,c):cr(r,c,t)}else return}}function ur(s){if(s!==void 0)return 0}function co(s){if(s!==void 0)return s}function au(s){const t=2*Math.PI/s;return function(e,i){if(i)return e;if(e!==void 0)return e=Math.floor(e/t+.5)*t,e}}function lu(s){return s=s||Qi(5),function(t,e){if(e)return t;if(t!==void 0)return Math.abs(t)<=s?0:t}}const qn=0;class hu extends Lt{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=Ws(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&Ao(),t.center&&(t.center=Yt(t.center,this.projection_)),t.extent&&(t.extent=pe(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){const e=Object.assign({},t);for(const a in It)delete e[a];this.setProperties(e,!0);const i=uu(t);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=i.minZoom;const n=cu(t),r=i.constraint,o=du(t);this.constraints_={center:n,resolution:r,rotation:o},this.setRotation(t.rotation!==void 0?t.rotation:0),this.setCenterInternal(t.center!==void 0?t.center:null),t.resolution!==void 0?this.setResolution(t.resolution):t.zoom!==void 0&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;const i=this.getCenter();if(i){const n=t||[0,0,0,0];e=e||[0,0,0,0];const r=this.getResolution(),o=r/2*(n[3]-e[3]+e[1]-n[1]),a=r/2*(n[0]-e[0]+e[2]-n[2]);this.setCenterInternal([i[0]+o,i[1]-a])}}getUpdatedOptions_(t){const e=this.getProperties();return e.resolution!==void 0?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const e=new Array(arguments.length);for(let i=0;i<e.length;++i){let n=arguments[i];n.center&&(n=Object.assign({},n),n.center=Yt(n.center,this.getProjection())),n.anchor&&(n=Object.assign({},n),n.anchor=Yt(n.anchor,this.getProjection())),e[i]=n}this.animateInternal.apply(this,e)}animateInternal(t){let e=arguments.length,i;e>1&&typeof arguments[e-1]=="function"&&(i=arguments[e-1],--e);let n=0;for(;n<e&&!this.isDef();++n){const u=arguments[n];u.center&&this.setCenterInternal(u.center),u.zoom!==void 0?this.setZoom(u.zoom):u.resolution&&this.setResolution(u.resolution),u.rotation!==void 0&&this.setRotation(u.rotation)}if(n===e){i&&Hi(i,!0);return}let r=Date.now(),o=this.targetCenter_.slice(),a=this.targetResolution_,h=this.targetRotation_;const c=[];for(;n<e;++n){const u=arguments[n],d={start:r,complete:!1,anchor:u.anchor,duration:u.duration!==void 0?u.duration:1e3,easing:u.easing||Dc,callback:i};if(u.center&&(d.sourceCenter=o,d.targetCenter=u.center.slice(),o=d.targetCenter),u.zoom!==void 0?(d.sourceResolution=a,d.targetResolution=this.getResolutionForZoom(u.zoom),a=d.targetResolution):u.resolution&&(d.sourceResolution=a,d.targetResolution=u.resolution,a=d.targetResolution),u.rotation!==void 0){d.sourceRotation=h;const f=Ue(u.rotation-h+Math.PI,2*Math.PI)-Math.PI;d.targetRotation=h+f,h=d.targetRotation}fu(d)?d.complete=!0:r+=d.duration,c.push(d)}this.animations_.push(c),this.setHint(ot.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[ot.ANIMATING]>0}getInteracting(){return this.hints_[ot.INTERACTING]>0}cancelAnimations(){this.setHint(ot.ANIMATING,-this.hints_[ot.ANIMATING]);let t;for(let e=0,i=this.animations_.length;e<i;++e){const n=this.animations_[e];if(n[0].callback&&Hi(n[0].callback,!1),!t)for(let r=0,o=n.length;r<o;++r){const a=n[r];if(!a.complete){t=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let e=!1;for(let i=this.animations_.length-1;i>=0;--i){const n=this.animations_[i];let r=!0;for(let o=0,a=n.length;o<a;++o){const h=n[o];if(h.complete)continue;const c=t-h.start;let u=h.duration>0?c/h.duration:1;u>=1?(h.complete=!0,u=1):r=!1;const d=h.easing(u);if(h.sourceCenter){const f=h.sourceCenter[0],g=h.sourceCenter[1],m=h.targetCenter[0],_=h.targetCenter[1];this.nextCenter_=h.targetCenter;const p=f+d*(m-f),x=g+d*(_-g);this.targetCenter_=[p,x]}if(h.sourceResolution&&h.targetResolution){const f=d===1?h.targetResolution:h.sourceResolution+d*(h.targetResolution-h.sourceResolution);if(h.anchor){const g=this.getViewportSize_(this.getRotation()),m=this.constraints_.resolution(f,0,g,!0);this.targetCenter_=this.calculateCenterZoom(m,h.anchor)}this.nextResolution_=h.targetResolution,this.targetResolution_=f,this.applyTargetState_(!0)}if(h.sourceRotation!==void 0&&h.targetRotation!==void 0){const f=d===1?Ue(h.targetRotation+Math.PI,2*Math.PI)-Math.PI:h.sourceRotation+d*(h.targetRotation-h.sourceRotation);if(h.anchor){const g=this.constraints_.rotation(f,!0);this.targetCenter_=this.calculateCenterRotate(g,h.anchor)}this.nextRotation_=h.targetRotation,this.targetRotation_=f}if(this.applyTargetState_(!0),e=!0,!h.complete)break}if(r){this.animations_[i]=null,this.setHint(ot.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=n[0].callback;o&&Hi(o,!0)}}this.animations_=this.animations_.filter(Boolean),e&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let i;const n=this.getCenterInternal();return n!==void 0&&(i=[n[0]-e[0],n[1]-e[1]],Gs(i,t-this.getRotation()),bl(i,e)),i}calculateCenterZoom(t,e){let i;const n=this.getCenterInternal(),r=this.getResolution();if(n!==void 0&&r!==void 0){const o=e[0]-t*(e[0]-n[0])/r,a=e[1]-t*(e[1]-n[1])/r;i=[o,a]}return i}getViewportSize_(t){const e=this.viewportSize_;if(t){const i=e[0],n=e[1];return[Math.abs(i*Math.cos(t))+Math.abs(n*Math.sin(t)),Math.abs(i*Math.sin(t))+Math.abs(n*Math.cos(t))]}else return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const t=this.getCenterInternal();return t&&ds(t,this.getProjection())}getCenterInternal(){return this.get(It.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return t!==void 0?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){const e=this.calculateExtentInternal(t);return Fo(e,this.getProjection())}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();const e=this.getCenterInternal();X(e,1);const i=this.getResolution();X(i!==void 0,2);const n=this.getRotation();return X(n!==void 0,3),ls(e,i,n,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(It.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(pe(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();const i=V(t)/e[0],n=Ft(t)/e[1];return Math.max(i,n)}getResolutionForValueFunction(t){t=t||2;const e=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,n=Math.log(e/i)/Math.log(t);return function(r){return e/Math.pow(t,r*n)}}getRotation(){return this.get(It.ROTATION)}getValueForResolutionFunction(t){const e=Math.log(t||2),i=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,r=Math.log(i/n)/e;return function(o){return Math.log(i/o)/e/r}}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t);const i=this.padding_;return i&&(e=[e[0]-i[1]-i[3],e[1]-i[0]-i[2]]),e}getState(){const t=this.getProjection(),e=this.getResolution(),i=this.getRotation();let n=this.getCenterInternal();const r=this.padding_;if(r){const o=this.getViewportSizeMinusPadding_();n=Jn(n,this.getViewportSize_(),[o[0]/2+r[3],o[1]/2+r[0]],e,i)}return{center:n.slice(0),projection:t!==void 0?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getZoom(){let t;const e=this.getResolution();return e!==void 0&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e=this.minZoom_||0,i,n;if(this.resolutions_){const r=Ps(this.resolutions_,t,1);e=r,i=this.resolutions_[r],r==this.resolutions_.length-1?n=2:n=i/this.resolutions_[r+1]}else i=this.maxResolution_,n=this.zoomFactor_;return e+Math.log(i/t)/Math.log(n)}getResolutionForZoom(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;const e=J(Math.floor(t),0,this.resolutions_.length-2),i=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(i,J(t-e,0,1))}else return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let i;if(X(Array.isArray(t)||typeof t.getSimplifiedGeometry=="function",24),Array.isArray(t)){X(!Ns(t),25);const n=pe(t,this.getProjection());i=Xr(n)}else if(t.getType()==="Circle"){const n=pe(t.getExtent(),this.getProjection());i=Xr(n),i.rotate(this.getRotation(),Se(n))}else i=t;this.fitInternal(i,e)}rotatedExtentForGeometry(t){const e=this.getRotation(),i=Math.cos(e),n=Math.sin(-e),r=t.getFlatCoordinates(),o=t.getStride();let a=1/0,h=1/0,c=-1/0,u=-1/0;for(let d=0,f=r.length;d<f;d+=o){const g=r[d]*i-r[d+1]*n,m=r[d]*n+r[d+1]*i;a=Math.min(a,g),h=Math.min(h,m),c=Math.max(c,g),u=Math.max(u,m)}return[a,h,c,u]}fitInternal(t,e){e=e||{};let i=e.size;i||(i=this.getViewportSizeMinusPadding_());const n=e.padding!==void 0?e.padding:[0,0,0,0],r=e.nearest!==void 0?e.nearest:!1;let o;e.minResolution!==void 0?o=e.minResolution:e.maxZoom!==void 0?o=this.getResolutionForZoom(e.maxZoom):o=0;const a=this.rotatedExtentForGeometry(t);let h=this.getResolutionForExtentInternal(a,[i[0]-n[1]-n[3],i[1]-n[0]-n[2]]);h=isNaN(h)?o:Math.max(h,o),h=this.getConstrainedResolution(h,r?0:1);const c=this.getRotation(),u=Math.sin(c),d=Math.cos(c),f=Se(a);f[0]+=(n[1]-n[3])/2*h,f[1]+=(n[0]-n[2])/2*h;const g=f[0]*d-f[1]*u,m=f[1]*d+f[0]*u,_=this.getConstrainedCenter([g,m],h),p=e.callback?e.callback:Ie;e.duration!==void 0?this.animateInternal({resolution:h,center:_,duration:e.duration,easing:e.easing},p):(this.targetResolution_=h,this.targetCenter_=_,this.applyTargetState_(!1,!0),Hi(p,!0))}centerOn(t,e,i){this.centerOnInternal(Yt(t,this.getProjection()),e,i)}centerOnInternal(t,e,i){this.setCenterInternal(Jn(t,e,i,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,i,n){let r;const o=this.padding_;if(o&&t){const a=this.getViewportSizeMinusPadding_(-i),h=Jn(t,n,[a[0]/2+o[3],a[1]/2+o[0]],e,i);r=[t[0]-h[0],t[1]-h[1]]}return r}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(t){const e=ds(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){const e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&Yt(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){const i=this.getAnimating()||this.getInteracting(),n=this.getViewportSize_(this.getRotation()),r=this.constraints_.resolution(this.targetResolution_*t,0,n,i);e&&(this.targetCenter_=this.calculateCenterZoom(r,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=Yt(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){const i=this.getAnimating()||this.getInteracting(),n=this.constraints_.rotation(this.targetRotation_+t,i);e&&(this.targetCenter_=this.calculateCenterRotate(n,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t&&Yt(t,this.getProjection()))}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){const i=this.getAnimating()||this.getInteracting()||e,n=this.constraints_.rotation(this.targetRotation_,i),r=this.getViewportSize_(n),o=this.constraints_.resolution(this.targetResolution_,0,r,i),a=this.constraints_.center(this.targetCenter_,o,r,i,this.calculateCenterShift(this.targetCenter_,o,n,r));this.get(It.ROTATION)!==n&&this.set(It.ROTATION,n),this.get(It.RESOLUTION)!==o&&(this.set(It.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(It.CENTER)||!sn(this.get(It.CENTER),a))&&this.set(It.CENTER,a),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,i){t=t!==void 0?t:200;const n=e||0,r=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(r),a=this.constraints_.resolution(this.targetResolution_,n,o),h=this.constraints_.center(this.targetCenter_,a,o,!1,this.calculateCenterShift(this.targetCenter_,a,r,o));if(t===0&&!this.cancelAnchor_){this.targetResolution_=a,this.targetRotation_=r,this.targetCenter_=h,this.applyTargetState_();return}i=i||(t===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==r||!this.getCenterInternal()||!sn(this.getCenterInternal(),h))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:r,center:h,resolution:a,duration:t,easing:ti,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(ot.INTERACTING,1)}endInteraction(t,e,i){i=i&&Yt(i,this.getProjection()),this.endInteractionInternal(t,e,i)}endInteractionInternal(t,e,i){this.setHint(ot.INTERACTING,-1),this.resolveConstraints(t,e,i)}getConstrainedCenter(t,e){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),i)}getConstrainedZoom(t,e){const i=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(i,e))}getConstrainedResolution(t,e){e=e||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,i)}}function Hi(s,t){setTimeout(function(){s(t)},0)}function cu(s){if(s.extent!==void 0){const e=s.smoothExtentConstraint!==void 0?s.smoothExtentConstraint:!0;return lo(s.extent,s.constrainOnlyCenter,e)}const t=Ws(s.projection,"EPSG:3857");if(s.multiWorld!==!0&&t.isGlobal()){const e=t.getExtent().slice();return e[0]=-1/0,e[2]=1/0,lo(e,!1,!1)}return su}function uu(s){let t,e,i,o=s.minZoom!==void 0?s.minZoom:qn,a=s.maxZoom!==void 0?s.maxZoom:28;const h=s.zoomFactor!==void 0?s.zoomFactor:2,c=s.multiWorld!==void 0?s.multiWorld:!1,u=s.smoothResolutionConstraint!==void 0?s.smoothResolutionConstraint:!0,d=s.showFullExtent!==void 0?s.showFullExtent:!1,f=Ws(s.projection,"EPSG:3857"),g=f.getExtent();let m=s.constrainOnlyCenter,_=s.extent;if(!c&&!_&&f.isGlobal()&&(m=!1,_=g),s.resolutions!==void 0){const p=s.resolutions;e=p[o],i=p[a]!==void 0?p[a]:p[p.length-1],s.constrainResolution?t=ru(p,u,!m&&_,d):t=ho(e,i,u,!m&&_,d)}else{const x=(g?Math.max(V(g),Ft(g)):360*gi.degrees/f.getMetersPerUnit())/lr/Math.pow(2,qn),l=x/Math.pow(2,28-qn);e=s.maxResolution,e!==void 0?o=0:e=x/Math.pow(h,o),i=s.minResolution,i===void 0&&(s.maxZoom!==void 0?s.maxResolution!==void 0?i=e/Math.pow(h,a):i=x/Math.pow(h,a):i=l),a=o+Math.floor(Math.log(e/i)/Math.log(h)),i=e/Math.pow(h,a-o),s.constrainResolution?t=ou(h,e,i,u,!m&&_,d):t=ho(e,i,u,!m&&_,d)}return{constraint:t,maxResolution:e,minResolution:i,minZoom:o,zoomFactor:h}}function du(s){if(s.enableRotation!==void 0?s.enableRotation:!0){const e=s.constrainRotation;return e===void 0||e===!0?lu():e===!1?co:typeof e=="number"?au(e):co}else return ur}function fu(s){return!(s.sourceCenter&&s.targetCenter&&!sn(s.sourceCenter,s.targetCenter)||s.sourceResolution!==s.targetResolution||s.sourceRotation!==s.targetRotation)}function Jn(s,t,e,i,n){const r=Math.cos(-n);let o=Math.sin(-n),a=s[0]*r-s[1]*o,h=s[1]*r+s[0]*o;a+=(t[0]/2-e[0])*i,h+=(e[1]-t[1]/2)*i,o=-o;const c=a*r-h*o,u=h*r+a*o;return[c,u]}const se=hu;class gu extends Lt{constructor(t){super();const e=t.element;e&&!t.target&&!e.style.pointerEvents&&(e.style.pointerEvents="auto"),this.element=e||null,this.target_=null,this.map_=null,this.listenerKeys=[],t.render&&(this.render=t.render),t.target&&this.setTarget(t.target)}disposeInternal(){cn(this.element),super.disposeInternal()}getMap(){return this.map_}setMap(t){this.map_&&cn(this.element);for(let e=0,i=this.listenerKeys.length;e<i;++e)Z(this.listenerKeys[e]);this.listenerKeys.length=0,this.map_=t,t&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==Ie&&this.listenerKeys.push(W(t,Bt.POSTRENDER,this.render,this)),t.render())}render(t){}setTarget(t){this.target_=typeof t=="string"?document.getElementById(t):t}}const dr=gu;class mu extends dr{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=t.collapsed!==void 0?t.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=t.collapsible!==void 0,this.collapsible_=t.collapsible!==void 0?t.collapsible:!0,this.collapsible_||(this.collapsed_=!1);const e=t.className!==void 0?t.className:"ol-attribution",i=t.tipLabel!==void 0?t.tipLabel:"Attributions",n=t.expandClassName!==void 0?t.expandClassName:e+"-expand",r=t.collapseLabel!==void 0?t.collapseLabel:"›",o=t.collapseClassName!==void 0?t.collapseClassName:e+"-collapse";typeof r=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=r,this.collapseLabel_.className=o):this.collapseLabel_=r;const a=t.label!==void 0?t.label:"i";typeof a=="string"?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=n):this.label_=a;const h=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(h),this.toggleButton_.addEventListener(k.CLICK,this.handleClick_.bind(this),!1);const c=e+" "+Pn+" "+Qs+(this.collapsed_&&this.collapsible_?" "+jr:"")+(this.collapsible_?"":" ol-uncollapsible"),u=this.element;u.className=c,u.appendChild(this.toggleButton_),u.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(t){const e={},i=[];let n=!0;const r=t.layerStatesArray;for(let o=0,a=r.length;o<a;++o){const h=r[o];if(!nr(h,t.viewState))continue;const c=h.layer.getSource();if(!c)continue;const u=c.getAttributions();if(!u)continue;const d=u(t);if(d)if(n=n&&c.getAttributionsCollapsible()!==!1,Array.isArray(d))for(let f=0,g=d.length;f<g;++f)d[f]in e||(i.push(d[f]),e[d[f]]=!0);else d in e||(i.push(d),e[d]=!0)}return this.overrideCollapsible_||this.setCollapsible(n),i}updateElement_(t){if(!t){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const e=this.collectSourceAttributions_(t),i=e.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!Le(e,this.renderedAttributions_)){Jo(this.ulElement_);for(let n=0,r=e.length;n<r;++n){const o=document.createElement("li");o.innerHTML=e[n],this.ulElement_.appendChild(o)}this.renderedAttributions_=e}}handleClick_(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(jr),this.collapsed_?Yr(this.collapseLabel_,this.label_):Yr(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(t){this.userCollapsed_=t,!(!this.collapsible_||this.collapsed_===t)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(t){this.updateElement_(t.frameState)}}const _a=mu;class _u extends dr{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target});const e=t.className!==void 0?t.className:"ol-rotate",i=t.label!==void 0?t.label:"⇧",n=t.compassClassName!==void 0?t.compassClassName:"ol-compass";this.label_=null,typeof i=="string"?(this.label_=document.createElement("span"),this.label_.className=n,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(n));const r=t.tipLabel?t.tipLabel:"Reset rotation",o=document.createElement("button");o.className=e+"-reset",o.setAttribute("type","button"),o.title=r,o.appendChild(this.label_),o.addEventListener(k.CLICK,this.handleClick_.bind(this),!1);const a=e+" "+Pn+" "+Qs,h=this.element;h.className=a,h.appendChild(o),this.callResetNorth_=t.resetNorth?t.resetNorth:void 0,this.duration_=t.duration!==void 0?t.duration:250,this.autoHide_=t.autoHide!==void 0?t.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Ki)}handleClick_(t){t.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const e=this.getMap().getView();if(!e)return;const i=e.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?e.animate({rotation:0,duration:this.duration_,easing:ti}):e.setRotation(0))}render(t){const e=t.frameState;if(!e)return;const i=e.viewState.rotation;if(i!=this.rotation_){const n="rotate("+i+"rad)";if(this.autoHide_){const r=this.element.classList.contains(Ki);!r&&i===0?this.element.classList.add(Ki):r&&i!==0&&this.element.classList.remove(Ki)}this.label_.style.transform=n}this.rotation_=i}}const yu=_u;class pu extends dr{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target});const e=t.className!==void 0?t.className:"ol-zoom",i=t.delta!==void 0?t.delta:1,n=t.zoomInClassName!==void 0?t.zoomInClassName:e+"-in",r=t.zoomOutClassName!==void 0?t.zoomOutClassName:e+"-out",o=t.zoomInLabel!==void 0?t.zoomInLabel:"+",a=t.zoomOutLabel!==void 0?t.zoomOutLabel:"–",h=t.zoomInTipLabel!==void 0?t.zoomInTipLabel:"Zoom in",c=t.zoomOutTipLabel!==void 0?t.zoomOutTipLabel:"Zoom out",u=document.createElement("button");u.className=n,u.setAttribute("type","button"),u.title=h,u.appendChild(typeof o=="string"?document.createTextNode(o):o),u.addEventListener(k.CLICK,this.handleClick_.bind(this,i),!1);const d=document.createElement("button");d.className=r,d.setAttribute("type","button"),d.title=c,d.appendChild(typeof a=="string"?document.createTextNode(a):a),d.addEventListener(k.CLICK,this.handleClick_.bind(this,-i),!1);const f=e+" "+Pn+" "+Qs,g=this.element;g.className=f,g.appendChild(u),g.appendChild(d),this.duration_=t.duration!==void 0?t.duration:250}handleClick_(t,e){e.preventDefault(),this.zoomByDelta_(t)}zoomByDelta_(t){const i=this.getMap().getView();if(!i)return;const n=i.getZoom();if(n!==void 0){const r=i.getConstrainedZoom(n+t);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:r,duration:this.duration_,easing:ti})):i.setZoom(r)}}}const xu=pu;function ya(s){s=s||{};const t=new ut;return(s.zoom!==void 0?s.zoom:!0)&&t.push(new xu(s.zoomOptions)),(s.rotate!==void 0?s.rotate:!0)&&t.push(new yu(s.rotateOptions)),(s.attribution!==void 0?s.attribution:!0)&&t.push(new _a(s.attributionOptions)),t}const Cs={ACTIVE:"active"};class Eu extends Lt{constructor(t){super(),this.on,this.once,this.un,t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(Cs.ACTIVE)}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set(Cs.ACTIVE,t)}setMap(t){this.map_=t}}function Cu(s,t,e){const i=s.getCenterInternal();if(i){const n=[i[0]+t[0],i[1]+t[1]];s.animateInternal({duration:e!==void 0?e:250,easing:Nc,center:s.getConstrainedCenter(n)})}}function fr(s,t,e,i){const n=s.getZoom();if(n===void 0)return;const r=s.getConstrainedZoom(n+t),o=s.getResolutionForZoom(r);s.getAnimating()&&s.cancelAnimations(),s.animate({resolution:o,anchor:e,duration:i!==void 0?i:250,easing:ti})}const Oi=Eu;class wu extends Oi{constructor(t){super(),t=t||{},this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:250}handleEvent(t){let e=!1;if(t.type==$.DBLCLICK){const i=t.originalEvent,n=t.map,r=t.coordinate,o=i.shiftKey?-this.delta_:this.delta_,a=n.getView();fr(a,o,r,this.duration_),i.preventDefault(),e=!0}return!e}}const Ru=wu;class Tu extends Oi{constructor(t){t=t||{},super(t),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==$.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==$.POINTERUP){const i=this.handleUpEvent(t);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(t.type==$.POINTERDOWN){const i=this.handleDownEvent(t);this.handlingDownUpSequence=i,e=this.stopDown(i)}else t.type==$.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}}function gr(s){const t=s.length;let e=0,i=0;for(let n=0;n<t;n++)e+=s[n].clientX,i+=s[n].clientY;return[e/t,i/t]}const ei=Tu;function ws(s){const t=arguments;return function(e){let i=!0;for(let n=0,r=t.length;n<r&&(i=i&&t[n](e),!!i);++n);return i}}const vu=function(s){const t=s.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},Iu=function(s){const t=s.map.getTargetElement(),e=s.map.getOwnerDocument().activeElement;return t.contains(e)},pa=function(s){return s.map.getTargetElement().hasAttribute("tabindex")?Iu(s):!0},xa=ve,Ea=function(s){const t=s.originalEvent;return t.button==0&&!(ol&&al&&t.ctrlKey)},Ca=function(s){const t=s.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},Su=function(s){const t=s.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},wa=function(s){const t=s.originalEvent,e=t.target.tagName;return e!=="INPUT"&&e!=="SELECT"&&e!=="TEXTAREA"&&!t.target.isContentEditable},Qn=function(s){const t=s.originalEvent;return X(t!==void 0,56),t.pointerType=="mouse"},Lu=function(s){const t=s.originalEvent;return X(t!==void 0,56),t.isPrimary&&t.button===0};class Mu extends ei{constructor(t){super({stopDown:En}),t=t||{},this.kinetic_=t.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const e=t.condition?t.condition:ws(Ca,Lu);this.condition_=t.onFocusOnly?ws(pa,e):e,this.noKinetic_=!1}handleDragEvent(t){this.panning_||(this.panning_=!0,this.getMap().getView().beginInteraction());const e=this.targetPointers,i=gr(e);if(e.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){const n=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],o=t.map.getView();Fl(n,o.getResolution()),Gs(n,o.getRotation()),o.adjustCenterInternal(n)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=e.length,t.originalEvent.preventDefault()}handleUpEvent(t){const e=t.map,i=e.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const n=this.kinetic_.getDistance(),r=this.kinetic_.getAngle(),o=i.getCenterInternal(),a=e.getPixelFromCoordinateInternal(o),h=e.getCoordinateFromPixelInternal([a[0]-n*Math.cos(r),a[1]-n*Math.sin(r)]);i.animateInternal({center:i.getConstrainedCenter(h),duration:500,easing:ti})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}else return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(t){if(this.targetPointers.length>0&&this.condition_(t)){const i=t.map.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}else return!1}}const Pu=Mu;class Au extends ei{constructor(t){t=t||{},super({stopDown:En}),this.condition_=t.condition?t.condition:vu,this.lastAngle_=void 0,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){if(!Qn(t))return;const e=t.map,i=e.getView();if(i.getConstraints().rotation===ur)return;const n=e.getSize(),r=t.pixel,o=Math.atan2(n[1]/2-r[1],r[0]-n[0]/2);if(this.lastAngle_!==void 0){const a=o-this.lastAngle_;i.adjustRotationInternal(-a)}this.lastAngle_=o}handleUpEvent(t){return Qn(t)?(t.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(t){return Qn(t)&&Ea(t)&&this.condition_(t)?(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}const Ou=Au;class bu extends Ms{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const t=this.startPixel_,e=this.endPixel_,i="px",n=this.element_.style;n.left=Math.min(t[0],e[0])+i,n.top=Math.min(t[1],e[1])+i,n.width=Math.abs(e[0]-t[0])+i,n.height=Math.abs(e[1]-t[1])+i}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const e=this.element_.style;e.left="inherit",e.top="inherit",e.width="inherit",e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){const t=this.startPixel_,e=this.endPixel_,n=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);n[4]=n[0].slice(),this.geometry_?this.geometry_.setCoordinates([n]):this.geometry_=new an([n])}getGeometry(){return this.geometry_}}const Fu=bu,$i={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class ts extends kt{constructor(t,e,i){super(t),this.coordinate=e,this.mapBrowserEvent=i}}class ku extends ei{constructor(t){super(),this.on,this.once,this.un,t=t||{},this.box_=new Fu(t.className||"ol-dragbox"),this.minArea_=t.minArea!==void 0?t.minArea:64,t.onBoxEnd&&(this.onBoxEnd=t.onBoxEnd),this.startPixel_=null,this.condition_=t.condition?t.condition:Ea,this.boxEndCondition_=t.boxEndCondition?t.boxEndCondition:this.defaultBoxEndCondition}defaultBoxEndCondition(t,e,i){const n=i[0]-e[0],r=i[1]-e[1];return n*n+r*r>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new ts($i.BOXDRAG,t.coordinate,t))}handleUpEvent(t){this.box_.setMap(null);const e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new ts(e?$i.BOXEND:$i.BOXCANCEL,t.coordinate,t)),!1}handleDownEvent(t){return this.condition_(t)?(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new ts($i.BOXSTART,t.coordinate,t)),!0):!1}onBoxEnd(t){}}const Du=ku;class Nu extends Du{constructor(t){t=t||{};const e=t.condition?t.condition:Su;super({condition:e,className:t.className||"ol-dragzoom",minArea:t.minArea}),this.duration_=t.duration!==void 0?t.duration:200,this.out_=t.out!==void 0?t.out:!1}onBoxEnd(t){const i=this.getMap().getView();let n=this.getGeometry();if(this.out_){const r=i.rotatedExtentForGeometry(n),o=i.getResolutionForExtentInternal(r),a=i.getResolution()/o;n=n.clone(),n.scale(a*a)}i.fitInternal(n,{duration:this.duration_,easing:ti})}}const Gu=Nu,fe={LEFT:37,UP:38,RIGHT:39,DOWN:40};class Xu extends Oi{constructor(t){super(),t=t||{},this.defaultCondition_=function(e){return Ca(e)&&wa(e)},this.condition_=t.condition!==void 0?t.condition:this.defaultCondition_,this.duration_=t.duration!==void 0?t.duration:100,this.pixelDelta_=t.pixelDelta!==void 0?t.pixelDelta:128}handleEvent(t){let e=!1;if(t.type==k.KEYDOWN){const i=t.originalEvent,n=i.keyCode;if(this.condition_(t)&&(n==fe.DOWN||n==fe.LEFT||n==fe.RIGHT||n==fe.UP)){const o=t.map.getView(),a=o.getResolution()*this.pixelDelta_;let h=0,c=0;n==fe.DOWN?c=-a:n==fe.LEFT?h=-a:n==fe.RIGHT?h=a:c=a;const u=[h,c];Gs(u,o.getRotation()),Cu(o,u,this.duration_),i.preventDefault(),e=!0}}return!e}}const Wu=Xu;class zu extends Oi{constructor(t){super(),t=t||{},this.condition_=t.condition?t.condition:wa,this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:100}handleEvent(t){let e=!1;if(t.type==k.KEYDOWN||t.type==k.KEYPRESS){const i=t.originalEvent,n=i.charCode;if(this.condition_(t)&&(n=="+".charCodeAt(0)||n=="-".charCodeAt(0))){const r=t.map,o=n=="+".charCodeAt(0)?this.delta_:-this.delta_,a=r.getView();fr(a,o,void 0,this.duration_),i.preventDefault(),e=!0}}return!e}}const Yu=zu;class ju extends Oi{constructor(t){t=t||{},super(t),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=t.maxDelta!==void 0?t.maxDelta:1,this.duration_=t.duration!==void 0?t.duration:250,this.timeout_=t.timeout!==void 0?t.timeout:80,this.useAnchor_=t.useAnchor!==void 0?t.useAnchor:!0,this.constrainResolution_=t.constrainResolution!==void 0?t.constrainResolution:!1;const e=t.condition?t.condition:xa;this.condition_=t.onFocusOnly?ws(pa,e):e,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const t=this.getMap();if(!t)return;t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)}handleEvent(t){if(!this.condition_(t)||t.type!==k.WHEEL)return!0;const i=t.map,n=t.originalEvent;n.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate);let r;if(t.type==k.WHEEL&&(r=n.deltaY,sl&&n.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(r/=xo),n.deltaMode===WheelEvent.DOM_DELTA_LINE&&(r*=40)),r===0)return!1;this.lastDelta_=r;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(r)<4?"trackpad":"wheel");const a=i.getView();if(this.mode_==="trackpad"&&!(a.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(a.getAnimating()&&a.cancelAnimations(),a.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),a.adjustZoom(-r/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=o,!1;this.totalDelta_+=r;const h=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),h),!1}handleWheelZoom_(t){const e=t.getView();e.getAnimating()&&e.cancelAnimations();let i=-J(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),fr(e,i,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}}const Bu=ju;class Ku extends ei{constructor(t){t=t||{};const e=t;e.stopDown||(e.stopDown=En),super(e),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=t.threshold!==void 0?t.threshold:.3,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){let e=0;const i=this.targetPointers[0],n=this.targetPointers[1],r=Math.atan2(n.clientY-i.clientY,n.clientX-i.clientX);if(this.lastAngle_!==void 0){const u=r-this.lastAngle_;this.rotationDelta_+=u,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=u}this.lastAngle_=r;const o=t.map,a=o.getView();if(a.getConstraints().rotation===ur)return;const h=o.getViewport().getBoundingClientRect(),c=gr(this.targetPointers);c[0]-=h.left,c[1]-=h.top,this.anchor_=o.getCoordinateFromPixelInternal(c),this.rotating_&&(o.render(),a.adjustRotationInternal(e,this.anchor_))}handleUpEvent(t){return this.targetPointers.length<2?(t.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}else return!1}}const Zu=Ku;class Vu extends ei{constructor(t){t=t||{};const e=t;e.stopDown||(e.stopDown=En),super(e),this.anchor_=null,this.duration_=t.duration!==void 0?t.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(t){let e=1;const i=this.targetPointers[0],n=this.targetPointers[1],r=i.clientX-n.clientX,o=i.clientY-n.clientY,a=Math.sqrt(r*r+o*o);this.lastDistance_!==void 0&&(e=this.lastDistance_/a),this.lastDistance_=a;const h=t.map,c=h.getView();e!=1&&(this.lastScaleDelta_=e);const u=h.getViewport().getBoundingClientRect(),d=gr(this.targetPointers);d[0]-=u.left,d[1]-=u.top,this.anchor_=h.getCoordinateFromPixelInternal(d),h.render(),c.adjustResolutionInternal(e,this.anchor_)}handleUpEvent(t){if(this.targetPointers.length<2){const i=t.map.getView(),n=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,n),!1}else return!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}else return!1}}const Uu=Vu;function Hu(s){s=s||{};const t=new ut,e=new Yc(-.005,.05,100);return(s.altShiftDragRotate!==void 0?s.altShiftDragRotate:!0)&&t.push(new Ou),(s.doubleClickZoom!==void 0?s.doubleClickZoom:!0)&&t.push(new Ru({delta:s.zoomDelta,duration:s.zoomDuration})),(s.dragPan!==void 0?s.dragPan:!0)&&t.push(new Pu({onFocusOnly:s.onFocusOnly,kinetic:e})),(s.pinchRotate!==void 0?s.pinchRotate:!0)&&t.push(new Zu),(s.pinchZoom!==void 0?s.pinchZoom:!0)&&t.push(new Uu({duration:s.zoomDuration})),(s.keyboard!==void 0?s.keyboard:!0)&&(t.push(new Wu),t.push(new Yu({delta:s.zoomDelta,duration:s.zoomDuration}))),(s.mouseWheelZoom!==void 0?s.mouseWheelZoom:!0)&&t.push(new Bu({onFocusOnly:s.onFocusOnly,duration:s.zoomDuration})),(s.shiftDragZoom!==void 0?s.shiftDragZoom:!0)&&t.push(new Gu({duration:s.zoomDuration})),t}function Ra(s){if(s instanceof On){s.setMapInternal(null);return}s instanceof kn&&s.getLayers().forEach(Ra)}function Ta(s,t){if(s instanceof On){s.setMapInternal(t);return}if(s instanceof kn){const e=s.getLayers().getArray();for(let i=0,n=e.length;i<n;++i)Ta(e[i],t)}}class $u extends Lt{constructor(t){super(),t=t||{},this.on,this.once,this.un;const e=qu(t);this.renderComplete_,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=t.maxTilesLoading!==void 0?t.maxTilesLoading:16,this.pixelRatio_=t.pixelRatio!==void 0?t.pixelRatio:xo,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Ot(),this.pixelToCoordinateTransform_=Ot(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=t.moveTolerance,this.keyboardEventTarget_=e.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.controls=e.controls||ya(),this.interactions=e.interactions||Hu({onFocusOnly:!0}),this.overlays_=e.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new eu(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(rt.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(rt.VIEW,this.handleViewChanged_),this.addChangeListener(rt.SIZE,this.handleSizeChanged_),this.addChangeListener(rt.TARGET,this.handleTargetChanged_),this.setProperties(e.values);const i=this;t.view&&!(t.view instanceof se)&&t.view.then(function(n){i.setView(new se(n))}),this.controls.addEventListener(gt.ADD,function(n){n.element.setMap(this)}.bind(this)),this.controls.addEventListener(gt.REMOVE,function(n){n.element.setMap(null)}.bind(this)),this.interactions.addEventListener(gt.ADD,function(n){n.element.setMap(this)}.bind(this)),this.interactions.addEventListener(gt.REMOVE,function(n){n.element.setMap(null)}.bind(this)),this.overlays_.addEventListener(gt.ADD,function(n){this.addOverlayInternal_(n.element)}.bind(this)),this.overlays_.addEventListener(gt.REMOVE,function(n){const r=n.element.getId();r!==void 0&&delete this.overlayIdIndex_[r.toString()],n.element.setMap(null)}.bind(this)),this.controls.forEach(function(n){n.setMap(this)}.bind(this)),this.interactions.forEach(function(n){n.setMap(this)}.bind(this)),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(t){this.getControls().push(t)}addInteraction(t){this.getInteractions().push(t)}addLayer(t){this.getLayerGroup().getLayers().push(t)}handleLayerAdd_(t){Ta(t.layer,this)}addOverlay(t){this.getOverlays().push(t)}addOverlayInternal_(t){const e=t.getId();e!==void 0&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(t,e,i){if(!this.frameState_||!this.renderer_)return;const n=this.getCoordinateFromPixelInternal(t);i=i!==void 0?i:{};const r=i.hitTolerance!==void 0?i.hitTolerance:0,o=i.layerFilter!==void 0?i.layerFilter:ve,a=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(n,this.frameState_,r,a,e,null,o,null)}getFeaturesAtPixel(t,e){const i=[];return this.forEachFeatureAtPixel(t,function(n){i.push(n)},e),i}getAllLayers(){const t=[];function e(i){i.forEach(function(n){n instanceof kn?e(n.getLayers()):t.push(n)})}return e(this.getLayers()),t}hasFeatureAtPixel(t,e){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(t);e=e!==void 0?e:{};const n=e.layerFilter!==void 0?e.layerFilter:ve,r=e.hitTolerance!==void 0?e.hitTolerance:0,o=e.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,r,o,n,null)}getEventCoordinate(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}getEventCoordinateInternal(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}getEventPixel(t){const e=this.viewport_.getBoundingClientRect(),i="changedTouches"in t?t.changedTouches[0]:t;return[i.clientX-e.left,i.clientY-e.top]}getTarget(){return this.get(rt.TARGET)}getTargetElement(){const t=this.getTarget();return t!==void 0?typeof t=="string"?document.getElementById(t):t:null}getCoordinateFromPixel(t){return ds(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}getCoordinateFromPixelInternal(t){const e=this.frameState_;return e?it(e.pixelToCoordinateTransform,t.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(t){const e=this.overlayIdIndex_[t.toString()];return e!==void 0?e:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(rt.LAYERGROUP)}setLayers(t){const e=this.getLayerGroup();if(t instanceof ut){e.setLayers(t);return}const i=e.getLayers();i.clear(),i.extend(t)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,i=t.length;e<i;++e){const n=t[e];if(!n.visible)continue;const r=n.layer.getRenderer();if(r&&!r.ready)return!0;const o=n.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(t){const e=Yt(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}getPixelFromCoordinateInternal(t){const e=this.frameState_;return e?it(e.coordinateToPixelTransform,t.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(rt.SIZE)}getView(){return this.get(rt.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const t=this.getTargetElement();return t?t.ownerDocument:document}getTilePriority(t,e,i,n){return iu(this.frameState_,t,e,i,n)}handleBrowserEvent(t,e){e=e||t.type;const i=new ie(e,this,t);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(t){if(!this.frameState_)return;const e=t.originalEvent,i=e.type;if(i===Es.POINTERDOWN||i===k.WHEEL||i===k.KEYDOWN){const n=this.getOwnerDocument(),r=this.viewport_.getRootNode?this.viewport_.getRootNode():n,o=e.target;if(this.overlayContainerStopEvent_.contains(o)||!(r===n?n.documentElement:r).contains(o))return}if(t.frameState=this.frameState_,this.dispatchEvent(t)!==!1){const n=this.getInteractions().getArray().slice();for(let r=n.length-1;r>=0;r--){const o=n[r];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(t)||t.propagationStopped)break}}}handlePostRender(){const t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){let n=this.maxTilesLoading_,r=n;if(t){const o=t.viewHints;if(o[ot.ANIMATING]||o[ot.INTERACTING]){const a=Date.now()-t.time>8;n=a?0:8,r=a?0:2}}e.getTilesLoading()<n&&(e.reprioritize(),e.loadMoreTiles(n,r))}t&&this.renderer_&&!t.animate&&(this.renderComplete_===!0?(this.hasListener(le.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(le.RENDERCOMPLETE,t),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Ke(Bt.LOADEND,this,t)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Ke(Bt.LOADSTART,this,t))));const i=this.postRenderFunctions_;for(let n=0,r=i.length;n<r;++n)i[n](this,t);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let e=0,i=this.targetChangeHandlerKeys_.length;e<i;++e)Z(this.targetChangeHandlerKeys_[e]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(k.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(k.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,cn(this.viewport_)}const t=this.getTargetElement();if(!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new Vc(this)),this.mapBrowserEventHandler_=new qc(this,this.moveTolerance_);for(const n in $)this.mapBrowserEventHandler_.addEventListener($[n],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(k.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(k.WHEEL,this.boundHandleBrowserEvent_,Eo?{passive:!1}:!1);const e=this.getOwnerDocument().defaultView,i=this.keyboardEventTarget_?this.keyboardEventTarget_:t;this.targetChangeHandlerKeys_=[W(i,k.KEYDOWN,this.handleBrowserEvent,this),W(i,k.KEYPRESS,this.handleBrowserEvent,this),W(e,k.RESIZE,this.updateSize,this)]}this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(Z(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Z(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const t=this.getView();t&&(this.updateViewportSize_(),this.viewPropertyListenerKey_=W(t,He.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=W(t,k.CHANGE,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Z),this.layerGroupPropertyListenerKeys_=null);const t=this.getLayerGroup();t&&(this.handleLayerAdd_(new ne("addlayer",t)),this.layerGroupPropertyListenerKeys_=[W(t,He.PROPERTYCHANGE,this.render,this),W(t,k.CHANGE,this.render,this),W(t,"addlayer",this.handleLayerAdd_,this),W(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,i=t.length;e<i;++e){const n=t[e].layer;n.hasRenderer()&&n.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(t){return this.getControls().remove(t)}removeInteraction(t){return this.getInteractions().remove(t)}removeLayer(t){return this.getLayerGroup().getLayers().remove(t)}handleLayerRemove_(t){Ra(t.layer)}removeOverlay(t){return this.getOverlays().remove(t)}renderFrame_(t){const e=this.getSize(),i=this.getView(),n=this.frameState_;let r=null;if(e!==void 0&&Wr(e)&&i&&i.isDef()){const o=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=i.getState();if(r={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:ls(a.center,a.resolution,a.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:a,viewHints:o,wantedTiles:{},mapId:z(this),renderTargets:{}},a.nextCenter&&a.nextResolution){const h=isNaN(a.nextRotation)?a.rotation:a.nextRotation;r.nextExtent=ls(a.nextCenter,a.nextResolution,h,e)}}this.frameState_=r,this.renderer_.renderFrame(r),r&&(r.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,r.postRenderFunctions),n&&(!this.previousExtent_||!Ns(this.previousExtent_)&&!fi(r.extent,this.previousExtent_))&&(this.dispatchEvent(new Ke(Bt.MOVESTART,this,n)),this.previousExtent_=Li(this.previousExtent_)),this.previousExtent_&&!r.viewHints[ot.ANIMATING]&&!r.viewHints[ot.INTERACTING]&&!fi(r.extent,this.previousExtent_)&&(this.dispatchEvent(new Ke(Bt.MOVEEND,this,r)),wo(r.extent,this.previousExtent_))),this.dispatchEvent(new Ke(Bt.POSTRENDER,this,r)),this.renderComplete_=this.hasListener(Bt.LOADSTART)||this.hasListener(Bt.LOADEND)||this.hasListener(le.RENDERCOMPLETE)?!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady():void 0,this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(t){const e=this.getLayerGroup();e&&this.handleLayerRemove_(new ne("removelayer",e)),this.set(rt.LAYERGROUP,t)}setSize(t){this.set(rt.SIZE,t)}setTarget(t){this.set(rt.TARGET,t)}setView(t){if(!t||t instanceof se){this.set(rt.VIEW,t);return}this.set(rt.VIEW,new se);const e=this;t.then(function(i){e.setView(new se(i))})}updateSize(){const t=this.getTargetElement();let e;if(t){const i=getComputedStyle(t),n=t.offsetWidth-parseFloat(i.borderLeftWidth)-parseFloat(i.paddingLeft)-parseFloat(i.paddingRight)-parseFloat(i.borderRightWidth),r=t.offsetHeight-parseFloat(i.borderTopWidth)-parseFloat(i.paddingTop)-parseFloat(i.paddingBottom)-parseFloat(i.borderBottomWidth);!isNaN(n)&&!isNaN(r)&&(e=[n,r],!Wr(e)&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&console.warn("No map visible because the map container's width or height are 0."))}this.setSize(e),this.updateViewportSize_()}updateViewportSize_(){const t=this.getView();if(t){let e;const i=getComputedStyle(this.viewport_);i.width&&i.height&&(e=[parseInt(i.width,10),parseInt(i.height,10)]),t.setViewportSize(e)}}}function qu(s){let t=null;s.keyboardEventTarget!==void 0&&(t=typeof s.keyboardEventTarget=="string"?document.getElementById(s.keyboardEventTarget):s.keyboardEventTarget);const e={},i=s.layers&&typeof s.layers.getLayers=="function"?s.layers:new kn({layers:s.layers});e[rt.LAYERGROUP]=i,e[rt.TARGET]=s.target,e[rt.VIEW]=s.view instanceof se?s.view:new se;let n;s.controls!==void 0&&(Array.isArray(s.controls)?n=new ut(s.controls.slice()):(X(typeof s.controls.getArray=="function",47),n=s.controls));let r;s.interactions!==void 0&&(Array.isArray(s.interactions)?r=new ut(s.interactions.slice()):(X(typeof s.interactions.getArray=="function",48),r=s.interactions));let o;return s.overlays!==void 0?Array.isArray(s.overlays)?o=new ut(s.overlays.slice()):(X(typeof s.overlays.getArray=="function",49),o=s.overlays):o=new ut,{controls:n,interactions:r,keyboardEventTarget:t,overlays:o,values:e}}const Ju=$u,st={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"};class Qu extends Lt{constructor(t){super(),this.on,this.once,this.un,this.options=t,this.id=t.id,this.insertFirst=t.insertFirst!==void 0?t.insertFirst:!0,this.stopEvent=t.stopEvent!==void 0?t.stopEvent:!0,this.element=document.createElement("div"),this.element.className=t.className!==void 0?t.className:"ol-overlay-container "+ph,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.autoPan=t.autoPan===!0?{}:t.autoPan||void 0,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener(st.ELEMENT,this.handleElementChanged),this.addChangeListener(st.MAP,this.handleMapChanged),this.addChangeListener(st.OFFSET,this.handleOffsetChanged),this.addChangeListener(st.POSITION,this.handlePositionChanged),this.addChangeListener(st.POSITIONING,this.handlePositioningChanged),t.element!==void 0&&this.setElement(t.element),this.setOffset(t.offset!==void 0?t.offset:[0,0]),this.setPositioning(t.positioning||"top-left"),t.position!==void 0&&this.setPosition(t.position)}getElement(){return this.get(st.ELEMENT)}getId(){return this.id}getMap(){return this.get(st.MAP)||null}getOffset(){return this.get(st.OFFSET)}getPosition(){return this.get(st.POSITION)}getPositioning(){return this.get(st.POSITIONING)}handleElementChanged(){Jo(this.element);const t=this.getElement();t&&this.element.appendChild(t)}handleMapChanged(){this.mapPostrenderListenerKey&&(cn(this.element),Z(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);const t=this.getMap();if(t){this.mapPostrenderListenerKey=W(t,Bt.POSTRENDER,this.render,this),this.updatePixelPosition();const e=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();this.insertFirst?e.insertBefore(this.element,e.childNodes[0]||null):e.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(t){this.set(st.ELEMENT,t)}setMap(t){this.set(st.MAP,t)}setOffset(t){this.set(st.OFFSET,t)}setPosition(t){this.set(st.POSITION,t)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(t){const e=this.getMap();if(!e||!e.getTargetElement()||!this.get(st.POSITION))return;const i=this.getRect(e.getTargetElement(),e.getSize()),n=this.getElement(),r=this.getRect(n,[mh(n),_h(n)]);t=t||{};const o=t.margin===void 0?20:t.margin;if(!ye(i,r)){const a=r[0]-i[0],h=i[2]-r[2],c=r[1]-i[1],u=i[3]-r[3],d=[0,0];if(a<0?d[0]=a-o:h<0&&(d[0]=Math.abs(h)+o),c<0?d[1]=c-o:u<0&&(d[1]=Math.abs(u)+o),d[0]!==0||d[1]!==0){const f=e.getView().getCenterInternal(),g=e.getPixelFromCoordinateInternal(f);if(!g)return;const m=[g[0]+d[0],g[1]+d[1]],_=t.animation||{};e.getView().animateInternal({center:e.getCoordinateFromPixelInternal(m),duration:_.duration,easing:_.easing})}}}getRect(t,e){const i=t.getBoundingClientRect(),n=i.left+window.pageXOffset,r=i.top+window.pageYOffset;return[n,r,n+e[0],r+e[1]]}setPositioning(t){this.set(st.POSITIONING,t)}setVisible(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)}updatePixelPosition(){const t=this.getMap(),e=this.getPosition();if(!t||!t.isRendered()||!e){this.setVisible(!1);return}const i=t.getPixelFromCoordinate(e),n=t.getSize();this.updateRenderedPosition(i,n)}updateRenderedPosition(t,e){const i=this.element.style,n=this.getOffset(),r=this.getPositioning();this.setVisible(!0);const o=Math.round(t[0]+n[0])+"px",a=Math.round(t[1]+n[1])+"px";let h="0%",c="0%";r=="bottom-right"||r=="center-right"||r=="top-right"?h="-100%":(r=="bottom-center"||r=="center-center"||r=="top-center")&&(h="-50%"),r=="bottom-left"||r=="bottom-center"||r=="bottom-right"?c="-100%":(r=="center-left"||r=="center-center"||r=="center-right")&&(c="-50%");const u=`translate(${h}, ${c}) translate(${o}, ${a})`;this.rendered.transform_!=u&&(this.rendered.transform_=u,i.transform=u)}getOptions(){return this.options}}const td=Qu;class ed{constructor(t){this.highWaterMark=t!==void 0?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();)this.pop()}clear(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){const i=this.entries_[t];return X(i!==void 0,15),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(t){const e=this.entries_[t];return X(e!==void 0,15),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){const t=new Array(this.count_);let e=0,i;for(i=this.newest_;i;i=i.older)t[e++]=i.key_;return t}getValues(){const t=new Array(this.count_);let e=0,i;for(i=this.newest_;i;i=i.older)t[e++]=i.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){if(this.containsKey(t))return this.entries_[t].value_}pop(){const t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){X(!(t in this.entries_),16);const i={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[t]=i,++this.count_}setSize(t){this.highWaterMark=t}}const id=ed;function uo(s,t,e,i){return i!==void 0?(i[0]=s,i[1]=t,i[2]=e,i):[s,t,e]}function Dn(s,t,e){return s+"/"+t+"/"+e}function va(s){return Dn(s[0],s[1],s[2])}function nd(s){return s.split("/").map(Number)}function sd(s){return(s[1]<<s[0])+s[2]}function rd(s,t){const e=s[0],i=s[1],n=s[2];if(t.getMinZoom()>e||e>t.getMaxZoom())return!1;const r=t.getFullTileRange(e);return r?r.containsXY(i,n):!0}class od extends id{clear(){for(;this.getCount()>0;)this.pop().release();super.clear()}expireCache(t){for(;this.canExpireCache()&&!(this.peekLast().getKey()in t);)this.pop().release()}pruneExceptNewestZ(){if(this.getCount()===0)return;const t=this.peekFirstKey(),i=nd(t)[0];this.forEach(function(n){n.tileCoord[0]!==i&&(this.remove(va(n.tileCoord)),n.release())}.bind(this))}}const Ia=od;class Sa{constructor(t,e,i,n){this.minX=t,this.maxX=e,this.minY=i,this.maxY=n}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}function ze(s,t,e,i,n){return n!==void 0?(n.minX=s,n.maxX=t,n.minY=e,n.maxY=i,n):new Sa(s,t,e,i)}const La=Sa;class yn extends Ae{constructor(t,e,i){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(t[0]))this.setCoordinates(t,e);else if(e!==void 0&&i)this.setFlatCoordinates(e,t),this.ends_=i;else{let n=this.getLayout();const r=t,o=[],a=[];for(let h=0,c=r.length;h<c;++h){const u=r[h];h===0&&(n=u.getLayout()),Zt(o,u.getFlatCoordinates()),a.push(o.length)}this.setFlatCoordinates(n,o),this.ends_=a}}appendLineString(t){this.flatCoordinates?Zt(this.flatCoordinates,t.getFlatCoordinates().slice()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new yn(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<Me(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(js(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ks(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,i,n))}getCoordinateAtM(t,e,i){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(e=e!==void 0?e:!1,i=i!==void 0?i:!1,lh(this.flatCoordinates,0,this.ends_,this.stride,t,e,i))}getCoordinates(){return mi(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(t){return t<0||this.ends_.length<=t?null:new _s(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLineStrings(){const t=this.flatCoordinates,e=this.ends_,i=this.layout,n=[];let r=0;for(let o=0,a=e.length;o<a;++o){const h=e[o],c=new _s(t.slice(r,h),i);n.push(c),r=h}return n}getFlatMidpoints(){const t=[],e=this.flatCoordinates;let i=0;const n=this.ends_,r=this.stride;for(let o=0,a=n.length;o<a;++o){const h=n[o],c=Zo(e,i,h,r,.5);Zt(t,c),i=h}return t}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=ql(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,i),new yn(e,"XY",i)}getType(){return"MultiLineString"}intersectsExtent(t){return sh(this.flatCoordinates,0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=Zs(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}const ad=yn;class mr extends Ae{constructor(t,e){super(),e&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendPoint(t){this.flatCoordinates?Zt(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.changed()}clone(){const t=new mr(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){if(n<Me(this.getExtent(),t,e))return n;const r=this.flatCoordinates,o=this.stride;for(let a=0,h=r.length;a<h;a+=o){const c=we(t,e,r[a],r[a+1]);if(c<n){n=c;for(let u=0;u<o;++u)i[u]=r[a+u];i.length=o}}return n}getCoordinates(){return re(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(t){const e=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;return t<0||e<=t?null:new qe(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)}getPoints(){const t=this.flatCoordinates,e=this.layout,i=this.stride,n=[];for(let r=0,o=t.length;r<o;r+=i){const a=new qe(t.slice(r,r+i),e);n.push(a)}return n}getType(){return"MultiPoint"}intersectsExtent(t){const e=this.flatCoordinates,i=this.stride;for(let n=0,r=e.length;n<r;n+=i){const o=e[n],a=e[n+1];if(Ds(t,o,a))return!0}return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Ln(this.flatCoordinates,0,t,this.stride),this.changed()}}const Ma=mr;function ld(s,t,e,i){const n=[];let r=Rt();for(let o=0,a=e.length;o<a;++o){const h=e[o];r=Ro(s,t,h[0],i),n.push((r[0]+r[2])/2,(r[1]+r[3])/2),t=h[h.length-1]}return n}class pn extends Ae{constructor(t,e,i){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!i&&!Array.isArray(t[0])){let n=this.getLayout();const r=t,o=[],a=[];for(let h=0,c=r.length;h<c;++h){const u=r[h];h===0&&(n=u.getLayout());const d=o.length,f=u.getEnds();for(let g=0,m=f.length;g<m;++g)f[g]+=d;Zt(o,u.getFlatCoordinates()),a.push(f)}e=n,t=o,i=a}e!==void 0&&i?(this.setFlatCoordinates(e,t),this.endss_=i):this.setCoordinates(t,e)}appendPolygon(t){let e;if(!this.flatCoordinates)this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();else{const i=this.flatCoordinates.length;Zt(this.flatCoordinates,t.getFlatCoordinates()),e=t.getEnds().slice();for(let n=0,r=e.length;n<r;++n)e[n]+=i}this.endss_.push(e),this.changed()}clone(){const t=this.endss_.length,e=new Array(t);for(let n=0;n<t;++n)e[n]=this.endss_[n].slice();const i=new pn(this.flatCoordinates.slice(),this.layout,e);return i.applyProperties(this),i}closestPointXY(t,e,i,n){return n<Me(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Vl(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ul(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,i,n))}containsXY(t,e){return ih(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)}getArea(){return th(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),Gr(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,fs(e,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const t=ld(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=nh(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new Ma(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;ah(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Gr(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=Ql(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,i),new pn(e,"XY",i)}getPolygon(t){if(t<0||this.endss_.length<=t)return null;let e;if(t===0)e=0;else{const r=this.endss_[t-1];e=r[r.length-1]}const i=this.endss_[t].slice(),n=i[i.length-1];if(e!==0)for(let r=0,o=i.length;r<o;++r)i[r]-=e;return new an(this.flatCoordinates.slice(e,n),this.layout,i)}getPolygons(){const t=this.layout,e=this.flatCoordinates,i=this.endss_,n=[];let r=0;for(let o=0,a=i.length;o<a;++o){const h=i[o].slice(),c=h[h.length-1];if(r!==0)for(let d=0,f=h.length;d<f;++d)h[d]-=r;const u=new an(e.slice(r,c),t,h);n.push(u),r=c}return n}getType(){return"MultiPolygon"}intersectsExtent(t){return rh(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);const i=$l(this.flatCoordinates,0,t,this.stride,this.endss_);if(i.length===0)this.flatCoordinates.length=0;else{const n=i[i.length-1];this.flatCoordinates.length=n.length===0?0:n[n.length-1]}this.changed()}}const hd=pn;class cd{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.supportedMediaTypes=null}getReadOptions(t,e){if(e){let i=e.dataProjection?q(e.dataProjection):this.readProjection(t);e.extent&&i&&i.getUnits()==="tile-pixels"&&(i=q(i),i.setWorldExtent(e.extent)),e={dataProjection:i,featureProjection:e.featureProjection}}return this.adaptOptions(e)}adaptOptions(t){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection},t)}getType(){return b()}readFeature(t,e){return b()}readFeatures(t,e){return b()}readGeometry(t,e){return b()}readProjection(t){return b()}writeFeature(t,e){return b()}writeFeatures(t,e){return b()}writeGeometry(t,e){return b()}}function Pa(s,t,e){const i=e?q(e.featureProjection):null,n=e?q(e.dataProjection):null;let r;if(i&&n&&!me(i,n)?r=(t?s.clone():s).transform(t?i:n,t?n:i):r=s,t&&e&&e.decimals!==void 0){const o=Math.pow(10,e.decimals),a=function(h){for(let c=0,u=h.length;c<u;++c)h[c]=Math.round(h[c]*o)/o;return h};r===s&&(r=s.clone()),r.applyTransform(a)}return r}const qi={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class ud extends On{constructor(t){t=t||{};const e=Object.assign({},t);delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.setPreload(t.preload!==void 0?t.preload:0),this.setUseInterimTilesOnError(t.useInterimTilesOnError!==void 0?t.useInterimTilesOnError:!0)}getPreload(){return this.get(qi.PRELOAD)}setPreload(t){this.set(qi.PRELOAD,t)}getUseInterimTilesOnError(){return this.get(qi.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(t){this.set(qi.USE_INTERIM_TILES_ON_ERROR,t)}getData(t){return super.getData(t)}}const dd=ud,fd=.5,gd=10,fo=.25;class md{constructor(t,e,i,n,r,o){this.sourceProj_=t,this.targetProj_=e;let a={};const h=rn(this.targetProj_,this.sourceProj_);this.transformInv_=function(l){const y=l[0]+"/"+l[1];return a[y]||(a[y]=h(l)),a[y]},this.maxSourceExtent_=n,this.errorThresholdSquared_=r*r,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!n&&!!this.sourceProj_.getExtent()&&V(n)==V(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?V(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?V(this.targetProj_.getExtent()):null;const c=Pe(i),u=In(i),d=vn(i),f=Tn(i),g=this.transformInv_(c),m=this.transformInv_(u),_=this.transformInv_(d),p=this.transformInv_(f),x=gd+(o?Math.max(0,Math.ceil(Math.log2(as(i)/(o*o*256*256)))):0);if(this.addQuad_(c,u,d,f,g,m,_,p,x),this.wrapsXInSource_){let l=1/0;this.triangles_.forEach(function(y,E,C){l=Math.min(l,y.source[0][0],y.source[1][0],y.source[2][0])}),this.triangles_.forEach(function(y){if(Math.max(y.source[0][0],y.source[1][0],y.source[2][0])-l>this.sourceWorldWidth_/2){const E=[[y.source[0][0],y.source[0][1]],[y.source[1][0],y.source[1][1]],[y.source[2][0],y.source[2][1]]];E[0][0]-l>this.sourceWorldWidth_/2&&(E[0][0]-=this.sourceWorldWidth_),E[1][0]-l>this.sourceWorldWidth_/2&&(E[1][0]-=this.sourceWorldWidth_),E[2][0]-l>this.sourceWorldWidth_/2&&(E[2][0]-=this.sourceWorldWidth_);const C=Math.min(E[0][0],E[1][0],E[2][0]);Math.max(E[0][0],E[1][0],E[2][0])-C<this.sourceWorldWidth_/2&&(y.source=E)}}.bind(this))}a={}}addTriangle_(t,e,i,n,r,o){this.triangles_.push({source:[n,r,o],target:[t,e,i]})}addQuad_(t,e,i,n,r,o,a,h,c){const u=Sr([r,o,a,h]),d=this.sourceWorldWidth_?V(u)/this.sourceWorldWidth_:null,f=this.sourceWorldWidth_,g=this.sourceProj_.canWrapX()&&d>.5&&d<1;let m=!1;if(c>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const p=Sr([t,e,i,n]);m=V(p)/this.targetWorldWidth_>fo||m}!g&&this.sourceProj_.isGlobal()&&d&&(m=d>fo||m)}if(!m&&this.maxSourceExtent_&&isFinite(u[0])&&isFinite(u[1])&&isFinite(u[2])&&isFinite(u[3])&&!ct(u,this.maxSourceExtent_))return;let _=0;if(!m&&(!isFinite(r[0])||!isFinite(r[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(h[0])||!isFinite(h[1]))){if(c>0)m=!0;else if(_=(!isFinite(r[0])||!isFinite(r[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(h[0])||!isFinite(h[1])?1:0),_!=1&&_!=2&&_!=4&&_!=8)return}if(c>0){if(!m){const p=[(t[0]+i[0])/2,(t[1]+i[1])/2],x=this.transformInv_(p);let l;g?l=(Ue(r[0],f)+Ue(a[0],f))/2-Ue(x[0],f):l=(r[0]+a[0])/2-x[0];const y=(r[1]+a[1])/2-x[1];m=l*l+y*y>this.errorThresholdSquared_}if(m){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){const p=[(e[0]+i[0])/2,(e[1]+i[1])/2],x=this.transformInv_(p),l=[(n[0]+t[0])/2,(n[1]+t[1])/2],y=this.transformInv_(l);this.addQuad_(t,e,p,l,r,o,x,y,c-1),this.addQuad_(l,p,i,n,y,x,a,h,c-1)}else{const p=[(t[0]+e[0])/2,(t[1]+e[1])/2],x=this.transformInv_(p),l=[(i[0]+n[0])/2,(i[1]+n[1])/2],y=this.transformInv_(l);this.addQuad_(t,p,l,n,r,x,y,h,c-1),this.addQuad_(p,e,i,l,x,o,a,y,c-1)}return}}if(g){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}_&11||this.addTriangle_(t,i,n,r,a,h),_&14||this.addTriangle_(t,i,e,r,a,o),_&&(_&13||this.addTriangle_(e,n,t,o,h,r),_&7||this.addTriangle_(e,n,i,o,h,a))}calculateSourceExtent(){const t=Rt();return this.triangles_.forEach(function(e,i,n){const r=e.source;ci(t,r[0]),ci(t,r[1]),ci(t,r[2])}),t}getTriangles(){return this.triangles_}}const _d=md;let es;const Aa=[];function go(s,t,e,i,n){s.beginPath(),s.moveTo(0,0),s.lineTo(t,e),s.lineTo(i,n),s.closePath(),s.save(),s.clip(),s.fillRect(0,0,Math.max(t,i)+1,Math.max(e,n)),s.restore()}function is(s,t){return Math.abs(s[t*4]-210)>2||Math.abs(s[t*4+3]-.75*255)>2}function yd(){if(es===void 0){const s=document.createElement("canvas").getContext("2d");s.globalCompositeOperation="lighter",s.fillStyle="rgba(210, 0, 0, 0.75)",go(s,4,5,4,0),go(s,4,5,0,5);const t=s.getImageData(0,0,3,3).data;es=is(t,0)||is(t,4)||is(t,8)}return es}function mo(s,t,e,i){const n=bo(e,t,s);let r=Or(t,i,e);const o=t.getMetersPerUnit();o!==void 0&&(r*=o);const a=s.getMetersPerUnit();a!==void 0&&(r/=a);const h=s.getExtent();if(!h||Rn(h,n)){const c=Or(s,r,n)/r;isFinite(c)&&c>0&&(r/=c)}return r}function pd(s,t,e,i){const n=Se(e);let r=mo(s,t,n,i);return(!isFinite(r)||r<=0)&&Io(e,function(o){return r=mo(s,t,o,i),isFinite(r)&&r>0}),r}function xd(s,t,e,i,n,r,o,a,h,c,u,d){const f=xt(Math.round(e*s),Math.round(e*t),Aa);if(d||(f.imageSmoothingEnabled=!1),h.length===0)return f.canvas;f.scale(e,e);function g(E){return Math.round(E*e)/e}f.globalCompositeOperation="lighter";const m=Rt();h.forEach(function(E,C,w){To(m,E.extent)});const _=V(m),p=Ft(m),x=xt(Math.round(e*_/i),Math.round(e*p/i));d||(x.imageSmoothingEnabled=!1);const l=e/i;h.forEach(function(E,C,w){const v=E.extent[0]-m[0],I=-(E.extent[3]-m[3]),S=V(E.extent),A=Ft(E.extent);E.image.width>0&&E.image.height>0&&x.drawImage(E.image,c,c,E.image.width-2*c,E.image.height-2*c,v*l,I*l,S*l,A*l)});const y=Pe(o);return a.getTriangles().forEach(function(E,C,w){const v=E.source,I=E.target;let S=v[0][0],A=v[0][1],G=v[1][0],N=v[1][1],D=v[2][0],U=v[2][1];const L=g((I[0][0]-y[0])/r),M=g(-(I[0][1]-y[1])/r),T=g((I[1][0]-y[0])/r),F=g(-(I[1][1]-y[1])/r),H=g((I[2][0]-y[0])/r),K=g(-(I[2][1]-y[1])/r),tt=S,R=A;S=0,A=0,G-=tt,N-=R,D-=tt,U-=R;const mt=[[G,N,0,0,T-L],[D,U,0,0,H-L],[0,0,G,N,F-M],[0,0,D,U,K-M]],Y=Ol(mt);if(Y){if(f.save(),f.beginPath(),yd()||!d){f.moveTo(T,F);const B=4,Ut=L-T,Mt=M-F;for(let nt=0;nt<B;nt++)f.lineTo(T+g((nt+1)*Ut/B),F+g(nt*Mt/(B-1))),nt!=B-1&&f.lineTo(T+g((nt+1)*Ut/B),F+g((nt+1)*Mt/(B-1)));f.lineTo(H,K)}else f.moveTo(T,F),f.lineTo(L,M),f.lineTo(H,K);f.clip(),f.transform(Y[0],Y[2],Y[1],Y[3],L,M),f.translate(m[0]-tt,m[3]-R),f.scale(i/e,-i/e),f.drawImage(x.canvas,0,0),f.restore()}}),u&&(f.save(),f.globalCompositeOperation="source-over",f.strokeStyle="black",f.lineWidth=1,a.getTriangles().forEach(function(E,C,w){const v=E.target,I=(v[0][0]-y[0])/r,S=-(v[0][1]-y[1])/r,A=(v[1][0]-y[0])/r,G=-(v[1][1]-y[1])/r,N=(v[2][0]-y[0])/r,D=-(v[2][1]-y[1])/r;f.beginPath(),f.moveTo(A,G),f.lineTo(I,S),f.lineTo(N,D),f.closePath(),f.stroke()}),f.restore()),f.canvas}class Ed extends ga{constructor(t,e,i,n,r,o,a,h,c,u,d,f){super(r,P.IDLE,{interpolate:!!f}),this.renderEdges_=d!==void 0?d:!1,this.pixelRatio_=a,this.gutter_=h,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=n,this.wrappedTileCoord_=o||r,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const g=n.getTileCoordExtent(this.wrappedTileCoord_),m=this.targetTileGrid_.getExtent();let _=this.sourceTileGrid_.getExtent();const p=m?ui(g,m):g;if(as(p)===0){this.state=P.EMPTY;return}const x=t.getExtent();x&&(_?_=ui(_,x):_=x);const l=n.getResolution(this.wrappedTileCoord_[0]),y=pd(t,i,p,l);if(!isFinite(y)||y<=0){this.state=P.EMPTY;return}const E=u!==void 0?u:fd;if(this.triangulation_=new _d(t,i,p,_,y*E,l),this.triangulation_.getTriangles().length===0){this.state=P.EMPTY;return}this.sourceZ_=e.getZForResolution(y);let C=this.triangulation_.calculateSourceExtent();if(_&&(t.canWrapX()?(C[1]=J(C[1],_[1],_[3]),C[3]=J(C[3],_[1],_[3])):C=ui(C,_)),!as(C))this.state=P.EMPTY;else{const w=e.getTileRangeForExtentAndZ(C,this.sourceZ_);for(let v=w.minX;v<=w.maxX;v++)for(let I=w.minY;I<=w.maxY;I++){const S=c(this.sourceZ_,v,I,a);S&&this.sourceTiles_.push(S)}this.sourceTiles_.length===0&&(this.state=P.EMPTY)}}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach(function(e,i,n){e&&e.getState()==P.LOADED&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})}.bind(this)),this.sourceTiles_.length=0,t.length===0)this.state=P.ERROR;else{const e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),n=typeof i=="number"?i:i[0],r=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(e),a=this.sourceTileGrid_.getResolution(this.sourceZ_),h=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=xd(n,r,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,h,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=P.LOADED}this.changed()}load(){if(this.state==P.IDLE){this.state=P.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(e,i,n){const r=e.getState();if(r==P.IDLE||r==P.LOADING){t++;const o=W(e,k.CHANGE,function(a){const h=e.getState();(h==P.LOADED||h==P.ERROR||h==P.EMPTY)&&(Z(o),t--,t===0&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(o)}}.bind(this)),t===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function(e,i,n){e.getState()==P.IDLE&&e.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(Z),this.sourcesListenerKeys_=null}release(){this.canvas_&&(qo(this.canvas_.getContext("2d")),Aa.push(this.canvas_),this.canvas_=null),super.release()}}const Rs=Ed;class Cd extends ha{constructor(t){super(t),this.extentChanged=!0,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision,this.renderedTiles=[],this.newTiles_=!1,this.tmpExtent=Rt(),this.tmpTileRange_=new La(0,0,0,0)}isDrawableTile(t){const e=this.getLayer(),i=t.getState(),n=e.getUseInterimTilesOnError();return i==P.LOADED||i==P.EMPTY||i==P.ERROR&&!n}getTile(t,e,i,n){const r=n.pixelRatio,o=n.viewState.projection,a=this.getLayer();let c=a.getSource().getTile(t,e,i,r,o);return c.getState()==P.ERROR&&a.getUseInterimTilesOnError()&&a.getPreload()>0&&(this.newTiles_=!0),this.isDrawableTile(c)||(c=c.getInterimTile()),c}getData(t){const e=this.frameState;if(!e)return null;const i=this.getLayer(),n=it(e.pixelToCoordinateTransform,t.slice()),r=i.getExtent();if(r&&!Rn(r,n))return null;const o=e.pixelRatio,a=e.viewState.projection,h=e.viewState,c=i.getRenderSource(),u=c.getTileGridForProjection(h.projection),d=c.getTilePixelRatio(e.pixelRatio);for(let f=u.getZForResolution(h.resolution);f>=u.getMinZoom();--f){const g=u.getTileCoordForCoordAndZ(n,f),m=c.getTile(f,g[1],g[2],o,a);if(!(m instanceof ma||m instanceof Rs)||m instanceof Rs&&m.getState()===P.EMPTY)return null;if(m.getState()!==P.LOADED)continue;const _=u.getOrigin(f),p=pt(u.getTileSize(f)),x=u.getResolution(f),l=Math.floor(d*((n[0]-_[0])/x-g[1]*p[0])),y=Math.floor(d*((_[1]-n[1])/x-g[2]*p[1])),E=Math.round(d*c.getGutterForProjection(h.projection));return this.getImageData(m.getImage(),l+E,y+E)}return null}loadedTileCallback(t,e,i){return this.isDrawableTile(i)?super.loadedTileCallback(t,e,i):!1}prepareFrame(t){return!!this.getLayer().getSource()}renderFrame(t,e){const i=t.layerStatesArray[t.layerIndex],n=t.viewState,r=n.projection,o=n.resolution,a=n.center,h=n.rotation,c=t.pixelRatio,u=this.getLayer(),d=u.getSource(),f=d.getRevision(),g=d.getTileGridForProjection(r),m=g.getZForResolution(o,d.zDirection),_=g.getResolution(m);let p=t.extent;const x=t.viewState.resolution,l=d.getTilePixelRatio(c),y=Math.round(V(p)/x*c),E=Math.round(Ft(p)/x*c),C=i.extent&&pe(i.extent);C&&(p=ui(p,pe(i.extent)));const w=_*y/2/l,v=_*E/2/l,I=[a[0]-w,a[1]-v,a[0]+w,a[1]+v],S=g.getTileRangeForExtentAndZ(p,m),A={};A[m]={};const G=this.createLoadedTileFinder(d,r,A),N=this.tmpExtent,D=this.tmpTileRange_;this.newTiles_=!1;const U=h?hs(n.center,x,h,t.size):void 0;for(let mt=S.minX;mt<=S.maxX;++mt)for(let Y=S.minY;Y<=S.maxY;++Y){if(h&&!g.tileCoordIntersectsViewport([m,mt,Y],U))continue;const B=this.getTile(m,mt,Y,t);if(this.isDrawableTile(B)){const nt=z(this);if(B.getState()==P.LOADED){A[m][B.tileCoord.toString()]=B;let Dt=B.inTransition(nt);Dt&&i.opacity!==1&&(B.endTransition(nt),Dt=!1),!this.newTiles_&&(Dt||!this.renderedTiles.includes(B))&&(this.newTiles_=!0)}if(B.getAlpha(nt,t.time)===1)continue}const Ut=g.getTileCoordChildTileRange(B.tileCoord,D,N);let Mt=!1;Ut&&(Mt=G(m+1,Ut)),Mt||g.forEachTileCoordParentTileRange(B.tileCoord,G,D,N)}const L=_/o*c/l;ce(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/c,1/c,h,-y/2,-E/2);const M=Co(this.pixelTransform);this.useContainer(e,M,this.getBackground(t));const T=this.context,F=T.canvas;Fs(this.inversePixelTransform,this.pixelTransform),ce(this.tempTransform,y/2,E/2,L,L,0,-y/2,-E/2),F.width!=y||F.height!=E?(F.width=y,F.height=E):this.containerReused||T.clearRect(0,0,y,E),C&&this.clipUnrotated(T,t,C),d.getInterpolate()||(T.imageSmoothingEnabled=!1),this.preRender(T,t),this.renderedTiles.length=0;let H=Object.keys(A).map(Number);H.sort(Te);let K,tt,R;i.opacity===1&&(!this.containerReused||d.getOpaque(t.viewState.projection))?H=H.reverse():(K=[],tt=[]);for(let mt=H.length-1;mt>=0;--mt){const Y=H[mt],B=d.getTilePixelSize(Y,c,r),Mt=g.getResolution(Y)/_,nt=B[0]*Mt*L,Dt=B[1]*Mt*L,Oe=g.getTileCoordForCoordAndZ(Pe(I),Y),bi=g.getTileCoordExtent(Oe),be=it(this.tempTransform,[l*(bi[0]-I[0])/_,l*(I[3]-bi[3])/_]),Fi=l*d.getGutterForProjection(r),Ht=A[Y];for(const ii in Ht){const $t=Ht[ii],ki=$t.tileCoord,Di=Oe[1]-ki[1],Ni=Math.round(be[0]-(Di-1)*nt),Fe=Oe[2]-ki[2],zn=Math.round(be[1]-(Fe-1)*Dt),dt=Math.round(be[0]-Di*nt),Et=Math.round(be[1]-Fe*Dt),Tt=Ni-dt,Nt=zn-Et,ke=m===Y,ue=ke&&$t.getAlpha(z(this),t.time)!==1;let qt=!1;if(!ue)if(K){R=[dt,Et,dt+Tt,Et,dt+Tt,Et+Nt,dt,Et+Nt];for(let De=0,Gi=K.length;De<Gi;++De)if(m!==Y&&Y<tt[De]){const at=K[De];ct([dt,Et,dt+Tt,Et+Nt],[at[0],at[3],at[4],at[7]])&&(qt||(T.save(),qt=!0),T.beginPath(),T.moveTo(R[0],R[1]),T.lineTo(R[2],R[3]),T.lineTo(R[4],R[5]),T.lineTo(R[6],R[7]),T.moveTo(at[6],at[7]),T.lineTo(at[4],at[5]),T.lineTo(at[2],at[3]),T.lineTo(at[0],at[1]),T.clip())}K.push(R),tt.push(Y)}else T.clearRect(dt,Et,Tt,Nt);this.drawTileImage($t,t,dt,Et,Tt,Nt,Fi,ke),K&&!ue?(qt&&T.restore(),this.renderedTiles.unshift($t)):this.renderedTiles.push($t),this.updateUsedTiles(t.usedTiles,d,$t)}}return this.renderedRevision=f,this.renderedResolution=_,this.extentChanged=!this.renderedExtent_||!fi(this.renderedExtent_,I),this.renderedExtent_=I,this.renderedPixelRatio=c,this.renderedProjection=r,this.manageTilePyramid(t,d,g,c,r,p,m,u.getPreload()),this.scheduleExpireCache(t,d),this.postRender(T,t),i.extent&&T.restore(),T.imageSmoothingEnabled=!0,M!==F.style.transform&&(F.style.transform=M),this.container}drawTileImage(t,e,i,n,r,o,a,h){const c=this.getTileImage(t);if(!c)return;const u=z(this),d=e.layerStatesArray[e.layerIndex],f=d.opacity*(h?t.getAlpha(u,e.time):1),g=f!==this.context.globalAlpha;g&&(this.context.save(),this.context.globalAlpha=f),this.context.drawImage(c,a,a,c.width-2*a,c.height-2*a,i,n,r,o),g&&this.context.restore(),f!==d.opacity?e.animate=!0:h&&t.endTransition(u)}getImage(){const t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}scheduleExpireCache(t,e){if(e.canExpireCache()){const i=function(n,r,o){const a=z(n);a in o.usedTiles&&n.expireCache(o.viewState.projection,o.usedTiles[a])}.bind(null,e);t.postRenderFunctions.push(i)}}updateUsedTiles(t,e,i){const n=z(e);n in t||(t[n]={}),t[n][i.getKey()]=!0}manageTilePyramid(t,e,i,n,r,o,a,h,c){const u=z(e);u in t.wantedTiles||(t.wantedTiles[u]={});const d=t.wantedTiles[u],f=t.tileQueue,g=i.getMinZoom(),m=t.viewState.rotation,_=m?hs(t.viewState.center,t.viewState.resolution,m,t.size):void 0;let p=0,x,l,y,E,C,w;for(w=g;w<=a;++w)for(l=i.getTileRangeForExtentAndZ(o,w,l),y=i.getResolution(w),E=l.minX;E<=l.maxX;++E)for(C=l.minY;C<=l.maxY;++C)m&&!i.tileCoordIntersectsViewport([w,E,C],_)||(a-w<=h?(++p,x=e.getTile(w,E,C,n,r),x.getState()==P.IDLE&&(d[x.getKey()]=!0,f.isKeyQueued(x.getKey())||f.enqueue([x,u,i.getTileCoordCenter(x.tileCoord),y])),c!==void 0&&c(x)):e.useTile(w,E,C,r));e.updateCacheSize(p,r)}}const wd=Cd;class Rd extends dd{constructor(t){super(t)}createRenderer(){return new wd(this)}}const Td=Rd,ns={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"},vd=[0,0,0],ee=5;class Id{constructor(t){this.minZoom=t.minZoom!==void 0?t.minZoom:0,this.resolutions_=t.resolutions,X($a(this.resolutions_,function(n,r){return r-n},!0),17);let e;if(!t.origins){for(let n=0,r=this.resolutions_.length-1;n<r;++n)if(!e)e=this.resolutions_[n]/this.resolutions_[n+1];else if(this.resolutions_[n]/this.resolutions_[n+1]!==e){e=void 0;break}}this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=t.origin!==void 0?t.origin:null,this.origins_=null,t.origins!==void 0&&(this.origins_=t.origins,X(this.origins_.length==this.resolutions_.length,20));const i=t.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Pe(i)),X(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,t.tileSizes!==void 0&&(this.tileSizes_=t.tileSizes,X(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=t.tileSize!==void 0?t.tileSize:this.tileSizes_?null:lr,X(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],t.sizes!==void 0?this.fullTileRanges_=t.sizes.map(function(n,r){const o=new La(Math.min(0,n[0]),Math.max(n[0]-1,-1),Math.min(0,n[1]),Math.max(n[1]-1,-1));if(i){const a=this.getTileRangeForExtentAndZ(i,r);o.minX=Math.max(a.minX,o.minX),o.maxX=Math.min(a.maxX,o.maxX),o.minY=Math.max(a.minY,o.minY),o.maxY=Math.min(a.maxY,o.maxY)}return o},this):i&&this.calculateTileRanges_(i)}forEachTileCoord(t,e,i){const n=this.getTileRangeForExtentAndZ(t,e);for(let r=n.minX,o=n.maxX;r<=o;++r)for(let a=n.minY,h=n.maxY;a<=h;++a)i([e,r,a])}forEachTileCoordParentTileRange(t,e,i,n){let r,o,a,h=null,c=t[0]-1;for(this.zoomFactor_===2?(o=t[1],a=t[2]):h=this.getTileCoordExtent(t,n);c>=this.minZoom;){if(this.zoomFactor_===2?(o=Math.floor(o/2),a=Math.floor(a/2),r=ze(o,o,a,a,i)):r=this.getTileRangeForExtentAndZ(h,c,i),e(c,r))return!0;--c}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(t){return this.origin_?this.origin_:this.origins_[t]}getResolution(t){return this.resolutions_[t]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(t,e,i){if(t[0]<this.maxZoom){if(this.zoomFactor_===2){const r=t[1]*2,o=t[2]*2;return ze(r,r+1,o,o+1,e)}const n=this.getTileCoordExtent(t,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(n,t[0]+1,e)}return null}getTileRangeForTileCoordAndZ(t,e,i){if(e>this.maxZoom||e<this.minZoom)return null;const n=t[0],r=t[1],o=t[2];if(e===n)return ze(r,o,r,o,i);if(this.zoomFactor_){const h=Math.pow(this.zoomFactor_,e-n),c=Math.floor(r*h),u=Math.floor(o*h);if(e<n)return ze(c,c,u,u,i);const d=Math.floor(h*(r+1))-1,f=Math.floor(h*(o+1))-1;return ze(c,d,u,f,i)}const a=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,e,i)}getTileRangeExtent(t,e,i){const n=this.getOrigin(t),r=this.getResolution(t),o=pt(this.getTileSize(t),this.tmpSize_),a=n[0]+e.minX*o[0]*r,h=n[0]+(e.maxX+1)*o[0]*r,c=n[1]+e.minY*o[1]*r,u=n[1]+(e.maxY+1)*o[1]*r;return bt(a,c,h,u,i)}getTileRangeForExtentAndZ(t,e,i){const n=vd;this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,n);const r=n[1],o=n[2];return this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,n),ze(r,n[1],o,n[2],i)}getTileCoordCenter(t){const e=this.getOrigin(t[0]),i=this.getResolution(t[0]),n=pt(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*n[0]*i,e[1]-(t[2]+.5)*n[1]*i]}getTileCoordExtent(t,e){const i=this.getOrigin(t[0]),n=this.getResolution(t[0]),r=pt(this.getTileSize(t[0]),this.tmpSize_),o=i[0]+t[1]*r[0]*n,a=i[1]-(t[2]+1)*r[1]*n,h=o+r[0]*n,c=a+r[1]*n;return bt(o,a,h,c,e)}getTileCoordForCoordAndResolution(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,i)}getTileCoordForXYAndResolution_(t,e,i,n,r){const o=this.getZForResolution(i),a=i/this.getResolution(o),h=this.getOrigin(o),c=pt(this.getTileSize(o),this.tmpSize_);let u=a*(t-h[0])/i/c[0],d=a*(h[1]-e)/i/c[1];return n?(u=Bi(u,ee)-1,d=Bi(d,ee)-1):(u=ji(u,ee),d=ji(d,ee)),uo(o,u,d,r)}getTileCoordForXYAndZ_(t,e,i,n,r){const o=this.getOrigin(i),a=this.getResolution(i),h=pt(this.getTileSize(i),this.tmpSize_);let c=(t-o[0])/a/h[0],u=(o[1]-e)/a/h[1];return n?(c=Bi(c,ee)-1,u=Bi(u,ee)-1):(c=ji(c,ee),u=ji(u,ee)),uo(i,c,u,r)}getTileCoordForCoordAndZ(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i)}getTileCoordResolution(t){return this.resolutions_[t[0]]}getTileSize(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}getFullTileRange(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}getZForResolution(t,e){const i=Ps(this.resolutions_,t,e||0);return J(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(t,e){return Yo(e,0,e.length,2,this.getTileCoordExtent(t))}calculateTileRanges_(t){const e=this.resolutions_.length,i=new Array(e);for(let n=this.minZoom;n<e;++n)i[n]=this.getTileRangeForExtentAndZ(t,n);this.fullTileRanges_=i}}const Oa=Id;function ba(s){let t=s.getDefaultTileGrid();return t||(t=Pd(s),s.setDefaultTileGrid(t)),t}function Sd(s,t,e){const i=t[0],n=s.getTileCoordCenter(t),r=_r(e);if(Rn(r,n))return t;{const o=V(r),a=Math.ceil((r[0]-n[0])/o);return n[0]+=o*a,s.getTileCoordForCoordAndZ(n,i)}}function Ld(s,t,e,i){i=i!==void 0?i:"top-left";const n=Fa(s,t,e);return new Oa({extent:s,origin:_l(s,i),resolutions:n,tileSize:e})}function Md(s){const t=s||{},e=t.extent||q("EPSG:3857").getExtent(),i={extent:e,minZoom:t.minZoom,tileSize:t.tileSize,resolutions:Fa(e,t.maxZoom,t.tileSize,t.maxResolution)};return new Oa(i)}function Fa(s,t,e,i){t=t!==void 0?t:nu,e=pt(e!==void 0?e:lr);const n=Ft(s),r=V(s);i=i>0?i:Math.max(r/e[0],n/e[1]);const o=t+1,a=new Array(o);for(let h=0;h<o;++h)a[h]=i/Math.pow(2,h);return a}function Pd(s,t,e,i){const n=_r(s);return Ld(n,t,e,i)}function _r(s){s=q(s);let t=s.getExtent();if(!t){const e=180*gi.degrees/s.getMetersPerUnit();t=bt(-e,-e,e,e)}return t}class Ad extends da{constructor(t){super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate}),this.on,this.once,this.un,this.opaque_=t.opaque!==void 0?t.opaque:!1,this.tilePixelRatio_=t.tilePixelRatio!==void 0?t.tilePixelRatio:1,this.tileGrid=t.tileGrid!==void 0?t.tileGrid:null;const e=[256,256];this.tileGrid&&pt(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),e),this.tileCache=new Ia(t.cacheSize||0),this.tmpSize=[0,0],this.key_=t.key||"",this.tileOptions={transition:t.transition,interpolate:t.interpolate},this.zDirection=t.zDirection?t.zDirection:0}canExpireCache(){return this.tileCache.canExpireCache()}expireCache(t,e){const i=this.getTileCacheForProjection(t);i&&i.expireCache(e)}forEachLoadedTile(t,e,i,n){const r=this.getTileCacheForProjection(t);if(!r)return!1;let o=!0,a,h,c;for(let u=i.minX;u<=i.maxX;++u)for(let d=i.minY;d<=i.maxY;++d)h=Dn(e,u,d),c=!1,r.containsKey(h)&&(a=r.get(h),c=a.getState()===P.LOADED,c&&(c=n(a)!==!1)),c||(o=!1);return o}getGutterForProjection(t){return 0}getKey(){return this.key_}setKey(t){this.key_!==t&&(this.key_=t,this.changed())}getOpaque(t){return this.opaque_}getResolutions(){return this.tileGrid?this.tileGrid.getResolutions():null}getTile(t,e,i,n,r){return b()}getTileGrid(){return this.tileGrid}getTileGridForProjection(t){return this.tileGrid?this.tileGrid:ba(t)}getTileCacheForProjection(t){const e=this.getProjection();return X(e===null||me(e,t),68),this.tileCache}getTilePixelRatio(t){return this.tilePixelRatio_}getTilePixelSize(t,e,i){const n=this.getTileGridForProjection(i),r=this.getTilePixelRatio(e),o=pt(n.getTileSize(t),this.tmpSize);return r==1?o:hh(o,r,this.tmpSize)}getTileCoordForTileUrlFunction(t,e){e=e!==void 0?e:this.getProjection();const i=this.getTileGridForProjection(e);return this.getWrapX()&&e.isGlobal()&&(t=Sd(i,t,e)),rd(t,i)?t:null}clear(){this.tileCache.clear()}refresh(){this.clear(),super.refresh()}updateCacheSize(t,e){const i=this.getTileCacheForProjection(e);t>i.highWaterMark&&(i.highWaterMark=t)}useTile(t,e,i,n){}}class Od extends kt{constructor(t,e){super(t),this.tile=e}}const bd=Ad;function Fd(s,t){const e=/\{z\}/g,i=/\{x\}/g,n=/\{y\}/g,r=/\{-y\}/g;return function(o,a,h){if(o)return s.replace(e,o[0].toString()).replace(i,o[1].toString()).replace(n,o[2].toString()).replace(r,function(){const c=o[0],u=t.getFullTileRange(c);return X(u,55),(u.getHeight()-o[2]-1).toString()})}}function ka(s,t){const e=s.length,i=new Array(e);for(let n=0;n<e;++n)i[n]=Fd(s[n],t);return kd(i)}function kd(s){return s.length===1?s[0]:function(t,e,i){if(t){const n=sd(t),r=Ue(n,s.length);return s[r](t,e,i)}else return}}function Dd(s){const t=[];let e=/\{([a-z])-([a-z])\}/.exec(s);if(e){const i=e[1].charCodeAt(0),n=e[2].charCodeAt(0);let r;for(r=i;r<=n;++r)t.push(s.replace(e[0],String.fromCharCode(r)));return t}if(e=/\{(\d+)-(\d+)\}/.exec(s),e){const i=parseInt(e[2],10);for(let n=parseInt(e[1],10);n<=i;n++)t.push(s.replace(e[0],n.toString()));return t}return t.push(s),t}class yr extends bd{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===yr.prototype.tileUrlFunction,this.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(this.tileUrlFunction=t.tileUrlFunction),this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(t){const e=t.target,i=z(e),n=e.getState();let r;n==P.LOADING?(this.tileLoadingKeys_[i]=!0,r=ns.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],r=n==P.ERROR?ns.TILELOADERROR:n==P.LOADED?ns.TILELOADEND:void 0),r!=null&&this.dispatchEvent(new Od(r,e))}setTileLoadFunction(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()}setTileUrlFunction(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),typeof e<"u"?this.setKey(e):this.changed()}setUrl(t){const e=Dd(t);this.urls=e,this.setUrls(e)}setUrls(t){this.urls=t;const e=t.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(ka(t,this.tileGrid),e):this.setKey(e)}tileUrlFunction(t,e,i){}useTile(t,e,i){const n=Dn(t,e,i);this.tileCache.containsKey(n)&&this.tileCache.get(n)}}const Nd=yr;class Gd extends Nd{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:Xd,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate!==void 0?t.interpolate:!0,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=t.crossOrigin!==void 0?t.crossOrigin:null,this.tileClass=t.tileClass!==void 0?t.tileClass:ma,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}canExpireCache(){if(this.tileCache.canExpireCache())return!0;for(const t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1}expireCache(t,e){const i=this.getTileCacheForProjection(t);this.tileCache.expireCache(this.tileCache==i?e:{});for(const n in this.tileCacheForProjection){const r=this.tileCacheForProjection[n];r.expireCache(r==i?e:{})}}getGutterForProjection(t){return this.getProjection()&&t&&!me(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return this.getInterpolate()||(t+=":disable-interpolation"),t}getOpaque(t){return this.getProjection()&&t&&!me(this.getProjection(),t)?!1:super.getOpaque(t)}getTileGridForProjection(t){const e=this.getProjection();if(this.tileGrid&&(!e||me(e,t)))return this.tileGrid;{const i=z(t);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=ba(t)),this.tileGridForProjection[i]}}getTileCacheForProjection(t){const e=this.getProjection();if(!e||me(e,t))return this.tileCache;{const i=z(t);return i in this.tileCacheForProjection||(this.tileCacheForProjection[i]=new Ia(this.tileCache.highWaterMark)),this.tileCacheForProjection[i]}}createTile_(t,e,i,n,r,o){const a=[t,e,i],h=this.getTileCoordForTileUrlFunction(a,r),c=h?this.tileUrlFunction(h,n,r):void 0,u=new this.tileClass(a,c!==void 0?P.IDLE:P.EMPTY,c!==void 0?c:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return u.key=o,u.addEventListener(k.CHANGE,this.handleTileChange.bind(this)),u}getTile(t,e,i,n,r){const o=this.getProjection();if(!o||!r||me(o,r))return this.getTileInternal(t,e,i,n,o||r);{const a=this.getTileCacheForProjection(r),h=[t,e,i];let c;const u=va(h);a.containsKey(u)&&(c=a.get(u));const d=this.getKey();if(c&&c.key==d)return c;{const f=this.getTileGridForProjection(o),g=this.getTileGridForProjection(r),m=this.getTileCoordForTileUrlFunction(h,r),_=new Rs(o,f,r,g,h,m,this.getTilePixelRatio(n),this.getGutter(),function(p,x,l,y){return this.getTileInternal(p,x,l,y,o)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.getInterpolate());return _.key=d,c?(_.interimTile=c,_.refreshInterimChain(),a.replace(u,_)):a.set(u,_),_}}}getTileInternal(t,e,i,n,r){let o=null;const a=Dn(t,e,i),h=this.getKey();if(!this.tileCache.containsKey(a))o=this.createTile_(t,e,i,n,r,h),this.tileCache.set(a,o);else if(o=this.tileCache.get(a),o.key!=h){const c=o;o=this.createTile_(t,e,i,n,r,h),c.getState()==P.IDLE?o.interimTile=c.interimTile:o.interimTile=c,o.refreshInterimChain(),this.tileCache.replace(a,o)}return o}setRenderReprojectionEdges(t){if(this.renderReprojectionEdges_!=t){this.renderReprojectionEdges_=t;for(const e in this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}}setTileGridForProjection(t,e){const i=q(t);if(i){const n=z(i);n in this.tileGridForProjection||(this.tileGridForProjection[n]=e)}}clear(){super.clear();for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear()}}function Xd(s,t){s.getImage().src=t}const Wd=Gd;function zd(s,t,e,i){const n=document.createElement("script"),r="olc_"+z(t);function o(){delete window[r],n.parentNode.removeChild(n)}n.async=!0,n.src=s+(s.includes("?")?"&":"?")+(i||"callback")+"="+r;const a=setTimeout(function(){o(),e&&e()},1e4);window[r]=function(h){clearTimeout(a),o(),t(h)},document.head.appendChild(n)}class Yd extends Wd{constructor(t){if(super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:q("EPSG:3857"),reprojectionErrorThreshold:t.reprojectionErrorThreshold,state:"loading",tileLoadFunction:t.tileLoadFunction,wrapX:t.wrapX!==void 0?t.wrapX:!0,transition:t.transition,zDirection:t.zDirection}),this.tileJSON_=null,this.tileSize_=t.tileSize,t.url)if(t.jsonp)zd(t.url,this.handleTileJSONResponse.bind(this),this.handleTileJSONError.bind(this));else{const e=new XMLHttpRequest;e.addEventListener("load",this.onXHRLoad_.bind(this)),e.addEventListener("error",this.onXHRError_.bind(this)),e.open("GET",t.url),e.send()}else t.tileJSON?this.handleTileJSONResponse(t.tileJSON):X(!1,51)}onXHRLoad_(t){const e=t.target;if(!e.status||e.status>=200&&e.status<300){let i;try{i=JSON.parse(e.responseText)}catch{this.handleTileJSONError();return}this.handleTileJSONResponse(i)}else this.handleTileJSONError()}onXHRError_(t){this.handleTileJSONError()}getTileJSON(){return this.tileJSON_}handleTileJSONResponse(t){const e=q("EPSG:4326"),i=this.getProjection();let n;if(t.bounds!==void 0){const c=Sn(e,i);n=xl(t.bounds,c)}const r=_r(i),o=t.minzoom||0,a=t.maxzoom||22,h=Md({extent:r,maxZoom:a,minZoom:o,tileSize:this.tileSize_});if(this.tileGrid=h,this.tileUrlFunction=ka(t.tiles,h),t.attribution&&!this.getAttributions()){const c=n!==void 0?n:r;this.setAttributions(function(u){return ct(c,u.extent)?[t.attribution]:null})}this.tileJSON_=t,this.setState("ready")}handleTileJSONError(){this.setState("error")}}const jd=Yd;class xn extends Do{constructor(t){super(),this.geometries_=t||null,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(Z),this.changeEventsKeys_.length=0}listenGeometriesChange_(){if(this.geometries_)for(let t=0,e=this.geometries_.length;t<e;++t)this.changeEventsKeys_.push(W(this.geometries_[t],k.CHANGE,this.changed,this))}clone(){const t=new xn(null);return t.setGeometries(this.geometries_),t.applyProperties(this),t}closestPointXY(t,e,i,n){if(n<Me(this.getExtent(),t,e))return n;const r=this.geometries_;for(let o=0,a=r.length;o<a;++o)n=r[o].closestPointXY(t,e,i,n);return n}containsXY(t,e){const i=this.geometries_;for(let n=0,r=i.length;n<r;++n)if(i[n].containsXY(t,e))return!0;return!1}computeExtent(t){Li(t);const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)To(t,e[i].getExtent());return t}getGeometries(){return _o(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let t=[];const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)e[i].getType()===this.getType()?t=t.concat(e[i].getGeometriesArrayRecursive()):t.push(e[i]);return t}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=[],i=this.geometries_;let n=!1;for(let r=0,o=i.length;r<o;++r){const a=i[r],h=a.getSimplifiedGeometry(t);e.push(h),h!==a&&(n=!0)}if(n){const r=new xn(null);return r.setGeometriesArray(e),r}else return this.simplifiedGeometryMaxMinSquaredTolerance=t,this}getType(){return"GeometryCollection"}intersectsExtent(t){const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)if(e[i].intersectsExtent(t))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(t,e){const i=this.geometries_;for(let n=0,r=i.length;n<r;++n)i[n].rotate(t,e);this.changed()}scale(t,e,i){i||(i=Se(this.getExtent()));const n=this.geometries_;for(let r=0,o=n.length;r<o;++r)n[r].scale(t,e,i);this.changed()}setGeometries(t){this.setGeometriesArray(_o(t))}setGeometriesArray(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()}applyTransform(t){const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)e[i].applyTransform(t);this.changed()}translate(t,e){const i=this.geometries_;for(let n=0,r=i.length;n<r;++n)i[n].translate(t,e);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function _o(s){const t=[];for(let e=0,i=s.length;e<i;++e)t.push(s[e].clone());return t}const Bd=xn;class Kd extends cd{constructor(){super()}getType(){return"json"}readFeature(t,e){return this.readFeatureFromObject(Ji(t),this.getReadOptions(t,e))}readFeatures(t,e){return this.readFeaturesFromObject(Ji(t),this.getReadOptions(t,e))}readFeatureFromObject(t,e){return b()}readFeaturesFromObject(t,e){return b()}readGeometry(t,e){return this.readGeometryFromObject(Ji(t),this.getReadOptions(t,e))}readGeometryFromObject(t,e){return b()}readProjection(t){return this.readProjectionFromObject(Ji(t))}readProjectionFromObject(t){return b()}writeFeature(t,e){return JSON.stringify(this.writeFeatureObject(t,e))}writeFeatureObject(t,e){return b()}writeFeatures(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))}writeFeaturesObject(t,e){return b()}writeGeometry(t,e){return JSON.stringify(this.writeGeometryObject(t,e))}writeGeometryObject(t,e){return b()}}function Ji(s){if(typeof s=="string"){const t=JSON.parse(s);return t||null}else return s!==null?s:null}const Zd=Kd;class Vd extends Zd{constructor(t){t=t||{},super(),this.dataProjection=q(t.dataProjection?t.dataProjection:"EPSG:4326"),t.featureProjection&&(this.defaultFeatureProjection=q(t.featureProjection)),this.geometryName_=t.geometryName,this.extractGeometryName_=t.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(t,e){let i=null;t.type==="Feature"?i=t:i={type:"Feature",geometry:t,properties:null};const n=Ts(i.geometry,e),r=new Os;return this.geometryName_?r.setGeometryName(this.geometryName_):this.extractGeometryName_&&"geometry_name"in i!==void 0&&r.setGeometryName(i.geometry_name),r.setGeometry(n),"id"in i&&r.setId(i.id),i.properties&&r.setProperties(i.properties,!0),r}readFeaturesFromObject(t,e){const i=t;let n=null;if(i.type==="FeatureCollection"){const r=t;n=[];const o=r.features;for(let a=0,h=o.length;a<h;++a)n.push(this.readFeatureFromObject(o[a],e))}else n=[this.readFeatureFromObject(t,e)];return n}readGeometryFromObject(t,e){return Ts(t,e)}readProjectionFromObject(t){const e=t.crs;let i;return e?e.type=="name"?i=q(e.properties.name):e.type==="EPSG"?i=q("EPSG:"+e.properties.code):X(!1,36):i=this.dataProjection,i}writeFeatureObject(t,e){e=this.adaptOptions(e);const i={type:"Feature",geometry:null,properties:null},n=t.getId();if(n!==void 0&&(i.id=n),!t.hasProperties())return i;const r=t.getProperties(),o=t.getGeometry();return o&&(i.geometry=vs(o,e),delete r[t.getGeometryName()]),$e(r)||(i.properties=r),i}writeFeaturesObject(t,e){e=this.adaptOptions(e);const i=[];for(let n=0,r=t.length;n<r;++n)i.push(this.writeFeatureObject(t[n],e));return{type:"FeatureCollection",features:i}}writeGeometryObject(t,e){return vs(t,this.adaptOptions(e))}}function Ts(s,t){if(!s)return null;let e;switch(s.type){case"Point":{e=Hd(s);break}case"LineString":{e=$d(s);break}case"Polygon":{e=tf(s);break}case"MultiPoint":{e=Jd(s);break}case"MultiLineString":{e=qd(s);break}case"MultiPolygon":{e=Qd(s);break}case"GeometryCollection":{e=Ud(s);break}default:throw new Error("Unsupported GeoJSON type: "+s.type)}return Pa(e,!1,t)}function Ud(s,t){const e=s.geometries.map(function(i){return Ts(i,t)});return new Bd(e)}function Hd(s){return new qe(s.coordinates)}function $d(s){return new _s(s.coordinates)}function qd(s){return new ad(s.coordinates)}function Jd(s){return new Ma(s.coordinates)}function Qd(s){return new hd(s.coordinates)}function tf(s){return new an(s.coordinates)}function vs(s,t){s=Pa(s,!0,t);const e=s.getType();let i;switch(e){case"Point":{i=af(s);break}case"LineString":{i=nf(s);break}case"Polygon":{i=lf(s,t);break}case"MultiPoint":{i=rf(s);break}case"MultiLineString":{i=sf(s);break}case"MultiPolygon":{i=of(s,t);break}case"GeometryCollection":{i=ef(s,t);break}case"Circle":{i={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+e)}return i}function ef(s,t){return t=Object.assign({},t),delete t.featureProjection,{type:"GeometryCollection",geometries:s.getGeometriesArray().map(function(i){return vs(i,t)})}}function nf(s,t){return{type:"LineString",coordinates:s.getCoordinates()}}function sf(s,t){return{type:"MultiLineString",coordinates:s.getCoordinates()}}function rf(s,t){return{type:"MultiPoint",coordinates:s.getCoordinates()}}function of(s,t){let e;return t&&(e=t.rightHanded),{type:"MultiPolygon",coordinates:s.getCoordinates(e)}}function af(s,t){return{type:"Point",coordinates:s.getCoordinates()}}function lf(s,t){let e;return t&&(e=t.rightHanded),{type:"Polygon",coordinates:s.getCoordinates(e)}}const vi=Vd,ss={TRANSLATESTART:"translatestart",TRANSLATING:"translating",TRANSLATEEND:"translateend"};class rs extends kt{constructor(t,e,i,n,r){super(t),this.features=e,this.coordinate=i,this.startCoordinate=n,this.mapBrowserEvent=r}}class hf extends ei{constructor(t){t=t||{},super(t),this.on,this.once,this.un,this.lastCoordinate_=null,this.startCoordinate_=null,this.features_=t.features!==void 0?t.features:null;let e;if(t.layers&&!this.features_)if(typeof t.layers=="function")e=t.layers;else{const i=t.layers;e=function(n){return i.includes(n)}}else e=ve;this.layerFilter_=e,this.filter_=t.filter&&!this.features_?t.filter:ve,this.hitTolerance_=t.hitTolerance?t.hitTolerance:0,this.condition_=t.condition?t.condition:xa,this.lastFeature_=null,this.addChangeListener(Cs.ACTIVE,this.handleActiveChanged_)}handleDownEvent(t){if(!t.originalEvent||!this.condition_(t))return!1;if(this.lastFeature_=this.featuresAtPixel_(t.pixel,t.map),!this.lastCoordinate_&&this.lastFeature_){this.startCoordinate_=t.coordinate,this.lastCoordinate_=t.coordinate,this.handleMoveEvent(t);const e=this.features_||new ut([this.lastFeature_]);return this.dispatchEvent(new rs(ss.TRANSLATESTART,e,t.coordinate,this.startCoordinate_,t)),!0}return!1}handleUpEvent(t){if(this.lastCoordinate_){this.lastCoordinate_=null,this.handleMoveEvent(t);const e=this.features_||new ut([this.lastFeature_]);return this.dispatchEvent(new rs(ss.TRANSLATEEND,e,t.coordinate,this.startCoordinate_,t)),this.startCoordinate_=null,!0}return!1}handleDragEvent(t){if(this.lastCoordinate_){const e=t.coordinate,i=e[0]-this.lastCoordinate_[0],n=e[1]-this.lastCoordinate_[1],r=this.features_||new ut([this.lastFeature_]);r.forEach(function(o){const a=o.getGeometry();a.translate(i,n),o.setGeometry(a)}),this.lastCoordinate_=e,this.dispatchEvent(new rs(ss.TRANSLATING,r,e,this.startCoordinate_,t))}}handleMoveEvent(t){const e=t.map.getViewport();this.featuresAtPixel_(t.pixel,t.map)?(e.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),e.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):e.classList.remove("ol-grab","ol-grabbing")}featuresAtPixel_(t,e){return e.forEachFeatureAtPixel(t,function(i,n){if(this.filter_(i,n)&&(!this.features_||this.features_.getArray().includes(i)))return i}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})}getHitTolerance(){return this.hitTolerance_}setHitTolerance(t){this.hitTolerance_=t}setMap(t){const e=this.getMap();super.setMap(t),this.updateState_(e)}handleActiveChanged_(){this.updateState_(null)}updateState_(t){let e=this.getMap();const i=this.getActive();(!e||!i)&&(e=e||t,e&&e.getViewport().classList.remove("ol-grab","ol-grabbing"))}}const Da=hf;var Is={},cf={get exports(){return Is},set exports(s){Is=s}};(function(s){(function(){var t={y:function(l){return l===1?"χρόνος":"χρόνια"},mo:function(l){return l===1?"μήνας":"μήνες"},w:function(l){return l===1?"εβδομάδα":"εβδομάδες"},d:function(l){return l===1?"μέρα":"μέρες"},h:function(l){return l===1?"ώρα":"ώρες"},m:function(l){return l===1?"λεπτό":"λεπτά"},s:function(l){return l===1?"δευτερόλεπτο":"δευτερόλεπτα"},ms:function(l){return(l===1?"χιλιοστό":"χιλιοστά")+" του δευτερολέπτου"},decimal:","},e=["۰","١","٢","٣","٤","٥","٦","٧","٨","٩"],i={af:{y:"jaar",mo:function(l){return"maand"+(l===1?"":"e")},w:function(l){return l===1?"week":"weke"},d:function(l){return l===1?"dag":"dae"},h:function(l){return l===1?"uur":"ure"},m:function(l){return l===1?"minuut":"minute"},s:function(l){return"sekonde"+(l===1?"":"s")},ms:function(l){return"millisekonde"+(l===1?"":"s")},decimal:","},ar:{y:function(l){return["سنة","سنتان","سنوات"][u(l)]},mo:function(l){return["شهر","شهران","أشهر"][u(l)]},w:function(l){return["أسبوع","أسبوعين","أسابيع"][u(l)]},d:function(l){return["يوم","يومين","أيام"][u(l)]},h:function(l){return["ساعة","ساعتين","ساعات"][u(l)]},m:function(l){return["دقيقة","دقيقتان","دقائق"][u(l)]},s:function(l){return["ثانية","ثانيتان","ثواني"][u(l)]},ms:function(l){return["جزء من الثانية","جزآن من الثانية","أجزاء من الثانية"][u(l)]},decimal:",",delimiter:" و ",_formatCount:function(l,y){for(var E=c(e,{".":y}),C=l.toString().split(""),w=0;w<C.length;w++){var v=C[w];x(E,v)&&(C[w]=E[v])}return C.join("")}},bg:{y:function(l){return["години","година","години"][f(l)]},mo:function(l){return["месеца","месец","месеца"][f(l)]},w:function(l){return["седмици","седмица","седмици"][f(l)]},d:function(l){return["дни","ден","дни"][f(l)]},h:function(l){return["часа","час","часа"][f(l)]},m:function(l){return["минути","минута","минути"][f(l)]},s:function(l){return["секунди","секунда","секунди"][f(l)]},ms:function(l){return["милисекунди","милисекунда","милисекунди"][f(l)]},decimal:","},bn:{y:"বছর",mo:"মাস",w:"সপ্তাহ",d:"দিন",h:"ঘন্টা",m:"মিনিট",s:"সেকেন্ড",ms:"মিলিসেকেন্ড"},ca:{y:function(l){return"any"+(l===1?"":"s")},mo:function(l){return"mes"+(l===1?"":"os")},w:function(l){return"setman"+(l===1?"a":"es")},d:function(l){return"di"+(l===1?"a":"es")},h:function(l){return"hor"+(l===1?"a":"es")},m:function(l){return"minut"+(l===1?"":"s")},s:function(l){return"segon"+(l===1?"":"s")},ms:function(l){return"milisegon"+(l===1?"":"s")},decimal:","},cs:{y:function(l){return["rok","roku","roky","let"][g(l)]},mo:function(l){return["měsíc","měsíce","měsíce","měsíců"][g(l)]},w:function(l){return["týden","týdne","týdny","týdnů"][g(l)]},d:function(l){return["den","dne","dny","dní"][g(l)]},h:function(l){return["hodina","hodiny","hodiny","hodin"][g(l)]},m:function(l){return["minuta","minuty","minuty","minut"][g(l)]},s:function(l){return["sekunda","sekundy","sekundy","sekund"][g(l)]},ms:function(l){return["milisekunda","milisekundy","milisekundy","milisekund"][g(l)]},decimal:","},cy:{y:"flwyddyn",mo:"mis",w:"wythnos",d:"diwrnod",h:"awr",m:"munud",s:"eiliad",ms:"milieiliad"},da:{y:"år",mo:function(l){return"måned"+(l===1?"":"er")},w:function(l){return"uge"+(l===1?"":"r")},d:function(l){return"dag"+(l===1?"":"e")},h:function(l){return"time"+(l===1?"":"r")},m:function(l){return"minut"+(l===1?"":"ter")},s:function(l){return"sekund"+(l===1?"":"er")},ms:function(l){return"millisekund"+(l===1?"":"er")},decimal:","},de:{y:function(l){return"Jahr"+(l===1?"":"e")},mo:function(l){return"Monat"+(l===1?"":"e")},w:function(l){return"Woche"+(l===1?"":"n")},d:function(l){return"Tag"+(l===1?"":"e")},h:function(l){return"Stunde"+(l===1?"":"n")},m:function(l){return"Minute"+(l===1?"":"n")},s:function(l){return"Sekunde"+(l===1?"":"n")},ms:function(l){return"Millisekunde"+(l===1?"":"n")},decimal:","},el:t,en:{y:function(l){return"year"+(l===1?"":"s")},mo:function(l){return"month"+(l===1?"":"s")},w:function(l){return"week"+(l===1?"":"s")},d:function(l){return"day"+(l===1?"":"s")},h:function(l){return"hour"+(l===1?"":"s")},m:function(l){return"minute"+(l===1?"":"s")},s:function(l){return"second"+(l===1?"":"s")},ms:function(l){return"millisecond"+(l===1?"":"s")},decimal:"."},eo:{y:function(l){return"jaro"+(l===1?"":"j")},mo:function(l){return"monato"+(l===1?"":"j")},w:function(l){return"semajno"+(l===1?"":"j")},d:function(l){return"tago"+(l===1?"":"j")},h:function(l){return"horo"+(l===1?"":"j")},m:function(l){return"minuto"+(l===1?"":"j")},s:function(l){return"sekundo"+(l===1?"":"j")},ms:function(l){return"milisekundo"+(l===1?"":"j")},decimal:","},es:{y:function(l){return"año"+(l===1?"":"s")},mo:function(l){return"mes"+(l===1?"":"es")},w:function(l){return"semana"+(l===1?"":"s")},d:function(l){return"día"+(l===1?"":"s")},h:function(l){return"hora"+(l===1?"":"s")},m:function(l){return"minuto"+(l===1?"":"s")},s:function(l){return"segundo"+(l===1?"":"s")},ms:function(l){return"milisegundo"+(l===1?"":"s")},decimal:","},et:{y:function(l){return"aasta"+(l===1?"":"t")},mo:function(l){return"kuu"+(l===1?"":"d")},w:function(l){return"nädal"+(l===1?"":"at")},d:function(l){return"päev"+(l===1?"":"a")},h:function(l){return"tund"+(l===1?"":"i")},m:function(l){return"minut"+(l===1?"":"it")},s:function(l){return"sekund"+(l===1?"":"it")},ms:function(l){return"millisekund"+(l===1?"":"it")},decimal:","},eu:{y:"urte",mo:"hilabete",w:"aste",d:"egun",h:"ordu",m:"minutu",s:"segundo",ms:"milisegundo",decimal:","},fa:{y:"سال",mo:"ماه",w:"هفته",d:"روز",h:"ساعت",m:"دقیقه",s:"ثانیه",ms:"میلی ثانیه",decimal:"."},fi:{y:function(l){return l===1?"vuosi":"vuotta"},mo:function(l){return l===1?"kuukausi":"kuukautta"},w:function(l){return"viikko"+(l===1?"":"a")},d:function(l){return"päivä"+(l===1?"":"ä")},h:function(l){return"tunti"+(l===1?"":"a")},m:function(l){return"minuutti"+(l===1?"":"a")},s:function(l){return"sekunti"+(l===1?"":"a")},ms:function(l){return"millisekunti"+(l===1?"":"a")},decimal:","},fo:{y:"ár",mo:function(l){return l===1?"mánaður":"mánaðir"},w:function(l){return l===1?"vika":"vikur"},d:function(l){return l===1?"dagur":"dagar"},h:function(l){return l===1?"tími":"tímar"},m:function(l){return l===1?"minuttur":"minuttir"},s:"sekund",ms:"millisekund",decimal:","},fr:{y:function(l){return"an"+(l>=2?"s":"")},mo:"mois",w:function(l){return"semaine"+(l>=2?"s":"")},d:function(l){return"jour"+(l>=2?"s":"")},h:function(l){return"heure"+(l>=2?"s":"")},m:function(l){return"minute"+(l>=2?"s":"")},s:function(l){return"seconde"+(l>=2?"s":"")},ms:function(l){return"milliseconde"+(l>=2?"s":"")},decimal:","},gr:t,he:{y:function(l){return l===1?"שנה":"שנים"},mo:function(l){return l===1?"חודש":"חודשים"},w:function(l){return l===1?"שבוע":"שבועות"},d:function(l){return l===1?"יום":"ימים"},h:function(l){return l===1?"שעה":"שעות"},m:function(l){return l===1?"דקה":"דקות"},s:function(l){return l===1?"שניה":"שניות"},ms:function(l){return l===1?"מילישנייה":"מילישניות"},decimal:"."},hr:{y:function(l){return l%10===2||l%10===3||l%10===4?"godine":"godina"},mo:function(l){return l===1?"mjesec":l===2||l===3||l===4?"mjeseca":"mjeseci"},w:function(l){return l%10===1&&l!==11?"tjedan":"tjedna"},d:function(l){return l===1?"dan":"dana"},h:function(l){return l===1?"sat":l===2||l===3||l===4?"sata":"sati"},m:function(l){var y=l%10;return(y===2||y===3||y===4)&&(l<10||l>14)?"minute":"minuta"},s:function(l){var y=l%10;return y===5||Math.floor(l)===l&&l>=10&&l<=19?"sekundi":y===1?"sekunda":y===2||y===3||y===4?"sekunde":"sekundi"},ms:function(l){return l===1?"milisekunda":l%10===2||l%10===3||l%10===4?"milisekunde":"milisekundi"},decimal:","},hi:{y:"साल",mo:function(l){return l===1?"महीना":"महीने"},w:function(l){return l===1?"हफ़्ता":"हफ्ते"},d:"दिन",h:function(l){return l===1?"घंटा":"घंटे"},m:"मिनट",s:"सेकंड",ms:"मिलीसेकंड",decimal:"."},hu:{y:"év",mo:"hónap",w:"hét",d:"nap",h:"óra",m:"perc",s:"másodperc",ms:"ezredmásodperc",decimal:","},id:{y:"tahun",mo:"bulan",w:"minggu",d:"hari",h:"jam",m:"menit",s:"detik",ms:"milidetik",decimal:"."},is:{y:"ár",mo:function(l){return"mánuð"+(l===1?"ur":"ir")},w:function(l){return"vik"+(l===1?"a":"ur")},d:function(l){return"dag"+(l===1?"ur":"ar")},h:function(l){return"klukkutím"+(l===1?"i":"ar")},m:function(l){return"mínút"+(l===1?"a":"ur")},s:function(l){return"sekúnd"+(l===1?"a":"ur")},ms:function(l){return"millisekúnd"+(l===1?"a":"ur")},decimal:"."},it:{y:function(l){return"ann"+(l===1?"o":"i")},mo:function(l){return"mes"+(l===1?"e":"i")},w:function(l){return"settiman"+(l===1?"a":"e")},d:function(l){return"giorn"+(l===1?"o":"i")},h:function(l){return"or"+(l===1?"a":"e")},m:function(l){return"minut"+(l===1?"o":"i")},s:function(l){return"second"+(l===1?"o":"i")},ms:function(l){return"millisecond"+(l===1?"o":"i")},decimal:","},ja:{y:"年",mo:"ヶ月",w:"週",d:"日",h:"時間",m:"分",s:"秒",ms:"ミリ秒",decimal:"."},km:{y:"ឆ្នាំ",mo:"ខែ",w:"សប្តាហ៍",d:"ថ្ងៃ",h:"ម៉ោង",m:"នាទី",s:"វិនាទី",ms:"មិល្លីវិនាទី"},kn:{y:function(l){return l===1?"ವರ್ಷ":"ವರ್ಷಗಳು"},mo:function(l){return l===1?"ತಿಂಗಳು":"ತಿಂಗಳುಗಳು"},w:function(l){return l===1?"ವಾರ":"ವಾರಗಳು"},d:function(l){return l===1?"ದಿನ":"ದಿನಗಳು"},h:function(l){return l===1?"ಗಂಟೆ":"ಗಂಟೆಗಳು"},m:function(l){return l===1?"ನಿಮಿಷ":"ನಿಮಿಷಗಳು"},s:function(l){return l===1?"ಸೆಕೆಂಡ್":"ಸೆಕೆಂಡುಗಳು"},ms:function(l){return l===1?"ಮಿಲಿಸೆಕೆಂಡ್":"ಮಿಲಿಸೆಕೆಂಡುಗಳು"}},ko:{y:"년",mo:"개월",w:"주일",d:"일",h:"시간",m:"분",s:"초",ms:"밀리 초",decimal:"."},ku:{y:"sal",mo:"meh",w:"hefte",d:"roj",h:"seet",m:"deqe",s:"saniye",ms:"mîlîçirk",decimal:","},lo:{y:"ປີ",mo:"ເດືອນ",w:"ອາທິດ",d:"ມື້",h:"ຊົ່ວໂມງ",m:"ນາທີ",s:"ວິນາທີ",ms:"ມິນລິວິນາທີ",decimal:","},lt:{y:function(l){return l%10===0||l%100>=10&&l%100<=20?"metų":"metai"},mo:function(l){return["mėnuo","mėnesiai","mėnesių"][m(l)]},w:function(l){return["savaitė","savaitės","savaičių"][m(l)]},d:function(l){return["diena","dienos","dienų"][m(l)]},h:function(l){return["valanda","valandos","valandų"][m(l)]},m:function(l){return["minutė","minutės","minučių"][m(l)]},s:function(l){return["sekundė","sekundės","sekundžių"][m(l)]},ms:function(l){return["milisekundė","milisekundės","milisekundžių"][m(l)]},decimal:","},lv:{y:function(l){return _(l)?"gads":"gadi"},mo:function(l){return _(l)?"mēnesis":"mēneši"},w:function(l){return _(l)?"nedēļa":"nedēļas"},d:function(l){return _(l)?"diena":"dienas"},h:function(l){return _(l)?"stunda":"stundas"},m:function(l){return _(l)?"minūte":"minūtes"},s:function(l){return _(l)?"sekunde":"sekundes"},ms:function(l){return _(l)?"milisekunde":"milisekundes"},decimal:","},mk:{y:function(l){return l===1?"година":"години"},mo:function(l){return l===1?"месец":"месеци"},w:function(l){return l===1?"недела":"недели"},d:function(l){return l===1?"ден":"дена"},h:function(l){return l===1?"час":"часа"},m:function(l){return l===1?"минута":"минути"},s:function(l){return l===1?"секунда":"секунди"},ms:function(l){return l===1?"милисекунда":"милисекунди"},decimal:","},mn:{y:"жил",mo:"сар",w:"долоо хоног",d:"өдөр",h:"цаг",m:"минут",s:"секунд",ms:"миллисекунд",decimal:"."},mr:{y:function(l){return l===1?"वर्ष":"वर्षे"},mo:function(l){return l===1?"महिना":"महिने"},w:function(l){return l===1?"आठवडा":"आठवडे"},d:"दिवस",h:"तास",m:function(l){return l===1?"मिनिट":"मिनिटे"},s:"सेकंद",ms:"मिलिसेकंद"},ms:{y:"tahun",mo:"bulan",w:"minggu",d:"hari",h:"jam",m:"minit",s:"saat",ms:"milisaat",decimal:"."},nl:{y:"jaar",mo:function(l){return l===1?"maand":"maanden"},w:function(l){return l===1?"week":"weken"},d:function(l){return l===1?"dag":"dagen"},h:"uur",m:function(l){return l===1?"minuut":"minuten"},s:function(l){return l===1?"seconde":"seconden"},ms:function(l){return l===1?"milliseconde":"milliseconden"},decimal:","},no:{y:"år",mo:function(l){return"måned"+(l===1?"":"er")},w:function(l){return"uke"+(l===1?"":"r")},d:function(l){return"dag"+(l===1?"":"er")},h:function(l){return"time"+(l===1?"":"r")},m:function(l){return"minutt"+(l===1?"":"er")},s:function(l){return"sekund"+(l===1?"":"er")},ms:function(l){return"millisekund"+(l===1?"":"er")},decimal:","},pl:{y:function(l){return["rok","roku","lata","lat"][d(l)]},mo:function(l){return["miesiąc","miesiąca","miesiące","miesięcy"][d(l)]},w:function(l){return["tydzień","tygodnia","tygodnie","tygodni"][d(l)]},d:function(l){return["dzień","dnia","dni","dni"][d(l)]},h:function(l){return["godzina","godziny","godziny","godzin"][d(l)]},m:function(l){return["minuta","minuty","minuty","minut"][d(l)]},s:function(l){return["sekunda","sekundy","sekundy","sekund"][d(l)]},ms:function(l){return["milisekunda","milisekundy","milisekundy","milisekund"][d(l)]},decimal:","},pt:{y:function(l){return"ano"+(l===1?"":"s")},mo:function(l){return l===1?"mês":"meses"},w:function(l){return"semana"+(l===1?"":"s")},d:function(l){return"dia"+(l===1?"":"s")},h:function(l){return"hora"+(l===1?"":"s")},m:function(l){return"minuto"+(l===1?"":"s")},s:function(l){return"segundo"+(l===1?"":"s")},ms:function(l){return"milissegundo"+(l===1?"":"s")},decimal:","},ro:{y:function(l){return l===1?"an":"ani"},mo:function(l){return l===1?"lună":"luni"},w:function(l){return l===1?"săptămână":"săptămâni"},d:function(l){return l===1?"zi":"zile"},h:function(l){return l===1?"oră":"ore"},m:function(l){return l===1?"minut":"minute"},s:function(l){return l===1?"secundă":"secunde"},ms:function(l){return l===1?"milisecundă":"milisecunde"},decimal:","},ru:{y:function(l){return["лет","год","года"][f(l)]},mo:function(l){return["месяцев","месяц","месяца"][f(l)]},w:function(l){return["недель","неделя","недели"][f(l)]},d:function(l){return["дней","день","дня"][f(l)]},h:function(l){return["часов","час","часа"][f(l)]},m:function(l){return["минут","минута","минуты"][f(l)]},s:function(l){return["секунд","секунда","секунды"][f(l)]},ms:function(l){return["миллисекунд","миллисекунда","миллисекунды"][f(l)]},decimal:","},sq:{y:function(l){return l===1?"vit":"vjet"},mo:"muaj",w:"javë",d:"ditë",h:"orë",m:function(l){return"minut"+(l===1?"ë":"a")},s:function(l){return"sekond"+(l===1?"ë":"a")},ms:function(l){return"milisekond"+(l===1?"ë":"a")},decimal:","},sr:{y:function(l){return["години","година","године"][f(l)]},mo:function(l){return["месеци","месец","месеца"][f(l)]},w:function(l){return["недељи","недеља","недеље"][f(l)]},d:function(l){return["дани","дан","дана"][f(l)]},h:function(l){return["сати","сат","сата"][f(l)]},m:function(l){return["минута","минут","минута"][f(l)]},s:function(l){return["секунди","секунда","секунде"][f(l)]},ms:function(l){return["милисекунди","милисекунда","милисекунде"][f(l)]},decimal:","},ta:{y:function(l){return l===1?"வருடம்":"ஆண்டுகள்"},mo:function(l){return l===1?"மாதம்":"மாதங்கள்"},w:function(l){return l===1?"வாரம்":"வாரங்கள்"},d:function(l){return l===1?"நாள்":"நாட்கள்"},h:function(l){return l===1?"மணி":"மணிநேரம்"},m:function(l){return"நிமிட"+(l===1?"ம்":"ங்கள்")},s:function(l){return"வினாடி"+(l===1?"":"கள்")},ms:function(l){return"மில்லி விநாடி"+(l===1?"":"கள்")}},te:{y:function(l){return"సంవత్స"+(l===1?"రం":"రాల")},mo:function(l){return"నెల"+(l===1?"":"ల")},w:function(l){return l===1?"వారం":"వారాలు"},d:function(l){return"రోజు"+(l===1?"":"లు")},h:function(l){return"గంట"+(l===1?"":"లు")},m:function(l){return l===1?"నిమిషం":"నిమిషాలు"},s:function(l){return l===1?"సెకను":"సెకన్లు"},ms:function(l){return l===1?"మిల్లీసెకన్":"మిల్లీసెకన్లు"}},uk:{y:function(l){return["років","рік","роки"][f(l)]},mo:function(l){return["місяців","місяць","місяці"][f(l)]},w:function(l){return["тижнів","тиждень","тижні"][f(l)]},d:function(l){return["днів","день","дні"][f(l)]},h:function(l){return["годин","година","години"][f(l)]},m:function(l){return["хвилин","хвилина","хвилини"][f(l)]},s:function(l){return["секунд","секунда","секунди"][f(l)]},ms:function(l){return["мілісекунд","мілісекунда","мілісекунди"][f(l)]},decimal:","},ur:{y:"سال",mo:function(l){return l===1?"مہینہ":"مہینے"},w:function(l){return l===1?"ہفتہ":"ہفتے"},d:"دن",h:function(l){return l===1?"گھنٹہ":"گھنٹے"},m:"منٹ",s:"سیکنڈ",ms:"ملی سیکنڈ",decimal:"."},sk:{y:function(l){return["rok","roky","roky","rokov"][g(l)]},mo:function(l){return["mesiac","mesiace","mesiace","mesiacov"][g(l)]},w:function(l){return["týždeň","týždne","týždne","týždňov"][g(l)]},d:function(l){return["deň","dni","dni","dní"][g(l)]},h:function(l){return["hodina","hodiny","hodiny","hodín"][g(l)]},m:function(l){return["minúta","minúty","minúty","minút"][g(l)]},s:function(l){return["sekunda","sekundy","sekundy","sekúnd"][g(l)]},ms:function(l){return["milisekunda","milisekundy","milisekundy","milisekúnd"][g(l)]},decimal:","},sl:{y:function(l){return l%10===1?"leto":l%100===2?"leti":l%100===3||l%100===4||Math.floor(l)!==l&&l%100<=5?"leta":"let"},mo:function(l){return l%10===1?"mesec":l%100===2||Math.floor(l)!==l&&l%100<=5?"meseca":l%10===3||l%10===4?"mesece":"mesecev"},w:function(l){return l%10===1?"teden":l%10===2||Math.floor(l)!==l&&l%100<=4?"tedna":l%10===3||l%10===4?"tedne":"tednov"},d:function(l){return l%100===1?"dan":"dni"},h:function(l){return l%10===1?"ura":l%100===2?"uri":l%10===3||l%10===4||Math.floor(l)!==l?"ure":"ur"},m:function(l){return l%10===1?"minuta":l%10===2?"minuti":l%10===3||l%10===4||Math.floor(l)!==l&&l%100<=4?"minute":"minut"},s:function(l){return l%10===1?"sekunda":l%100===2?"sekundi":l%100===3||l%100===4||Math.floor(l)!==l?"sekunde":"sekund"},ms:function(l){return l%10===1?"milisekunda":l%100===2?"milisekundi":l%100===3||l%100===4||Math.floor(l)!==l?"milisekunde":"milisekund"},decimal:","},sv:{y:"år",mo:function(l){return"månad"+(l===1?"":"er")},w:function(l){return"veck"+(l===1?"a":"or")},d:function(l){return"dag"+(l===1?"":"ar")},h:function(l){return"timm"+(l===1?"e":"ar")},m:function(l){return"minut"+(l===1?"":"er")},s:function(l){return"sekund"+(l===1?"":"er")},ms:function(l){return"millisekund"+(l===1?"":"er")},decimal:","},sw:{y:function(l){return l===1?"mwaka":"miaka"},mo:function(l){return l===1?"mwezi":"miezi"},w:"wiki",d:function(l){return l===1?"siku":"masiku"},h:function(l){return l===1?"saa":"masaa"},m:"dakika",s:"sekunde",ms:"milisekunde",decimal:".",_numberFirst:!0},tr:{y:"yıl",mo:"ay",w:"hafta",d:"gün",h:"saat",m:"dakika",s:"saniye",ms:"milisaniye",decimal:","},th:{y:"ปี",mo:"เดือน",w:"สัปดาห์",d:"วัน",h:"ชั่วโมง",m:"นาที",s:"วินาที",ms:"มิลลิวินาที",decimal:"."},vi:{y:"năm",mo:"tháng",w:"tuần",d:"ngày",h:"giờ",m:"phút",s:"giây",ms:"mili giây",decimal:","},zh_CN:{y:"年",mo:"个月",w:"周",d:"天",h:"小时",m:"分钟",s:"秒",ms:"毫秒",decimal:"."},zh_TW:{y:"年",mo:"個月",w:"周",d:"天",h:"小時",m:"分鐘",s:"秒",ms:"毫秒",decimal:"."}};function n(l){var y=function(C,w){var v=c({},y,w||{});return a(C,v)};return c(y,{language:"en",spacer:" ",conjunction:"",serialComma:!0,units:["y","mo","w","d","h","m","s"],languages:{},round:!1,unitMeasures:{y:315576e5,mo:26298e5,w:6048e5,d:864e5,h:36e5,m:6e4,s:1e3,ms:1}},l)}var r=n({});function o(l){var y=[l.language];if(x(l,"fallbacks"))if(p(l.fallbacks)&&l.fallbacks.length)y=y.concat(l.fallbacks);else throw new Error("fallbacks must be an array with at least one element");for(var E=0;E<y.length;E++){var C=y[E];if(x(l.languages,C))return l.languages[C];if(x(i,C))return i[C]}throw new Error("No language found.")}function a(l,y){var E,C,w;l=Math.abs(l);var v=o(y),I=[],S,A,G;for(E=0,C=y.units.length;E<C;E++){if(S=y.units[E],A=y.unitMeasures[S],E+1===C)if(x(y,"maxDecimalPoints")){var N=Math.pow(10,y.maxDecimalPoints),D=l/A;G=parseFloat((Math.floor(N*D)/N).toFixed(y.maxDecimalPoints))}else G=l/A;else G=Math.floor(l/A);I.push({unitCount:G,unitName:S}),l-=G*A}var U=0;for(E=0;E<I.length;E++)if(I[E].unitCount){U=E;break}if(y.round){var L,M;for(E=I.length-1;E>=0&&(w=I[E],w.unitCount=Math.round(w.unitCount),E!==0);E--)M=I[E-1],L=y.unitMeasures[M.unitName]/y.unitMeasures[w.unitName],(w.unitCount%L===0||y.largest&&y.largest-1<E-U)&&(M.unitCount+=w.unitCount/L,w.unitCount=0)}var T=[];for(E=0,I.length;E<C&&(w=I[E],w.unitCount&&T.push(h(w.unitCount,w.unitName,v,y)),T.length!==y.largest);E++);if(T.length){var F;if(x(y,"delimiter")?F=y.delimiter:x(v,"delimiter")?F=v.delimiter:F=", ",!y.conjunction||T.length===1)return T.join(F);if(T.length===2)return T.join(y.conjunction);if(T.length>2)return T.slice(0,-1).join(F)+(y.serialComma?",":"")+y.conjunction+T.slice(-1)}else return h(0,y.units[y.units.length-1],v,y)}function h(l,y,E,C){var w;x(C,"decimal")?w=C.decimal:x(E,"decimal")?w=E.decimal:w=".";var v;typeof E._formatCount=="function"?v=E._formatCount(l,w):v=l.toString().replace(".",w);var I=E[y],S;return typeof I=="function"?S=I(l):S=I,E._numberFirst?S+C.spacer+v:v+C.spacer+S}function c(l){for(var y,E=1;E<arguments.length;E++){y=arguments[E];for(var C in y)x(y,C)&&(l[C]=y[C])}return l}function u(l){return l===1?0:l===2?1:l>2&&l<11?2:0}function d(l){return l===1?0:Math.floor(l)!==l?1:l%10>=2&&l%10<=4&&!(l%100>10&&l%100<20)?2:3}function f(l){return Math.floor(l)!==l?2:l%100>=5&&l%100<=20||l%10>=5&&l%10<=9||l%10===0?0:l%10===1?1:l>1?2:0}function g(l){return l===1?0:Math.floor(l)!==l?1:l%10>=2&&l%10<=4&&l%100<10?2:3}function m(l){return l===1||l%10===1&&l%100>20?0:Math.floor(l)!==l||l%10>=2&&l%100>20||l%10>=2&&l%100<10?1:2}function _(l){return l%10===1&&l%100!==11}var p=Array.isArray||function(l){return Object.prototype.toString.call(l)==="[object Array]"};function x(l,y){return Object.prototype.hasOwnProperty.call(l,y)}r.getSupportedLanguages=function(){var y=[];for(var E in i)x(i,E)&&E!=="gr"&&y.push(E);return y},r.humanizer=n,s.exports?s.exports=r:this.humanizeDuration=r})()})(cf);const uf=Is,Nn="https://jaxartes.net/geoserver",Gn="ottoman",Xn="application/json",Na="2.0.0",df="yvGZ8CUmA6zbqBiHuxk5";var Ss=!0;setInterval(function(){Ss=!0},30);const ff=function(s){var t=s.get("mode"),e;switch(t){case"ferry":return new ht({stroke:new lt({color:[0,0,255,.4],width:1,lineDash:[1,2]})});case"ship":return new ht({stroke:new lt({color:[0,0,255,.4],width:2,lineDash:[2,8]})});case"rail":return[new ht({stroke:new lt({color:[255,255,255,.8],width:2,lineDash:[4,8],lineDashOffset:6})}),new ht({stroke:new lt({color:[0,0,0,.8],width:2,lineDash:[4,8]})})];case"chaussee":return[new ht({stroke:new lt({color:[0,0,0,1],width:4})}),new ht({stroke:new lt({color:[255,255,255,1],width:2})})];case"road":return[new ht({stroke:new lt({color:[0,0,0,1],width:2})}),new ht({stroke:new lt({color:[255,255,255,1],width:1})})];case"metro":case"tram":return new ht({stroke:new lt({color:"black",width:2})})}return e},gf=function(s){var t=s.get("rank"),e;switch(t){case 10:e=new gn({points:5,radius:8,radius2:4,fill:new St({color:"red"})});break;case 9:e=new _e({radius:6,fill:new St({color:"black"}),stroke:new lt({width:2,color:"white"})});break;case 8:e=new _e({radius:5,fill:new St({color:"white"}),stroke:new lt({width:2,color:"black"})});break;case 7:e=new _e({radius:4,fill:new St({color:"black"})});break;case 6:e=new _e({radius:3,fill:new St({color:"#111"})});case 5:e=new _e({radius:2,fill:new St({color:"#222"})});default:e=new gn({points:4,radius:2,angle:Math.PI/4,fill:new St({color:[0,0,0,1]})})}var i=new ht({image:e,zIndex:t,text:new ia({font:t+8+'px "Open Sans,sans-serif"',fill:new St({color:"#000"}),textAlign:"left",textBaseline:"bottom",stroke:new lt({color:"#fff",width:4})})});return i.getText().setText(s.get("name")),i};var ae=new Os({geometry:new qe(zs([29,41]))}),Qe=new Os({geometry:new qe(zs([27.5,41]))}),mf=new Fn({format:new vi,url:function(s){return Nn+"//ows?service=WFS&version=1.3.0&request=GetFeature&typeName="+Gn+":nodes&srsname=EPSG:3857&outputFormat="+Xn},strategy:or}),_f=new Fn({format:new vi,url:function(s){return Nn+"//ows?service=WFS&version=1.3.0&request=GetFeature&typeName="+Gn+":edges_render&srsname=EPSG:3857&outputFormat="+Xn},strategy:or});const yf=new _a({collapsible:!1}),pf=new jd({url:`https://api.maptiler.com/tiles/hillshade/tiles.json?key=${df}`,tileSize:512,crossOrigin:"anonymous"});var xf=new bn({source:mf,style:gf,declutter:!0,crossOrigin:"anonymous"});const Ef=new bn({source:_f,style:ff,crossOrigin:"anonymous"}),Wn=new bn({style:new ht({stroke:new lt({color:[0,0,255,.4],width:8})})});var Cf=new bn({source:new Fn({features:[ae,Qe]}),style:new ht({image:new rr({src:"https://openlayers.org/en/latest/examples/data/icon.png",anchor:[.5,0],anchorOrigin:"bottom-right"})})}),Ii=new Ju({target:"map",controls:ya({attribution:!1}).extend([yf]),layers:[new Td({source:pf}),Ef,xf,Wn,Cf],view:new se({center:zs([29,41]),zoom:8})}),Ga=new Da({features:new ut([ae])}),Xa=new Da({features:new ut([Qe])});Ga.on(["translateend","translating"],Wa);Xa.on(["translateend","translating"],Wa);Ii.addInteraction(Ga);Ii.addInteraction(Xa);function Wa(s){var t=!1;if(s.type=="translating")if(Ss)Ss=!1;else return;s.type=="translateend"&&(t=!0);var e=s.features.item(0),i=s.coordinate,n=s.target.map_.getView().getResolution()*40;pr(e,i,n,t)}function pr(s,t,e,i){var n=t[0],r=t[1],o=new XMLHttpRequest,a="service=WFS&version="+Na+"&request=GetFeature&typeNames="+Gn+":node_proximity&outputFormat="+Xn+"&srsname=EPSG:3857&viewparams=x:"+n+";y:"+r+";tolerance:"+e,h=Nn+"/ows/?"+a;o.setRequestHeader("Access-Control-Allow-Origin","https://jaxartes.net"),o.open("GET",h,!0),o.onreadystatechange=function(){if(o.readyState==4&&o.status==200){var c=new vi().readFeatures(o.responseText),u,d;c.length>0?(i?(s.setProperties(c[0].getProperties()),u=ae,d=Qe):s==ae?(u=c[0],d=Qe):(u=ae,d=c[0]),wf(u.getProperties().id,d.getProperties().id)):(Wn.setSource(null),i&&(s==ae?u=null:d=null))}},o.send()}function wf(s,t,e){if(!(s===void 0||t===void 0)){var i=new XMLHttpRequest,n="service=WFS&version="+Na+"&request=GetFeature&typeNames="+Gn+":route&outputFormat="+Xn+"&srsname=EPSG:3857&viewparams=source:"+s+";target:"+t+";",r=Nn+"/ows/?"+n;i.open("GET",r,!0),i.onreadystatechange=function(){if(i.readyState==4&&i.status==200){var o=new Fn({format:new vi,url:function(h){return r}});Wn.setSource(o);var a=new vi().readFeatures(i.responseText);Rf(a)}},i.send()}}function Rf(s,t){var e=document.getElementById("information-content"),i="";if(s.length>0){var n=[],r={},o=0,a=null,h=[];s.forEach(function(u){u.get("mode")==a?(o+=u.get("cost"),h.push(u.get("target"))):(a!=null&&n.push(r),r={},o=u.get("cost"),h=[u.get("source")],h.push(u.get("target")),a=u.get("mode")),r.cost=o,r.mode=a,r.places=h}),i="<h2>"+s[0].get("source")+" to "+s.slice(-1)[0].get("target")+"</h2>",n.push(r);var c=0;i+="<ul>",n.forEach(function(u){c+=u.cost,h=u.places;var d=h.shift(),f=h.pop();i+="<li><b>"+d+"</b> to <b>"+f+"</b>",h.length>0&&(i+=" via <em>"+h.join("</em>, <em>")),i+="</em> ("+u.mode+", "+Ls(u.cost)+")</li>"}),i+="</ul>",i+="Total trip time: "+Ls(c)}i+="<div class=blog>Read about how this was made <a href='https://www.jaxartes.net/pages/ottoman-travel/'>here</a>.</div>",e.innerHTML=i}function Ls(s){return uf(s*60*60*1e3,{round:!0,units:["d","h","m"],largest:2})}pr(ae,ae.getGeometry().getCoordinates(),1e4,!0);pr(Qe,Qe.getGeometry().getCoordinates(),1e4,!0);var tn=new td({element:document.getElementById("popup"),autoPan:!0});Ii.addOverlay(tn);Ii.on("pointermove",function(s){var t=Ii.forEachFeatureAtPixel(s.pixel,function(o){return o},{layerFilter:function(o){return o===Wn}});if(t){var e=s.coordinate;tn.setPosition(e);var i=document.getElementById("popup-content"),n=Ls(t.get("cost")),r=t.get("source")+" - "+t.get("target")+"<br/><em>"+n+" by "+t.get("mode")+"</em>";i.innerHTML=r,tn.getElement().style.display="block"}else tn.getElement().style.display="none"});
//# sourceMappingURL=index-8684d561.js.map
